<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Gry Terapeutyczne</title>
    <link rel="manifest" href="manifest.json">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow: hidden;
        }
        
        .menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: max(20px, env(safe-area-inset-top)) 20px max(20px, env(safe-area-inset-bottom));
            overflow-y: auto;
            transition: transform 0.3s;
        }
        
        .menu.hidden {
            transform: translateX(-100%);
        }
        
        .header {
            text-align: center;
            color: white;
            padding: 20px 0;
        }
        
        h1 {
            font-size: clamp(24px, 6vw, 32px);
            margin-bottom: 8px;
        }
        
        .subtitle {
            font-size: clamp(13px, 3.5vw, 15px);
            opacity: 0.9;
        }
        
        .games-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            padding: 20px 0;
        }
        
        .game-btn {
            background: white;
            border: none;
            border-radius: 15px;
            padding: 25px 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            min-height: 110px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .game-btn:active {
            transform: scale(0.95);
        }
        
        .game-icon {
            font-size: clamp(32px, 8vw, 40px);
            margin-bottom: 8px;
        }
        
        .game-name {
            font-size: clamp(12px, 3vw, 14px);
            font-weight: 600;
            color: #333;
            line-height: 1.3;
        }
        
        .notice {
            background: rgba(255,255,255,0.95);
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            font-size: clamp(12px, 3vw, 13px);
            line-height: 1.5;
            text-align: center;
        }
        
        .notice strong {
            color: #667eea;
            display: block;
            margin-bottom: 5px;
        }
        
        .game-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            z-index: 1000;
        }
        
        .game-container.active {
            display: block;
        }
        
        .game-frame {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .game-direct {
            width: 100%;
            height: 100%;
        }
        
        .back-btn {
            position: fixed;
            top: max(15px, env(safe-area-inset-top, 10px));
            left: 15px;
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            z-index: 9999;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
        }
        
        .back-btn.active {
            display: flex;
        }
        
        @media (min-width: 600px) {
            .games-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" id="backBtn" onclick="showMenu()">‚Üê</button>
    
    <div class="menu" id="menu">
        <div class="header">
            <h1>üéÆ Gry Terapeutyczne</h1>
            <p class="subtitle">Interaktywne zabawy dla dzieci</p>
        </div>
        
        <div class="notice">
            <strong>üé§ Mikrofon</strong>
            Gra "Gitara D≈∫wiƒôku" potrzebuje mikrofonu - gdy przeglƒÖdarka zapyta, kliknij "Zezw√≥l"!
        </div>
        
        <div class="games-grid">
            <button class="game-btn" onclick="loadGame('sledzenie')">
                <div class="game-icon">‚ú®</div>
                <div class="game-name">≈öledzenie<br>wzrokiem</div>
            </button>
            
            <button class="game-btn" onclick="loadGame('banki')">
                <div class="game-icon">ü´ß</div>
                <div class="game-name">≈Åapanie<br>baniek</div>
            </button>
            
            <button class="game-btn" onclick="loadGame('swiatla')">
                <div class="game-icon">üí°</div>
                <div class="game-name">≈öwiecƒÖce<br>≈õwiat≈Ça</div>
            </button>
            
            <button class="game-btn" onclick="loadGame('spojrzenie')">
                <div class="game-icon">üëÄ</div>
                <div class="game-name">Kontakt<br>wzrokowy</div>
            </button>
            
            <button class="game-btn" onclick="loadGame('spokoj')">
                <div class="game-icon">üåä</div>
                <div class="game-name">Strefa<br>spokoju</div>
            </button>
            
            <button class="game-btn" onclick="loadGame('slowa')">
                <div class="game-icon">üìö</div>
                <div class="game-name">Pierwsze<br>s≈Çowa</div>
            </button>
            
            <button class="game-btn" onclick="loadGame('dzwiek')">
                <div class="game-icon">üé∏</div>
                <div class="game-name">Gitara<br>D≈∫wiƒôku</div>
            </button>
        </div>
    </div>
    
    <div class="game-container" id="gameContainer">
        <iframe class="game-frame" id="gameFrame"></iframe>
        <div class="game-direct" id="gameDirect"></div>
    </div>
    
    <script>
        // Base64 encoded games
        const GAMES_BASE64 = {
            sledzenie: "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9InBsIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+xZpsZWR6ZW5pZSDFmndpYXRlxYJrYTwvdGl0bGU+CiAgICA8c3R5bGU+CiAgICAgICAgKiB7CiAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAgICAgICB9CgogICAgICAgIGJvZHkgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMDUwNTA4OwogICAgICAgICAgICBtaW4taGVpZ2h0OiAxMDB2aDsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgICAgY3Vyc29yOiBub25lOwogICAgICAgIH0KCiAgICAgICAgLmNvbnRhaW5lciB7CiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICAgICAgd2lkdGg6IDEwMHZ3OwogICAgICAgICAgICBoZWlnaHQ6IDEwMHZoOwogICAgICAgIH0KCiAgICAgICAgLyogU3VidGxlIHN0YXJzIGJhY2tncm91bmQgKi8KICAgICAgICAuc3RhcnMgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIHRvcDogMDsKICAgICAgICAgICAgbGVmdDogMDsKICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICAgICAgfQoKICAgICAgICAuc3RhciB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgd2lkdGg6IDJweDsKICAgICAgICAgICAgaGVpZ2h0OiAycHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHdoaXRlOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgICAgIG9wYWNpdHk6IDAuMzsKICAgICAgICAgICAgYW5pbWF0aW9uOiB0d2lua2xlIDNzIGVhc2UtaW4tb3V0IGluZmluaXRlOwogICAgICAgIH0KCiAgICAgICAgQGtleWZyYW1lcyB0d2lua2xlIHsKICAgICAgICAgICAgMCUsIDEwMCUgeyBvcGFjaXR5OiAwLjI7IH0KICAgICAgICAgICAgNTAlIHsgb3BhY2l0eTogMC41OyB9CiAgICAgICAgfQoKICAgICAgICAubGlnaHQtb3JiIHsKICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICB3aWR0aDogMTAwcHg7CiAgICAgICAgICAgIGhlaWdodDogMTAwcHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCAzMCUgMzAlLCAjZmZlMDY2LCAjZmZhYTAwKTsKICAgICAgICAgICAgYm94LXNoYWRvdzogCiAgICAgICAgICAgICAgICAwIDAgNjBweCAjZmZhYTAwLAogICAgICAgICAgICAgICAgMCAwIDEwMHB4ICNmZjg4MDAsCiAgICAgICAgICAgICAgICAwIDAgMTQwcHggI2ZmNjYwMDQ0OwogICAgICAgIH0KCiAgICAgICAgLmxpZ2h0LW9yYjo6YmVmb3JlIHsKICAgICAgICAgICAgY29udGVudDogJyc7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgdG9wOiAtMjBweDsKICAgICAgICAgICAgbGVmdDogLTIwcHg7CiAgICAgICAgICAgIHJpZ2h0OiAtMjBweDsKICAgICAgICAgICAgYm90dG9tOiAtMjBweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQoY2lyY2xlLCAjZmZhYTAwMzMgMCUsIHRyYW5zcGFyZW50IDcwJSk7CiAgICAgICAgICAgIGFuaW1hdGlvbjogcHVsc2UgMnMgZWFzZS1pbi1vdXQgaW5maW5pdGU7CiAgICAgICAgfQoKICAgICAgICBAa2V5ZnJhbWVzIHB1bHNlIHsKICAgICAgICAgICAgMCUsIDEwMCUgeyB0cmFuc2Zvcm06IHNjYWxlKDEpOyBvcGFjaXR5OiAwLjU7IH0KICAgICAgICAgICAgNTAlIHsgdHJhbnNmb3JtOiBzY2FsZSgxLjIpOyBvcGFjaXR5OiAwLjg7IH0KICAgICAgICB9CgogICAgICAgIC8qIFRyYWlsIGVmZmVjdCAqLwogICAgICAgIC50cmFpbCB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgd2lkdGg6IDQwcHg7CiAgICAgICAgICAgIGhlaWdodDogNDBweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgICAgICAgICAgYW5pbWF0aW9uOiBmYWRlVHJhaWwgMXMgZWFzZS1vdXQgZm9yd2FyZHM7CiAgICAgICAgfQoKICAgICAgICBAa2V5ZnJhbWVzIGZhZGVUcmFpbCB7CiAgICAgICAgICAgIDAlIHsgb3BhY2l0eTogMC42OyB0cmFuc2Zvcm06IHNjYWxlKDEpOyB9CiAgICAgICAgICAgIDEwMCUgeyBvcGFjaXR5OiAwOyB0cmFuc2Zvcm06IHNjYWxlKDAuMyk7IH0KICAgICAgICB9CgogICAgICAgIC5jb250cm9scyB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICAgICAgdG9wOiAyMHB4OwogICAgICAgICAgICByaWdodDogMjBweDsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICAgICAgZ2FwOiAxMHB4OwogICAgICAgICAgICB6LWluZGV4OiAxMDAwOwogICAgICAgIH0KCiAgICAgICAgLmNvbnRyb2wtYnRuIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpOwogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7CiAgICAgICAgICAgIGNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNik7CiAgICAgICAgICAgIHBhZGRpbmc6IDEwcHggMjBweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMjVweDsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjNzOwogICAgICAgIH0KCiAgICAgICAgLmNvbnRyb2wtYnRuOmhvdmVyIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOwogICAgICAgICAgICBjb2xvcjogd2hpdGU7CiAgICAgICAgfQoKICAgICAgICAuY29udHJvbC1idG4uYWN0aXZlIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDE3MCwgMCwgMC4zKTsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwgMTcwLCAwLCAwLjUpOwogICAgICAgICAgICBjb2xvcjogI2ZmY2MwMDsKICAgICAgICB9CgogICAgICAgIC5zcGVlZC1sYWJlbCB7CiAgICAgICAgICAgIGNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNCk7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgICAgICBmb250LWZhbWlseTogc3lzdGVtLXVpLCBzYW5zLXNlcmlmOwogICAgICAgIH0KCiAgICAgICAgLmluZm8gewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIGJvdHRvbTogMjBweDsKICAgICAgICAgICAgbGVmdDogNTAlOwogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgICAgICAgIGNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMyk7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICAgICAgZm9udC1mYW1pbHk6IHN5c3RlbS11aSwgc2Fucy1zZXJpZjsKICAgICAgICB9CiAgICA8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5PgogICAgPGRpdiBjbGFzcz0iY29udGFpbmVyIiBpZD0iY29udGFpbmVyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJzdGFycyIgaWQ9InN0YXJzIj48L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJsaWdodC1vcmIiIGlkPSJvcmIiPjwvZGl2PgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0iY29udHJvbHMiPgogICAgICAgIDxidXR0b24gY2xhc3M9ImNvbnRyb2wtYnRuIiBpZD0ic2xvd0J0biI+V29sbm88L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJjb250cm9sLWJ0biBhY3RpdmUiIGlkPSJtZWRpdW1CdG4iPsWacmVkbmlvPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iY29udHJvbC1idG4iIGlkPSJmYXN0QnRuIj5TenliY2llajwvYnV0dG9uPgogICAgICAgIDxkaXYgY2xhc3M9InNwZWVkLWxhYmVsIj5QcsSZZGtvxZvEhzwvZGl2PgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0iaW5mbyI+UG9kd8Ozam5lIGtsaWtuacSZY2llID0gcGXFgm55IGVrcmFuPC9kaXY+CgogICAgPHNjcmlwdD4KICAgICAgICAvLyBBdWRpbyBzZXR1cAogICAgICAgIGNvbnN0IEF1ZGlvQ29udGV4dCA9IHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dDsKICAgICAgICBsZXQgYXVkaW9DdHggPSBudWxsOwoKICAgICAgICBmdW5jdGlvbiBpbml0QXVkaW8oKSB7CiAgICAgICAgICAgIGlmICghYXVkaW9DdHgpIHsKICAgICAgICAgICAgICAgIGF1ZGlvQ3R4ID0gbmV3IEF1ZGlvQ29udGV4dCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChhdWRpb0N0eC5zdGF0ZSA9PT0gJ3N1c3BlbmRlZCcpIHsKICAgICAgICAgICAgICAgIGF1ZGlvQ3R4LnJlc3VtZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBQZW50YXRvbmljIHNjYWxlIGZvciBwbGVhc2FudCwgbm9uLWphcnJpbmcgc291bmRzCiAgICAgICAgY29uc3QgcGVudGF0b25pY05vdGVzID0gWwogICAgICAgICAgICAyNjEuNjMsIC8vIEM0CiAgICAgICAgICAgIDI5My42NiwgLy8gRDQKICAgICAgICAgICAgMzI5LjYzLCAvLyBFNAogICAgICAgICAgICAzOTIuMDAsIC8vIEc0CiAgICAgICAgICAgIDQ0MC4wMCwgLy8gQTQKICAgICAgICAgICAgNTIzLjI1LCAvLyBDNQogICAgICAgICAgICA1ODcuMzMsIC8vIEQ1CiAgICAgICAgICAgIDY1OS4yNSwgLy8gRTUKICAgICAgICBdOwoKICAgICAgICBsZXQgY3VycmVudE5vdGVJbmRleCA9IDA7CiAgICAgICAgbGV0IGxhc3ROb3RlVGltZSA9IDA7CgogICAgICAgIC8vIENvbG9ycyBmb3IgdGhlIG9yYiAtIHNtb290aCBncmFkaWVudCB0aHJvdWdoIHNwZWN0cnVtIChSR0IgdmFsdWVzKQogICAgICAgIGNvbnN0IG9yYkNvbG9ycyA9IFsKICAgICAgICAgICAgeyBtYWluOiBbMjU1LCAyMjQsIDEwMl0sIGdsb3c6IFsyNTUsIDE3MCwgMF0gfSwgICAgLy8gd2FybSB5ZWxsb3cKICAgICAgICAgICAgeyBtYWluOiBbMjU1LCAxNzAsIDEwMl0sIGdsb3c6IFsyNTUsIDExOSwgMF0gfSwgICAgLy8gb3JhbmdlCiAgICAgICAgICAgIHsgbWFpbjogWzI1NSwgMTM2LCAxNTNdLCBnbG93OiBbMjU1LCA4NSwgMTE5XSB9LCAgIC8vIGNvcmFsIHBpbmsKICAgICAgICAgICAgeyBtYWluOiBbMjIxLCAxNTMsIDI1NV0sIGdsb3c6IFsxNzAsIDg1LCAyNTVdIH0sICAgLy8gbGF2ZW5kZXIKICAgICAgICAgICAgeyBtYWluOiBbMTUzLCAxODcsIDI1NV0sIGdsb3c6IFs4NSwgMTM2LCAyNTVdIH0sICAgLy8gc29mdCBibHVlCiAgICAgICAgICAgIHsgbWFpbjogWzEzNiwgMjM4LCAyMjFdLCBnbG93OiBbNjgsIDIwNCwgMTcwXSB9LCAgIC8vIGFxdWEKICAgICAgICAgICAgeyBtYWluOiBbMTUzLCAyNTUsIDE3MF0sIGdsb3c6IFs4NSwgMjIxLCAxMTldIH0sICAgLy8gbWludCBncmVlbgogICAgICAgICAgICB7IG1haW46IFsyMjEsIDI1NSwgMTM2XSwgZ2xvdzogWzE3MCwgMjIxLCA2OF0gfSwgICAvLyBsaW1lCiAgICAgICAgXTsKICAgICAgICBsZXQgY29sb3JQb3NpdGlvbiA9IDA7IC8vIDAgdG8gKG9yYkNvbG9ycy5sZW5ndGgpIC0gY29udGludW91cyBwb3NpdGlvbgogICAgICAgIGNvbnN0IGNvbG9yU3BlZWQgPSAwLjAwMDA1OyAvLyBob3cgZmFzdCBjb2xvcnMgY2hhbmdlIC0gdmVyeSBzbG93IG5vdwoKICAgICAgICBmdW5jdGlvbiBsZXJwQ29sb3IoY29sb3IxLCBjb2xvcjIsIHQpIHsKICAgICAgICAgICAgcmV0dXJuIFsKICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY29sb3IxWzBdICsgKGNvbG9yMlswXSAtIGNvbG9yMVswXSkgKiB0KSwKICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY29sb3IxWzFdICsgKGNvbG9yMlsxXSAtIGNvbG9yMVsxXSkgKiB0KSwKICAgICAgICAgICAgICAgIE1hdGgucm91bmQoY29sb3IxWzJdICsgKGNvbG9yMlsyXSAtIGNvbG9yMVsyXSkgKiB0KQogICAgICAgICAgICBdOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gcmdiVG9TdHJpbmcocmdiKSB7CiAgICAgICAgICAgIHJldHVybiBgcmdiKCR7cmdiWzBdfSwgJHtyZ2JbMV19LCAke3JnYlsyXX0pYDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHJnYlRvU3RyaW5nQWxwaGEocmdiLCBhbHBoYSkgewogICAgICAgICAgICByZXR1cm4gYHJnYmEoJHtyZ2JbMF19LCAke3JnYlsxXX0sICR7cmdiWzJdfSwgJHthbHBoYX0pYDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRDb2xvcnMoKSB7CiAgICAgICAgICAgIGNvbnN0IGluZGV4MSA9IE1hdGguZmxvb3IoY29sb3JQb3NpdGlvbikgJSBvcmJDb2xvcnMubGVuZ3RoOwogICAgICAgICAgICBjb25zdCBpbmRleDIgPSAoaW5kZXgxICsgMSkgJSBvcmJDb2xvcnMubGVuZ3RoOwogICAgICAgICAgICBjb25zdCB0ID0gY29sb3JQb3NpdGlvbiAtIE1hdGguZmxvb3IoY29sb3JQb3NpdGlvbik7CiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgbWFpbjogbGVycENvbG9yKG9yYkNvbG9yc1tpbmRleDFdLm1haW4sIG9yYkNvbG9yc1tpbmRleDJdLm1haW4sIHQpLAogICAgICAgICAgICAgICAgZ2xvdzogbGVycENvbG9yKG9yYkNvbG9yc1tpbmRleDFdLmdsb3csIG9yYkNvbG9yc1tpbmRleDJdLmdsb3csIHQpCiAgICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBwbGF5Tm90ZSgpIHsKICAgICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTsKICAgICAgICAgICAgaWYgKG5vdyAtIGxhc3ROb3RlVGltZSA8IDQwMCkgcmV0dXJuOyAvLyBMaW1pdCBub3RlIGZyZXF1ZW5jeQogICAgICAgICAgICBsYXN0Tm90ZVRpbWUgPSBub3c7CgogICAgICAgICAgICBpbml0QXVkaW8oKTsKCiAgICAgICAgICAgIGNvbnN0IGZyZXF1ZW5jeSA9IHBlbnRhdG9uaWNOb3Rlc1tjdXJyZW50Tm90ZUluZGV4XTsKICAgICAgICAgICAgY3VycmVudE5vdGVJbmRleCA9IChjdXJyZW50Tm90ZUluZGV4ICsgMSkgJSBwZW50YXRvbmljTm90ZXMubGVuZ3RoOwoKICAgICAgICAgICAgY29uc3Qgb3NjaWxsYXRvciA9IGF1ZGlvQ3R4LmNyZWF0ZU9zY2lsbGF0b3IoKTsKICAgICAgICAgICAgY29uc3QgZ2Fpbk5vZGUgPSBhdWRpb0N0eC5jcmVhdGVHYWluKCk7CgogICAgICAgICAgICBvc2NpbGxhdG9yLnR5cGUgPSAnc2luZSc7CiAgICAgICAgICAgIG9zY2lsbGF0b3IuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKGZyZXF1ZW5jeSwgYXVkaW9DdHguY3VycmVudFRpbWUpOwoKICAgICAgICAgICAgLy8gU29mdCBwaWFuby1saWtlIGVudmVsb3BlCiAgICAgICAgICAgIGdhaW5Ob2RlLmdhaW4uc2V0VmFsdWVBdFRpbWUoMCwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICBnYWluTm9kZS5nYWluLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKDAuMywgYXVkaW9DdHguY3VycmVudFRpbWUgKyAwLjA1KTsKICAgICAgICAgICAgZ2Fpbk5vZGUuZ2Fpbi5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKDAuMDEsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lICsgMS41KTsKCiAgICAgICAgICAgIC8vIEFkZCBoYXJtb25pY3MgZm9yIHdhcm10aAogICAgICAgICAgICBjb25zdCBvc2MyID0gYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpOwogICAgICAgICAgICBjb25zdCBnYWluMiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgICAgICAgICAgb3NjMi50eXBlID0gJ3NpbmUnOwogICAgICAgICAgICBvc2MyLmZyZXF1ZW5jeS5zZXRWYWx1ZUF0VGltZShmcmVxdWVuY3kgKiAyLCBhdWRpb0N0eC5jdXJyZW50VGltZSk7CiAgICAgICAgICAgIGdhaW4yLmdhaW4uc2V0VmFsdWVBdFRpbWUoMC4xLCBhdWRpb0N0eC5jdXJyZW50VGltZSk7CiAgICAgICAgICAgIGdhaW4yLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAwMSwgYXVkaW9DdHguY3VycmVudFRpbWUgKyAxKTsKCiAgICAgICAgICAgIG9zY2lsbGF0b3IuY29ubmVjdChnYWluTm9kZSk7CiAgICAgICAgICAgIG9zYzIuY29ubmVjdChnYWluMik7CiAgICAgICAgICAgIGdhaW4yLmNvbm5lY3QoZ2Fpbk5vZGUpOwogICAgICAgICAgICBnYWluTm9kZS5jb25uZWN0KGF1ZGlvQ3R4LmRlc3RpbmF0aW9uKTsKCiAgICAgICAgICAgIG9zY2lsbGF0b3Iuc3RhcnQoKTsKICAgICAgICAgICAgb3NjMi5zdGFydCgpOwogICAgICAgICAgICBvc2NpbGxhdG9yLnN0b3AoYXVkaW9DdHguY3VycmVudFRpbWUgKyAxLjUpOwogICAgICAgICAgICBvc2MyLnN0b3AoYXVkaW9DdHguY3VycmVudFRpbWUgKyAxLjUpOwogICAgICAgIH0KCiAgICAgICAgLy8gQ3JlYXRlIHN0YXJzCiAgICAgICAgY29uc3Qgc3RhcnNDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnMnKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDUwOyBpKyspIHsKICAgICAgICAgICAgY29uc3Qgc3RhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBzdGFyLmNsYXNzTmFtZSA9ICdzdGFyJzsKICAgICAgICAgICAgc3Rhci5zdHlsZS5sZWZ0ID0gTWF0aC5yYW5kb20oKSAqIDEwMCArICclJzsKICAgICAgICAgICAgc3Rhci5zdHlsZS50b3AgPSBNYXRoLnJhbmRvbSgpICogMTAwICsgJyUnOwogICAgICAgICAgICBzdGFyLnN0eWxlLmFuaW1hdGlvbkRlbGF5ID0gTWF0aC5yYW5kb20oKSAqIDMgKyAncyc7CiAgICAgICAgICAgIHN0YXJzQ29udGFpbmVyLmFwcGVuZENoaWxkKHN0YXIpOwogICAgICAgIH0KCiAgICAgICAgLy8gT3JiIG1vdmVtZW50CiAgICAgICAgY29uc3Qgb3JiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29yYicpOwogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250YWluZXInKTsKCiAgICAgICAgbGV0IHggPSB3aW5kb3cuaW5uZXJXaWR0aCAvIDIgLSA1MDsKICAgICAgICBsZXQgeSA9IHdpbmRvdy5pbm5lckhlaWdodCAvIDIgLSA1MDsKICAgICAgICBsZXQgdGFyZ2V0WCA9IHg7CiAgICAgICAgbGV0IHRhcmdldFkgPSB5OwogICAgICAgIGxldCBzcGVlZCA9IDAuMDE1OyAvLyBNZWRpdW0gc3BlZWQgZGVmYXVsdAoKICAgICAgICBjb25zdCBwYWRkaW5nID0gMTAwOwoKICAgICAgICBmdW5jdGlvbiBzZXROZXdUYXJnZXQoKSB7CiAgICAgICAgICAgIHRhcmdldFggPSBwYWRkaW5nICsgTWF0aC5yYW5kb20oKSAqICh3aW5kb3cuaW5uZXJXaWR0aCAtIHBhZGRpbmcgKiAyIC0gMTAwKTsKICAgICAgICAgICAgdGFyZ2V0WSA9IHBhZGRpbmcgKyBNYXRoLnJhbmRvbSgpICogKHdpbmRvdy5pbm5lckhlaWdodCAtIHBhZGRpbmcgKiAyIC0gMTAwKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVRyYWlsKCkgewogICAgICAgICAgICBjb25zdCBjb2xvcnMgPSBnZXRDdXJyZW50Q29sb3JzKCk7CiAgICAgICAgICAgIGNvbnN0IHRyYWlsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIHRyYWlsLmNsYXNzTmFtZSA9ICd0cmFpbCc7CiAgICAgICAgICAgIHRyYWlsLnN0eWxlLmxlZnQgPSAoeCArIDMwKSArICdweCc7CiAgICAgICAgICAgIHRyYWlsLnN0eWxlLnRvcCA9ICh5ICsgMzApICsgJ3B4JzsKICAgICAgICAgICAgdHJhaWwuc3R5bGUuYmFja2dyb3VuZCA9IGByYWRpYWwtZ3JhZGllbnQoY2lyY2xlLCAke3JnYlRvU3RyaW5nQWxwaGEoY29sb3JzLmdsb3csIDAuMjUpfSAwJSwgdHJhbnNwYXJlbnQgNzAlKWA7CiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0cmFpbCk7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdHJhaWwucmVtb3ZlKCksIDEwMDApOwogICAgICAgIH0KCiAgICAgICAgbGV0IHRyYWlsQ291bnRlciA9IDA7CiAgICAgICAgbGV0IG5vdGVDb3VudGVyID0gMDsKCiAgICAgICAgZnVuY3Rpb24gdXBkYXRlT3JiQ29sb3IoKSB7CiAgICAgICAgICAgIGNvbG9yUG9zaXRpb24gKz0gY29sb3JTcGVlZCAqIDE2OyAvLyByb3VnaGx5IHBlciBmcmFtZQogICAgICAgICAgICBpZiAoY29sb3JQb3NpdGlvbiA+PSBvcmJDb2xvcnMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBjb2xvclBvc2l0aW9uID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3QgY29sb3JzID0gZ2V0Q3VycmVudENvbG9ycygpOwogICAgICAgICAgICBjb25zdCBtYWluQ29sb3IgPSByZ2JUb1N0cmluZyhjb2xvcnMubWFpbik7CiAgICAgICAgICAgIGNvbnN0IGdsb3dDb2xvciA9IHJnYlRvU3RyaW5nKGNvbG9ycy5nbG93KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIG9yYi5zdHlsZS5iYWNrZ3JvdW5kID0gYHJhZGlhbC1ncmFkaWVudChjaXJjbGUgYXQgMzAlIDMwJSwgJHttYWluQ29sb3J9LCAke2dsb3dDb2xvcn0pYDsKICAgICAgICAgICAgb3JiLnN0eWxlLmJveFNoYWRvdyA9IGAKICAgICAgICAgICAgICAgIDAgMCA2MHB4ICR7Z2xvd0NvbG9yfSwKICAgICAgICAgICAgICAgIDAgMCAxMDBweCAke3JnYlRvU3RyaW5nQWxwaGEoY29sb3JzLmdsb3csIDAuNSl9LAogICAgICAgICAgICAgICAgMCAwIDE0MHB4ICR7cmdiVG9TdHJpbmdBbHBoYShjb2xvcnMuZ2xvdywgMC4yNSl9CiAgICAgICAgICAgIGA7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBhbmltYXRlKCkgewogICAgICAgICAgICAvLyBVcGRhdGUgY29sb3IKICAgICAgICAgICAgdXBkYXRlT3JiQ29sb3IoKTsKICAgICAgICAgICAgLy8gU21vb3RoIG1vdmVtZW50IHRvd2FyZHMgdGFyZ2V0CiAgICAgICAgICAgIGNvbnN0IGR4ID0gdGFyZ2V0WCAtIHg7CiAgICAgICAgICAgIGNvbnN0IGR5ID0gdGFyZ2V0WSAtIHk7CiAgICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTsKCiAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8IDEwKSB7CiAgICAgICAgICAgICAgICBzZXROZXdUYXJnZXQoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgeCArPSBkeCAqIHNwZWVkOwogICAgICAgICAgICB5ICs9IGR5ICogc3BlZWQ7CgogICAgICAgICAgICBvcmIuc3R5bGUubGVmdCA9IHggKyAncHgnOwogICAgICAgICAgICBvcmIuc3R5bGUudG9wID0geSArICdweCc7CgogICAgICAgICAgICAvLyBDcmVhdGUgdHJhaWwgZXZlcnkgZmV3IGZyYW1lcwogICAgICAgICAgICB0cmFpbENvdW50ZXIrKzsKICAgICAgICAgICAgaWYgKHRyYWlsQ291bnRlciA+IDUpIHsKICAgICAgICAgICAgICAgIGNyZWF0ZVRyYWlsKCk7CiAgICAgICAgICAgICAgICB0cmFpbENvdW50ZXIgPSAwOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBQbGF5IG5vdGUgYmFzZWQgb24gbW92ZW1lbnQKICAgICAgICAgICAgbm90ZUNvdW50ZXIrKzsKICAgICAgICAgICAgaWYgKG5vdGVDb3VudGVyID4gMzAgLyAoc3BlZWQgKiA1MCkpIHsKICAgICAgICAgICAgICAgIHBsYXlOb3RlKCk7CiAgICAgICAgICAgICAgICBub3RlQ291bnRlciA9IDA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKTsKICAgICAgICB9CgogICAgICAgIC8vIFNwZWVkIGNvbnRyb2xzCiAgICAgICAgY29uc3Qgc2xvd0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzbG93QnRuJyk7CiAgICAgICAgY29uc3QgbWVkaXVtQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lZGl1bUJ0bicpOwogICAgICAgIGNvbnN0IGZhc3RCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmFzdEJ0bicpOwoKICAgICAgICBmdW5jdGlvbiBzZXRTcGVlZChuZXdTcGVlZCwgYWN0aXZlQnRuKSB7CiAgICAgICAgICAgIHNwZWVkID0gbmV3U3BlZWQ7CiAgICAgICAgICAgIFtzbG93QnRuLCBtZWRpdW1CdG4sIGZhc3RCdG5dLmZvckVhY2goYnRuID0+IGJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7CiAgICAgICAgICAgIGFjdGl2ZUJ0bi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICB9CgogICAgICAgIHNsb3dCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBzZXRTcGVlZCgwLjAwOCwgc2xvd0J0bikpOwogICAgICAgIG1lZGl1bUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHNldFNwZWVkKDAuMDE1LCBtZWRpdW1CdG4pKTsKICAgICAgICBmYXN0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gc2V0U3BlZWQoMC4wMjUsIGZhc3RCdG4pKTsKCiAgICAgICAgLy8gU3RhcnQgYW5pbWF0aW9uCiAgICAgICAgc2V0TmV3VGFyZ2V0KCk7CiAgICAgICAgYW5pbWF0ZSgpOwoKICAgICAgICAvLyBJbml0aWFsaXplIGF1ZGlvIG9uIGZpcnN0IGludGVyYWN0aW9uCiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBpbml0QXVkaW8sIHsgb25jZTogdHJ1ZSB9KTsKCiAgICAgICAgLy8gRnVsbHNjcmVlbgogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgKCkgPT4gewogICAgICAgICAgICBpZiAoIWRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50KSB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4oKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgLy8gSGFuZGxlIHJlc2l6ZQogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB7CiAgICAgICAgICAgIGlmICh4ID4gd2luZG93LmlubmVyV2lkdGggLSAxMDApIHggPSB3aW5kb3cuaW5uZXJXaWR0aCAtIDE1MDsKICAgICAgICAgICAgaWYgKHkgPiB3aW5kb3cuaW5uZXJIZWlnaHQgLSAxMDApIHkgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSAxNTA7CiAgICAgICAgICAgIHNldE5ld1RhcmdldCgpOwogICAgICAgIH0pOwogICAgPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPgo=",
            banki: "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9InBsIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+QmHFhGtpPC90aXRsZT4KICAgIDxzdHlsZT4KICAgICAgICAqIHsKICAgICAgICAgICAgbWFyZ2luOiAwOwogICAgICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogICAgICAgIH0KCiAgICAgICAgYm9keSB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxODBkZWcsICMwYTE2MjggMCUsICMxYTJhNGEgNTAlLCAjMGExNjI4IDEwMCUpOwogICAgICAgICAgICBtaW4taGVpZ2h0OiAxMDB2aDsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgICAgZm9udC1mYW1pbHk6IHN5c3RlbS11aSwgc2Fucy1zZXJpZjsKICAgICAgICB9CgogICAgICAgIC5jb250YWluZXIgewogICAgICAgICAgICB3aWR0aDogMTAwdnc7CiAgICAgICAgICAgIGhlaWdodDogMTAwdmg7CiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICB9CgogICAgICAgIC8qIEJ1YmJsZSBzdHlsZXMgKi8KICAgICAgICAuYnViYmxlIHsKICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgYW5pbWF0aW9uOiBmbG9hdCBsaW5lYXIgZm9yd2FyZHM7CiAgICAgICAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjFzOwogICAgICAgIH0KCiAgICAgICAgLmJ1YmJsZTpob3ZlciB7CiAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgICAgICB9CgogICAgICAgIC5idWJibGU6OmJlZm9yZSB7CiAgICAgICAgICAgIGNvbnRlbnQ6ICcnOwogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgIHRvcDogMTUlOwogICAgICAgICAgICBsZWZ0OiAyMCU7CiAgICAgICAgICAgIHdpZHRoOiAzMCU7CiAgICAgICAgICAgIGhlaWdodDogMzAlOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNik7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgZmlsdGVyOiBibHVyKDJweCk7CiAgICAgICAgfQoKICAgICAgICAuYnViYmxlOjphZnRlciB7CiAgICAgICAgICAgIGNvbnRlbnQ6ICcnOwogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgIHRvcDogMTAlOwogICAgICAgICAgICByaWdodDogMTUlOwogICAgICAgICAgICB3aWR0aDogMTUlOwogICAgICAgICAgICBoZWlnaHQ6IDE1JTsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjQpOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgfQoKICAgICAgICBAa2V5ZnJhbWVzIGZsb2F0IHsKICAgICAgICAgICAgMCUgewogICAgICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApIHJvdGF0ZSgwZGVnKTsKICAgICAgICAgICAgICAgIG9wYWNpdHk6IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgNSUgewogICAgICAgICAgICAgICAgb3BhY2l0eTogMTsKICAgICAgICAgICAgfQogICAgICAgICAgICA5NSUgewogICAgICAgICAgICAgICAgb3BhY2l0eTogMTsKICAgICAgICAgICAgfQogICAgICAgICAgICAxMDAlIHsKICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWShjYWxjKC0xMDB2aCAtIDE1MHB4KSkgcm90YXRlKDM2MGRlZyk7CiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKiBQb3AgZWZmZWN0ICovCiAgICAgICAgLnBvcC1wYXJ0aWNsZSB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgICAgICAgICAgYW5pbWF0aW9uOiBwb3BCdXJzdCAwLjZzIGVhc2Utb3V0IGZvcndhcmRzOwogICAgICAgIH0KCiAgICAgICAgQGtleWZyYW1lcyBwb3BCdXJzdCB7CiAgICAgICAgICAgIDAlIHsKICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDAsIDApIHNjYWxlKDEpOwogICAgICAgICAgICAgICAgb3BhY2l0eTogMTsKICAgICAgICAgICAgfQogICAgICAgICAgICAxMDAlIHsKICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKHZhcigtLXR4KSwgdmFyKC0tdHkpKSBzY2FsZSgwKTsKICAgICAgICAgICAgICAgIG9wYWNpdHk6IDA7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC5wb3AtcmluZyB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgICAgICBib3JkZXI6IDNweCBzb2xpZDsKICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICAgICAgICAgIGFuaW1hdGlvbjogcmluZ0V4cGFuZCAwLjVzIGVhc2Utb3V0IGZvcndhcmRzOwogICAgICAgIH0KCiAgICAgICAgQGtleWZyYW1lcyByaW5nRXhwYW5kIHsKICAgICAgICAgICAgMCUgewogICAgICAgICAgICAgICAgd2lkdGg6IDA7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDA7CiAgICAgICAgICAgICAgICBvcGFjaXR5OiAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIDEwMCUgewogICAgICAgICAgICAgICAgd2lkdGg6IDE1MHB4OwogICAgICAgICAgICAgICAgaGVpZ2h0OiAxNTBweDsKICAgICAgICAgICAgICAgIG9wYWNpdHk6IDA7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8qIFNjb3JlIGRpc3BsYXkgKi8KICAgICAgICAuc2NvcmUtZGlzcGxheSB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICAgICAgdG9wOiAzMHB4OwogICAgICAgICAgICByaWdodDogNDBweDsKICAgICAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7CiAgICAgICAgICAgIGNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNCk7CiAgICAgICAgICAgIHotaW5kZXg6IDEwMDsKICAgICAgICB9CgogICAgICAgIC5zY29yZS1kaXNwbGF5IC5sYWJlbCB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICB9CgogICAgICAgIC5zY29yZS1kaXNwbGF5IC5zY29yZSB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogNTZweDsKICAgICAgICAgICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC43KTsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDMwMDsKICAgICAgICB9CgogICAgICAgIC8qIENvbnRyb2xzICovCiAgICAgICAgLmNvbnRyb2xzIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICBib3R0b206IDMwcHg7CiAgICAgICAgICAgIGxlZnQ6IDUwJTsKICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpOwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBnYXA6IDE1cHg7CiAgICAgICAgICAgIHotaW5kZXg6IDEwMDsKICAgICAgICB9CgogICAgICAgIC5jb250cm9sLWJ0biB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOwogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjYpOwogICAgICAgICAgICBwYWRkaW5nOiAxMnB4IDI1cHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDI1cHg7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zczsKICAgICAgICB9CgogICAgICAgIC5jb250cm9sLWJ0bjpob3ZlciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgIH0KCiAgICAgICAgLmNvbnRyb2wtYnRuLmFjdGl2ZSB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMTAwLCAyMDAsIDI1NSwgMC4yKTsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDEwMCwgMjAwLCAyNTUsIDAuNCk7CiAgICAgICAgfQoKICAgICAgICAvKiBTcGVlZCBjb250cm9sICovCiAgICAgICAgLnNwZWVkLWNvbnRyb2wgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIGJvdHRvbTogOTBweDsKICAgICAgICAgICAgbGVmdDogNTAlOwogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIGdhcDogMTVweDsKICAgICAgICAgICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC40KTsKICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICAgIH0KCiAgICAgICAgLnNwZWVkLXNsaWRlciB7CiAgICAgICAgICAgIHdpZHRoOiAxMjBweDsKICAgICAgICAgICAgaGVpZ2h0OiA2cHg7CiAgICAgICAgICAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjE1KTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogM3B4OwogICAgICAgICAgICBvdXRsaW5lOiBub25lOwogICAgICAgIH0KCiAgICAgICAgLnNwZWVkLXNsaWRlcjo6LXdlYmtpdC1zbGlkZXItdGh1bWIgewogICAgICAgICAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7CiAgICAgICAgICAgIHdpZHRoOiAxOHB4OwogICAgICAgICAgICBoZWlnaHQ6IDE4cHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgxMDAsIDIwMCwgMjU1LCAwLjcpOwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgfQoKICAgICAgICAvKiBJbmZvICovCiAgICAgICAgLmluZm8gewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIHRvcDogMzBweDsKICAgICAgICAgICAgbGVmdDogNDBweDsKICAgICAgICAgICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4zKTsKICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICAgICAgICB6LWluZGV4OiAxMDA7CiAgICAgICAgfQogICAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KICAgIDxkaXYgY2xhc3M9ImNvbnRhaW5lciIgaWQ9ImNvbnRhaW5lciI+PC9kaXY+CgogICAgPGRpdiBjbGFzcz0iaW5mbyI+S2xpa2FqIGJhxYRraSE8L2Rpdj4KCiAgICA8ZGl2IGNsYXNzPSJzY29yZS1kaXNwbGF5Ij4KICAgICAgICA8ZGl2IGNsYXNzPSJsYWJlbCI+UMSZa25pxJl0ZSBiYcWEa2k8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJzY29yZSIgaWQ9InNjb3JlIj4wPC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGNsYXNzPSJzcGVlZC1jb250cm9sIj4KICAgICAgICA8c3Bhbj5Xb2xubzwvc3Bhbj4KICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGNsYXNzPSJzcGVlZC1zbGlkZXIiIGlkPSJzcGVlZFNsaWRlciIgbWluPSIxIiBtYXg9IjUiIHZhbHVlPSIyIj4KICAgICAgICA8c3Bhbj5Tenlia288L3NwYW4+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGNsYXNzPSJjb250cm9scyI+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iY29udHJvbC1idG4gYWN0aXZlIiBpZD0icGxheUJ0biI+4pa2IEdyYWo8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJjb250cm9sLWJ0biIgaWQ9InBhdXNlQnRuIj7ij7ggUGF1emE8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJjb250cm9sLWJ0biIgaWQ9InJlc2V0QnRuIj5PZCBub3dhPC9idXR0b24+CiAgICA8L2Rpdj4KCiAgICA8c2NyaXB0PgogICAgICAgIGNvbnN0IEF1ZGlvQ29udGV4dCA9IHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dDsKICAgICAgICBsZXQgYXVkaW9DdHggPSBudWxsOwoKICAgICAgICBmdW5jdGlvbiBpbml0QXVkaW8oKSB7CiAgICAgICAgICAgIGlmICghYXVkaW9DdHgpIHsKICAgICAgICAgICAgICAgIGF1ZGlvQ3R4ID0gbmV3IEF1ZGlvQ29udGV4dCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChhdWRpb0N0eC5zdGF0ZSA9PT0gJ3N1c3BlbmRlZCcpIHsKICAgICAgICAgICAgICAgIGF1ZGlvQ3R4LnJlc3VtZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFpbmVyJyk7CiAgICAgICAgY29uc3Qgc2NvcmVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY29yZScpOwogICAgICAgIGNvbnN0IHNwZWVkU2xpZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NwZWVkU2xpZGVyJyk7CiAgICAgICAgY29uc3QgcGxheUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF5QnRuJyk7CiAgICAgICAgY29uc3QgcGF1c2VCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF1c2VCdG4nKTsKICAgICAgICBjb25zdCByZXNldEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXNldEJ0bicpOwoKICAgICAgICBsZXQgc2NvcmUgPSAwOwogICAgICAgIGxldCBpc1BsYXlpbmcgPSB0cnVlOwogICAgICAgIGxldCBidWJibGVJbnRlcnZhbCA9IG51bGw7CiAgICAgICAgbGV0IHNwZWVkID0gMjsKCiAgICAgICAgLy8gQmVhdXRpZnVsIGJ1YmJsZSBjb2xvcnMgKHNlbWktdHJhbnNwYXJlbnQsIGlyaWRlc2NlbnQgbG9vaykKICAgICAgICBjb25zdCBidWJibGVDb2xvcnMgPSBbCiAgICAgICAgICAgICdyYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDMwJSAzMCUsIHJnYmEoMjU1LCAxNTAsIDIwMCwgMC40KSwgcmdiYSgyMDAsIDEwMCwgMjU1LCAwLjIpKScsCiAgICAgICAgICAgICdyYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDMwJSAzMCUsIHJnYmEoMTUwLCAyMDAsIDI1NSwgMC40KSwgcmdiYSgxMDAsIDE1MCwgMjU1LCAwLjIpKScsCiAgICAgICAgICAgICdyYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDMwJSAzMCUsIHJnYmEoMjAwLCAyNTUsIDIwMCwgMC40KSwgcmdiYSgxMDAsIDIwMCwgMTUwLCAwLjIpKScsCiAgICAgICAgICAgICdyYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDMwJSAzMCUsIHJnYmEoMjU1LCAyMjAsIDE1MCwgMC40KSwgcmdiYSgyNTUsIDE4MCwgMTAwLCAwLjIpKScsCiAgICAgICAgICAgICdyYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDMwJSAzMCUsIHJnYmEoMjAwLCAxNTAsIDI1NSwgMC40KSwgcmdiYSgxNTAsIDEwMCwgMjAwLCAwLjIpKScsCiAgICAgICAgICAgICdyYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDMwJSAzMCUsIHJnYmEoMTUwLCAyNTUsIDI1NSwgMC40KSwgcmdiYSgxMDAsIDIwMCwgMjAwLCAwLjIpKScsCiAgICAgICAgXTsKCiAgICAgICAgY29uc3QgcG9wQ29sb3JzID0gWwogICAgICAgICAgICAnI2ZmOTZjOCcsICcjOTZjOGZmJywgJyNjOGZmYzgnLCAnI2ZmZDg5NicsICcjYzg5NmZmJywgJyM5NmZmZmYnCiAgICAgICAgXTsKCiAgICAgICAgZnVuY3Rpb24gY3JlYXRlQnViYmxlKCkgewogICAgICAgICAgICBpZiAoIWlzUGxheWluZykgcmV0dXJuOwoKICAgICAgICAgICAgY29uc3QgYnViYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIGJ1YmJsZS5jbGFzc05hbWUgPSAnYnViYmxlJzsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFJhbmRvbSBzaXplIChiaWdnZXIgZm9yIGVhc2llciBjbGlja2luZykKICAgICAgICAgICAgY29uc3Qgc2l6ZSA9IDYwICsgTWF0aC5yYW5kb20oKSAqIDgwOwogICAgICAgICAgICBidWJibGUuc3R5bGUud2lkdGggPSBzaXplICsgJ3B4JzsKICAgICAgICAgICAgYnViYmxlLnN0eWxlLmhlaWdodCA9IHNpemUgKyAncHgnOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gUmFuZG9tIGhvcml6b250YWwgcG9zaXRpb24KICAgICAgICAgICAgYnViYmxlLnN0eWxlLmxlZnQgPSAoTWF0aC5yYW5kb20oKSAqICh3aW5kb3cuaW5uZXJXaWR0aCAtIHNpemUpKSArICdweCc7CiAgICAgICAgICAgIGJ1YmJsZS5zdHlsZS5ib3R0b20gPSAnLScgKyAoc2l6ZSArIDIwKSArICdweCc7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBSYW5kb20gY29sb3IKICAgICAgICAgICAgY29uc3QgY29sb3JJbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGJ1YmJsZUNvbG9ycy5sZW5ndGgpOwogICAgICAgICAgICBidWJibGUuc3R5bGUuYmFja2dyb3VuZCA9IGJ1YmJsZUNvbG9yc1tjb2xvckluZGV4XTsKICAgICAgICAgICAgYnViYmxlLnN0eWxlLmJvcmRlciA9ICcycHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjMpJzsKICAgICAgICAgICAgYnViYmxlLnN0eWxlLmJveFNoYWRvdyA9IGAKICAgICAgICAgICAgICAgIGluc2V0IDAgMCAke3NpemUvM31weCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSksCiAgICAgICAgICAgICAgICAwIDAgJHtzaXplLzR9cHggcmdiYSgxMDAsIDE1MCwgMjU1LCAwLjIpCiAgICAgICAgICAgIGA7CiAgICAgICAgICAgIGJ1YmJsZS5kYXRhc2V0LmNvbG9ySW5kZXggPSBjb2xvckluZGV4OwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQW5pbWF0aW9uIGR1cmF0aW9uIGJhc2VkIG9uIHNwZWVkCiAgICAgICAgICAgIGNvbnN0IGR1cmF0aW9uID0gKDEyIC0gc3BlZWQgKiAyKSArIE1hdGgucmFuZG9tKCkgKiAzOwogICAgICAgICAgICBidWJibGUuc3R5bGUuYW5pbWF0aW9uRHVyYXRpb24gPSBkdXJhdGlvbiArICdzJzsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFNsaWdodCBob3Jpem9udGFsIHdvYmJsZQogICAgICAgICAgICBjb25zdCB3b2JibGUgPSAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiAxMDA7CiAgICAgICAgICAgIGJ1YmJsZS5zdHlsZS5zZXRQcm9wZXJ0eSgnLS13b2JibGUnLCB3b2JibGUgKyAncHgnKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIENsaWNrIGhhbmRsZXIKICAgICAgICAgICAgYnViYmxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcG9wQnViYmxlKGJ1YmJsZSkpOwogICAgICAgICAgICAKICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGJ1YmJsZSk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBSZW1vdmUgd2hlbiBhbmltYXRpb24gZW5kcwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIGlmIChidWJibGUucGFyZW50Tm9kZSkgewogICAgICAgICAgICAgICAgICAgIGJ1YmJsZS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgZHVyYXRpb24gKiAxMDAwKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHBvcEJ1YmJsZShidWJibGUpIHsKICAgICAgICAgICAgaW5pdEF1ZGlvKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCByZWN0ID0gYnViYmxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgICBjb25zdCBjZW50ZXJYID0gcmVjdC5sZWZ0ICsgcmVjdC53aWR0aCAvIDI7CiAgICAgICAgICAgIGNvbnN0IGNlbnRlclkgPSByZWN0LnRvcCArIHJlY3QuaGVpZ2h0IC8gMjsKICAgICAgICAgICAgY29uc3QgY29sb3JJbmRleCA9IHBhcnNlSW50KGJ1YmJsZS5kYXRhc2V0LmNvbG9ySW5kZXgpOwogICAgICAgICAgICBjb25zdCBjb2xvciA9IHBvcENvbG9yc1tjb2xvckluZGV4XTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFBsYXkgcG9wIHNvdW5kCiAgICAgICAgICAgIHBsYXlQb3BTb3VuZCgpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQ3JlYXRlIHBvcCBwYXJ0aWNsZXMKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMjsgaSsrKSB7CiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0aWNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgcGFydGljbGUuY2xhc3NOYW1lID0gJ3BvcC1wYXJ0aWNsZSc7CiAgICAgICAgICAgICAgICBwYXJ0aWNsZS5zdHlsZS53aWR0aCA9ICg1ICsgTWF0aC5yYW5kb20oKSAqIDEwKSArICdweCc7CiAgICAgICAgICAgICAgICBwYXJ0aWNsZS5zdHlsZS5oZWlnaHQgPSBwYXJ0aWNsZS5zdHlsZS53aWR0aDsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLmJhY2tncm91bmQgPSBjb2xvcjsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLmxlZnQgPSBjZW50ZXJYICsgJ3B4JzsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLnRvcCA9IGNlbnRlclkgKyAncHgnOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb25zdCBhbmdsZSA9IChpIC8gMTIpICogTWF0aC5QSSAqIDI7CiAgICAgICAgICAgICAgICBjb25zdCB2ZWxvY2l0eSA9IDMwICsgTWF0aC5yYW5kb20oKSAqIDUwOwogICAgICAgICAgICAgICAgcGFydGljbGUuc3R5bGUuc2V0UHJvcGVydHkoJy0tdHgnLCBNYXRoLmNvcyhhbmdsZSkgKiB2ZWxvY2l0eSArICdweCcpOwogICAgICAgICAgICAgICAgcGFydGljbGUuc3R5bGUuc2V0UHJvcGVydHkoJy0tdHknLCBNYXRoLnNpbihhbmdsZSkgKiB2ZWxvY2l0eSArICdweCcpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocGFydGljbGUpOwogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBwYXJ0aWNsZS5yZW1vdmUoKSwgNjAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQ3JlYXRlIGV4cGFuZGluZyByaW5nCiAgICAgICAgICAgIGNvbnN0IHJpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgcmluZy5jbGFzc05hbWUgPSAncG9wLXJpbmcnOwogICAgICAgICAgICByaW5nLnN0eWxlLmJvcmRlckNvbG9yID0gY29sb3I7CiAgICAgICAgICAgIHJpbmcuc3R5bGUubGVmdCA9IChjZW50ZXJYIC0gNzUpICsgJ3B4JzsKICAgICAgICAgICAgcmluZy5zdHlsZS50b3AgPSAoY2VudGVyWSAtIDc1KSArICdweCc7CiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChyaW5nKTsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByaW5nLnJlbW92ZSgpLCA1MDApOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gVXBkYXRlIHNjb3JlCiAgICAgICAgICAgIHNjb3JlKys7CiAgICAgICAgICAgIHNjb3JlRWwudGV4dENvbnRlbnQgPSBzY29yZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFJlbW92ZSBidWJibGUKICAgICAgICAgICAgYnViYmxlLnJlbW92ZSgpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gcGxheVBvcFNvdW5kKCkgewogICAgICAgICAgICAvLyBTb2Z0LCBzYXRpc2Z5aW5nIHBvcCBzb3VuZAogICAgICAgICAgICBjb25zdCBvc2MgPSBhdWRpb0N0eC5jcmVhdGVPc2NpbGxhdG9yKCk7CiAgICAgICAgICAgIGNvbnN0IGdhaW4gPSBhdWRpb0N0eC5jcmVhdGVHYWluKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBvc2MudHlwZSA9ICdzaW5lJzsKICAgICAgICAgICAgb3NjLmZyZXF1ZW5jeS5zZXRWYWx1ZUF0VGltZSg4MDAgKyBNYXRoLnJhbmRvbSgpICogNDAwLCBhdWRpb0N0eC5jdXJyZW50VGltZSk7CiAgICAgICAgICAgIG9zYy5mcmVxdWVuY3kuZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgyMDAsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lICsgMC4xKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGdhaW4uZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLjMsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lKTsKICAgICAgICAgICAgZ2Fpbi5nYWluLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUoMC4wMSwgYXVkaW9DdHguY3VycmVudFRpbWUgKyAwLjE1KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIG9zYy5jb25uZWN0KGdhaW4pOwogICAgICAgICAgICBnYWluLmNvbm5lY3QoYXVkaW9DdHguZGVzdGluYXRpb24pOwogICAgICAgICAgICAKICAgICAgICAgICAgb3NjLnN0YXJ0KCk7CiAgICAgICAgICAgIG9zYy5zdG9wKGF1ZGlvQ3R4LmN1cnJlbnRUaW1lICsgMC4xNSk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBzdGFydEJ1YmJsZXMoKSB7CiAgICAgICAgICAgIGlmIChidWJibGVJbnRlcnZhbCkgcmV0dXJuOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQ3JlYXRlIGJ1YmJsZXMgYXQgaW50ZXJ2YWwgYmFzZWQgb24gc3BlZWQKICAgICAgICAgICAgY29uc3QgaW50ZXJ2YWwgPSAyMDAwIC0gKHNwZWVkICogMzAwKTsKICAgICAgICAgICAgYnViYmxlSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChjcmVhdGVCdWJibGUsIE1hdGgubWF4KDUwMCwgaW50ZXJ2YWwpKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIENyZWF0ZSBmaXJzdCBidWJibGUgaW1tZWRpYXRlbHkKICAgICAgICAgICAgY3JlYXRlQnViYmxlKCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBzdG9wQnViYmxlcygpIHsKICAgICAgICAgICAgaWYgKGJ1YmJsZUludGVydmFsKSB7CiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGJ1YmJsZUludGVydmFsKTsKICAgICAgICAgICAgICAgIGJ1YmJsZUludGVydmFsID0gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gRXZlbnQgbGlzdGVuZXJzCiAgICAgICAgcGxheUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgaXNQbGF5aW5nID0gdHJ1ZTsKICAgICAgICAgICAgcGxheUJ0bi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICAgICAgcGF1c2VCdG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7CiAgICAgICAgICAgIHN0YXJ0QnViYmxlcygpOwogICAgICAgIH0pOwoKICAgICAgICBwYXVzZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgaXNQbGF5aW5nID0gZmFsc2U7CiAgICAgICAgICAgIHBhdXNlQnRuLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgICAgICBwbGF5QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwogICAgICAgICAgICBzdG9wQnViYmxlcygpOwogICAgICAgIH0pOwoKICAgICAgICByZXNldEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgc2NvcmUgPSAwOwogICAgICAgICAgICBzY29yZUVsLnRleHRDb250ZW50ID0gJzAnOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gUmVtb3ZlIGFsbCBidWJibGVzCiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5idWJibGUnKS5mb3JFYWNoKGIgPT4gYi5yZW1vdmUoKSk7CiAgICAgICAgfSk7CgogICAgICAgIHNwZWVkU2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGUpID0+IHsKICAgICAgICAgICAgc3BlZWQgPSBwYXJzZUludChlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBSZXN0YXJ0IHdpdGggbmV3IHNwZWVkIGlmIHBsYXlpbmcKICAgICAgICAgICAgaWYgKGlzUGxheWluZykgewogICAgICAgICAgICAgICAgc3RvcEJ1YmJsZXMoKTsKICAgICAgICAgICAgICAgIHN0YXJ0QnViYmxlcygpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIC8vIEZpcnN0IGludGVyYWN0aW9uIHRvIGluaXQgYXVkaW8KICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgaW5pdEF1ZGlvKCk7CiAgICAgICAgfSwgeyBvbmNlOiB0cnVlIH0pOwoKICAgICAgICAvLyBGdWxsc2NyZWVuCiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZGJsY2xpY2snLCAoZSkgPT4gewogICAgICAgICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdidWJibGUnKSkgcmV0dXJuOwogICAgICAgICAgICBpZiAoIWRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50KSB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4oKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgLy8gU3RhcnQKICAgICAgICBzdGFydEJ1YmJsZXMoKTsKICAgIDwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4K",
            spojrzenie: "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9InBsIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+UG9kxIXFvGFqIHphIFNwb2pyemVuaWVtPC90aXRsZT4KICAgIDxzdHlsZT4KICAgICAgICAqIHsKICAgICAgICAgICAgbWFyZ2luOiAwOwogICAgICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogICAgICAgIH0KCiAgICAgICAgYm9keSB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMwYTBhMTUgMCUsICMwZjBmMWYgMTAwJSk7CiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDEwMHZoOwogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgICAgICBmb250LWZhbWlseTogc3lzdGVtLXVpLCBzYW5zLXNlcmlmOwogICAgICAgIH0KCiAgICAgICAgLmNvbnRhaW5lciB7CiAgICAgICAgICAgIHdpZHRoOiAxMDB2dzsKICAgICAgICAgICAgaGVpZ2h0OiAxMDB2aDsKICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgICB9CgogICAgICAgIC8qIENlbnRyYWwgY2hhcmFjdGVyIGZhY2UgKi8KICAgICAgICAuZmFjZS1jb250YWluZXIgewogICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgICAgIHdpZHRoOiAyMDBweDsKICAgICAgICAgICAgaGVpZ2h0OiAyMDBweDsKICAgICAgICB9CgogICAgICAgIC5mYWNlIHsKICAgICAgICAgICAgd2lkdGg6IDIwMHB4OwogICAgICAgICAgICBoZWlnaHQ6IDIwMHB4OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDMwJSAzMCUsICNmZmU0YjUsICNkZWI4ODcpOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDQwcHggcmdiYSgwLCAwLCAwLCAwLjMpOwogICAgICAgIH0KCiAgICAgICAgLyogRXllcyBjb250YWluZXIgKi8KICAgICAgICAuZXllcyB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgdG9wOiA3MHB4OwogICAgICAgICAgICBsZWZ0OiAzMHB4OwogICAgICAgICAgICByaWdodDogMzBweDsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICAgIH0KCiAgICAgICAgLmV5ZSB7CiAgICAgICAgICAgIHdpZHRoOiA0NXB4OwogICAgICAgICAgICBoZWlnaHQ6IDQ1cHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHdoaXRlOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICB9CgogICAgICAgIC5wdXBpbCB7CiAgICAgICAgICAgIHdpZHRoOiAyMHB4OwogICAgICAgICAgICBoZWlnaHQ6IDIwcHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMyYzE4MTA7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICB0b3A6IDUwJTsKICAgICAgICAgICAgbGVmdDogNTAlOwogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsKICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuNXMgZWFzZS1vdXQ7CiAgICAgICAgfQoKICAgICAgICAucHVwaWw6OmFmdGVyIHsKICAgICAgICAgICAgY29udGVudDogJyc7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgd2lkdGg6IDZweDsKICAgICAgICAgICAgaGVpZ2h0OiA2cHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHdoaXRlOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgICAgIHRvcDogNHB4OwogICAgICAgICAgICBsZWZ0OiA0cHg7CiAgICAgICAgfQoKICAgICAgICAvKiBMb29raW5nIGRpcmVjdGlvbnMgKi8KICAgICAgICAuZXllcy5sb29rLWxlZnQgLnB1cGlsIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTEwMCUsIC01MCUpOyB9CiAgICAgICAgLmV5ZXMubG9vay1yaWdodCAucHVwaWwgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgwJSwgLTUwJSk7IH0KICAgICAgICAuZXllcy5sb29rLXVwIC5wdXBpbCB7IHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC0xMDAlKTsgfQogICAgICAgIC5leWVzLmxvb2stZG93biAucHVwaWwgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAwJSk7IH0KICAgICAgICAuZXllcy5sb29rLWNlbnRlciAucHVwaWwgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsgfQoKICAgICAgICAvKiBTbWlsZSAqLwogICAgICAgIC5zbWlsZSB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgYm90dG9tOiA1MHB4OwogICAgICAgICAgICBsZWZ0OiA1MCU7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKICAgICAgICAgICAgd2lkdGg6IDYwcHg7CiAgICAgICAgICAgIGhlaWdodDogMjVweDsKICAgICAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgICAgICBib3JkZXItYm90dG9tOiA0cHggc29saWQgIzhiNDUxMzsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMCAwIDYwcHggNjBweDsKICAgICAgICB9CgogICAgICAgIC8qIExpZ2h0IG9yYnMgYXQgY29ybmVycyAqLwogICAgICAgIC5saWdodC1zcG90IHsKICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICB3aWR0aDogMTAwcHg7CiAgICAgICAgICAgIGhlaWdodDogMTAwcHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgb3BhY2l0eTogMDsKICAgICAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgwKTsKICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuNXMgZWFzZS1vdXQ7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgfQoKICAgICAgICAubGlnaHQtc3BvdC52aXNpYmxlIHsKICAgICAgICAgICAgb3BhY2l0eTogMTsKICAgICAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxKTsKICAgICAgICB9CgogICAgICAgIC5saWdodC1zcG90LnB1bHNlIHsKICAgICAgICAgICAgYW5pbWF0aW9uOiBsaWdodFB1bHNlIDFzIGVhc2UtaW4tb3V0IGluZmluaXRlOwogICAgICAgIH0KCiAgICAgICAgQGtleWZyYW1lcyBsaWdodFB1bHNlIHsKICAgICAgICAgICAgMCUsIDEwMCUgeyAKICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMSk7CiAgICAgICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgNDBweCB2YXIoLS1nbG93LWNvbG9yKTsKICAgICAgICAgICAgfQogICAgICAgICAgICA1MCUgeyAKICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgICAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMCA3MHB4IHZhcigtLWdsb3ctY29sb3IpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAubGlnaHQtc3BvdC5sZWZ0IHsKICAgICAgICAgICAgbGVmdDogNTBweDsKICAgICAgICAgICAgdG9wOiA1MCU7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKSBzY2FsZSgwKTsKICAgICAgICB9CiAgICAgICAgLmxpZ2h0LXNwb3QubGVmdC52aXNpYmxlIHsKICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpIHNjYWxlKDEpOwogICAgICAgIH0KCiAgICAgICAgLmxpZ2h0LXNwb3QucmlnaHQgewogICAgICAgICAgICByaWdodDogNTBweDsKICAgICAgICAgICAgdG9wOiA1MCU7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKSBzY2FsZSgwKTsKICAgICAgICB9CiAgICAgICAgLmxpZ2h0LXNwb3QucmlnaHQudmlzaWJsZSB7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKSBzY2FsZSgxKTsKICAgICAgICB9CgogICAgICAgIC5saWdodC1zcG90LnRvcCB7CiAgICAgICAgICAgIHRvcDogNTBweDsKICAgICAgICAgICAgbGVmdDogNTAlOwogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSkgc2NhbGUoMCk7CiAgICAgICAgfQogICAgICAgIC5saWdodC1zcG90LnRvcC52aXNpYmxlIHsKICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpIHNjYWxlKDEpOwogICAgICAgIH0KCiAgICAgICAgLmxpZ2h0LXNwb3QuYm90dG9tIHsKICAgICAgICAgICAgYm90dG9tOiA4MHB4OwogICAgICAgICAgICBsZWZ0OiA1MCU7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKSBzY2FsZSgwKTsKICAgICAgICB9CiAgICAgICAgLmxpZ2h0LXNwb3QuYm90dG9tLnZpc2libGUgewogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSkgc2NhbGUoMSk7CiAgICAgICAgfQoKICAgICAgICAubGlnaHQtc3BvdCAuaWNvbiB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogNTBweDsKICAgICAgICB9CgogICAgICAgIC8qIFN1Y2Nlc3MgY2VsZWJyYXRpb24gKi8KICAgICAgICAucGFydGljbGUgewogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICAgICAgICAgIGFuaW1hdGlvbjogcGFydGljbGVCdXJzdCAxcyBlYXNlLW91dCBmb3J3YXJkczsKICAgICAgICB9CgogICAgICAgIEBrZXlmcmFtZXMgcGFydGljbGVCdXJzdCB7CiAgICAgICAgICAgIDAlIHsKICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDAsIDApIHNjYWxlKDEpOwogICAgICAgICAgICAgICAgb3BhY2l0eTogMTsKICAgICAgICAgICAgfQogICAgICAgICAgICAxMDAlIHsKICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKHZhcigtLXR4KSwgdmFyKC0tdHkpKSBzY2FsZSgwKTsKICAgICAgICAgICAgICAgIG9wYWNpdHk6IDA7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8qIEluc3RydWN0aW9ucyAqLwogICAgICAgIC5pbnN0cnVjdGlvbiB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICAgICAgdG9wOiA0MHB4OwogICAgICAgICAgICBsZWZ0OiA1MCU7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKICAgICAgICAgICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC43KTsKICAgICAgICAgICAgZm9udC1zaXplOiAyMnB4OwogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjNzOwogICAgICAgIH0KCiAgICAgICAgLmluc3RydWN0aW9uLmhpZ2hsaWdodCB7CiAgICAgICAgICAgIGNvbG9yOiByZ2JhKDI1NSwgMjIwLCAxMDAsIDAuOSk7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjZweDsKICAgICAgICB9CgogICAgICAgIC5pbnN0cnVjdGlvbi5zdWNjZXNzIHsKICAgICAgICAgICAgY29sb3I6IHJnYmEoMTAwLCAyNTUsIDE1MCwgMC45KTsKICAgICAgICB9CgogICAgICAgIC8qIFNjb3JlICovCiAgICAgICAgLnNjb3JlLWRpc3BsYXkgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIHRvcDogMzBweDsKICAgICAgICAgICAgcmlnaHQ6IDQwcHg7CiAgICAgICAgICAgIHRleHQtYWxpZ246IHJpZ2h0OwogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjQpOwogICAgICAgIH0KCiAgICAgICAgLnNjb3JlLWRpc3BsYXkgLnNjb3JlIHsKICAgICAgICAgICAgZm9udC1zaXplOiA0OHB4OwogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjYpOwogICAgICAgIH0KCiAgICAgICAgLyogTGV2ZWwgaW5kaWNhdG9yICovCiAgICAgICAgLmxldmVsLWRpc3BsYXkgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIHRvcDogMzBweDsKICAgICAgICAgICAgbGVmdDogNDBweDsKICAgICAgICAgICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC41KTsKICAgICAgICAgICAgZm9udC1zaXplOiAxNnB4OwogICAgICAgIH0KCiAgICAgICAgLmxldmVsLWRpc3BsYXkgLmxldmVsIHsKICAgICAgICAgICAgZm9udC1zaXplOiAyNHB4OwogICAgICAgIH0KCiAgICAgICAgLyogQ29udHJvbHMgKi8KICAgICAgICAuY29udHJvbHMgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIGJvdHRvbTogMzBweDsKICAgICAgICAgICAgbGVmdDogNTAlOwogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGdhcDogMTVweDsKICAgICAgICB9CgogICAgICAgIC5jb250cm9sLWJ0biB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOwogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjUpOwogICAgICAgICAgICBwYWRkaW5nOiAxMnB4IDI1cHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDI1cHg7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zczsKICAgICAgICB9CgogICAgICAgIC5jb250cm9sLWJ0bjpob3ZlciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgIH0KCiAgICAgICAgLyogU3RhcnQgb3ZlcmxheSAqLwogICAgICAgIC5zdGFydC1vdmVybGF5IHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICB0b3A6IDA7CiAgICAgICAgICAgIGxlZnQ6IDA7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC45NSk7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICB6LWluZGV4OiAxMDAwOwogICAgICAgICAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuNXM7CiAgICAgICAgfQoKICAgICAgICAuc3RhcnQtb3ZlcmxheS5oaWRkZW4gewogICAgICAgICAgICBvcGFjaXR5OiAwOwogICAgICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgICAgICB9CgogICAgICAgIC5zdGFydC1idG4gewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjNGE1YTZhLCAjM2E0YTVhKTsKICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgIzZhN2E4YTsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgICAgICBwYWRkaW5nOiAzMHB4IDYwcHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwcHg7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjRweDsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zczsKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMzBweDsKICAgICAgICB9CgogICAgICAgIC5zdGFydC1idG46aG92ZXIgewogICAgICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMDUpOwogICAgICAgIH0KCiAgICAgICAgLnN0YXJ0LWluZm8gewogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjUpOwogICAgICAgICAgICBmb250LXNpemU6IDE2cHg7CiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgICAgICAgICAgbWF4LXdpZHRoOiA0NTBweDsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuODsKICAgICAgICB9CgogICAgICAgIC5zdGFydC1pbmZvIHN0cm9uZyB7CiAgICAgICAgICAgIGNvbG9yOiByZ2JhKDI1NSwgMjIwLCAxMDAsIDAuOSk7CiAgICAgICAgfQogICAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KICAgIDxkaXYgY2xhc3M9InN0YXJ0LW92ZXJsYXkiIGlkPSJzdGFydE92ZXJsYXkiPgogICAgICAgIDxidXR0b24gY2xhc3M9InN0YXJ0LWJ0biIgaWQ9InN0YXJ0QnRuIj7ilrYgUm96cG9jem5pajwvYnV0dG9uPgogICAgICAgIDxkaXYgY2xhc3M9InN0YXJ0LWluZm8iPgogICAgICAgICAgICBCdcW6a2EgYsSZZHppZSA8c3Ryb25nPnBhdHJ6ZcSHIHcga2llcnVua3U8L3N0cm9uZz4gZ2R6aWUgcG9qYXdpIHNpxJkgxZt3aWF0ZcWCa28uPGJyPjxicj4KICAgICAgICAgICAgUG9tw7PFvCBkemllY2t1IHphdXdhxbx5xIc6ICJQYXRyeiwgZ2R6aWUgcGF0cnp5IGJ1xbprYSEiPGJyPgogICAgICAgICAgICBHZHkgZHppZWNrbyBrbGlrbmllIMWbd2lhdGXFgmtvIOKAlCBuYWdyb2RhITxicj48YnI+CiAgICAgICAgICAgIFRvIHVjenkgPHN0cm9uZz53c3DDs2xuZWogdXdhZ2k8L3N0cm9uZz4g4oCUIHBvZMSFxbxhbmlhIHphIHNwb2pyemVuaWVtLgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0iY29udGFpbmVyIiBpZD0iY29udGFpbmVyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0cnVjdGlvbiIgaWQ9Imluc3RydWN0aW9uIj5QYXRyeiwgZ2R6aWUgcGF0cnrEmSE8L2Rpdj4KCiAgICAgICAgPCEtLSBMaWdodCBzcG90cyBhdCBlZGdlcyAtLT4KICAgICAgICA8ZGl2IGNsYXNzPSJsaWdodC1zcG90IGxlZnQiIGlkPSJzcG90TGVmdCI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJpY29uIj7irZA8L3NwYW4+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ibGlnaHQtc3BvdCByaWdodCIgaWQ9InNwb3RSaWdodCI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJpY29uIj7irZA8L3NwYW4+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ibGlnaHQtc3BvdCB0b3AiIGlkPSJzcG90VG9wIj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9Imljb24iPuKtkDwvc3Bhbj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJsaWdodC1zcG90IGJvdHRvbSIgaWQ9InNwb3RCb3R0b20iPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbiI+4q2QPC9zcGFuPgogICAgICAgIDwvZGl2PgoKICAgICAgICA8IS0tIENlbnRyYWwgZmFjZSAtLT4KICAgICAgICA8ZGl2IGNsYXNzPSJmYWNlLWNvbnRhaW5lciI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZhY2UiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZXllcyBsb29rLWNlbnRlciIgaWQ9ImV5ZXMiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImV5ZSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InB1cGlsIj48L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJleWUiPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwdXBpbCI+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InNtaWxlIj48L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9ImxldmVsLWRpc3BsYXkiPgogICAgICAgICAgICBQb3ppb208YnI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJsZXZlbCIgaWQ9ImxldmVsIj4xPC9zcGFuPgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJzY29yZS1kaXNwbGF5Ij4KICAgICAgICAgICAgUHVua3R5PGJyPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ic2NvcmUiIGlkPSJzY29yZSI+MDwvc3Bhbj4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImNvbnRyb2xzIj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJjb250cm9sLWJ0biIgaWQ9ImF1dG9CdG4iPuKWtiBBdXRvPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iY29udHJvbC1idG4iIGlkPSJyZXNldEJ0biI+T2Qgbm93YTwvYnV0dG9uPgogICAgPC9kaXY+CgogICAgPHNjcmlwdD4KICAgICAgICBjb25zdCBBdWRpb0NvbnRleHQgPSB3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQ7CiAgICAgICAgbGV0IGF1ZGlvQ3R4ID0gbnVsbDsKCiAgICAgICAgZnVuY3Rpb24gaW5pdEF1ZGlvKCkgewogICAgICAgICAgICBpZiAoIWF1ZGlvQ3R4KSB7CiAgICAgICAgICAgICAgICBhdWRpb0N0eCA9IG5ldyBBdWRpb0NvbnRleHQoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoYXVkaW9DdHguc3RhdGUgPT09ICdzdXNwZW5kZWQnKSB7CiAgICAgICAgICAgICAgICBhdWRpb0N0eC5yZXN1bWUoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gRWxlbWVudHMKICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFpbmVyJyk7CiAgICAgICAgY29uc3QgZXllcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleWVzJyk7CiAgICAgICAgY29uc3QgaW5zdHJ1Y3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5zdHJ1Y3Rpb24nKTsKICAgICAgICBjb25zdCBzY29yZUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Njb3JlJyk7CiAgICAgICAgY29uc3QgbGV2ZWxFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsZXZlbCcpOwogICAgICAgIGNvbnN0IHN0YXJ0T3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydE92ZXJsYXknKTsKICAgICAgICBjb25zdCBzdGFydEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydEJ0bicpOwogICAgICAgIGNvbnN0IGF1dG9CdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXV0b0J0bicpOwogICAgICAgIGNvbnN0IHJlc2V0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc2V0QnRuJyk7CgogICAgICAgIGNvbnN0IHNwb3RzID0gewogICAgICAgICAgICBsZWZ0OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3BvdExlZnQnKSwKICAgICAgICAgICAgcmlnaHQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzcG90UmlnaHQnKSwKICAgICAgICAgICAgdG9wOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3BvdFRvcCcpLAogICAgICAgICAgICBib3R0b206IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzcG90Qm90dG9tJykKICAgICAgICB9OwoKICAgICAgICBjb25zdCBjb2xvcnMgPSBbJyNmZjZiNmInLCAnIzRlY2RjNCcsICcjZmZlNjZkJywgJyM5NWUxZDMnLCAnI2RkYTBkZCcsICcjODdjZWViJ107CgogICAgICAgIC8vIFN0YXRlCiAgICAgICAgbGV0IHNjb3JlID0gMDsKICAgICAgICBsZXQgbGV2ZWwgPSAxOwogICAgICAgIGxldCBjdXJyZW50RGlyZWN0aW9uID0gbnVsbDsKICAgICAgICBsZXQgaXNXYWl0aW5nID0gZmFsc2U7CiAgICAgICAgbGV0IGF1dG9JbnRlcnZhbCA9IG51bGw7CiAgICAgICAgbGV0IGxvb2tEZWxheSA9IDE1MDA7IC8vIFRpbWUgYmVmb3JlIGxpZ2h0IGFwcGVhcnMgYWZ0ZXIgbG9va2luZwoKICAgICAgICAvLyBEaXJlY3Rpb25zIG1hcHBpbmcKICAgICAgICBjb25zdCBkaXJlY3Rpb25zID0gWydsZWZ0JywgJ3JpZ2h0JywgJ3RvcCcsICdib3R0b20nXTsKCiAgICAgICAgZnVuY3Rpb24gbG9va0F0KGRpcmVjdGlvbikgewogICAgICAgICAgICBleWVzLmNsYXNzTmFtZSA9ICdleWVzJzsKICAgICAgICAgICAgaWYgKGRpcmVjdGlvbikgewogICAgICAgICAgICAgICAgZXllcy5jbGFzc0xpc3QuYWRkKCdsb29rLScgKyBkaXJlY3Rpb24pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZXllcy5jbGFzc0xpc3QuYWRkKCdsb29rLWNlbnRlcicpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBzaG93TGlnaHQoZGlyZWN0aW9uKSB7CiAgICAgICAgICAgIC8vIFNldCByYW5kb20gY29sb3IKICAgICAgICAgICAgY29uc3QgY29sb3IgPSBjb2xvcnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY29sb3JzLmxlbmd0aCldOwogICAgICAgICAgICBjb25zdCBzcG90ID0gc3BvdHNbZGlyZWN0aW9uXTsKICAgICAgICAgICAgc3BvdC5zdHlsZS5iYWNrZ3JvdW5kID0gYHJhZGlhbC1ncmFkaWVudChjaXJjbGUgYXQgMzAlIDMwJSwgJHtjb2xvcn0sICR7Y29sb3J9ODgpYDsKICAgICAgICAgICAgc3BvdC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1nbG93LWNvbG9yJywgY29sb3IpOwogICAgICAgICAgICBzcG90LnN0eWxlLmJveFNoYWRvdyA9IGAwIDAgNDBweCAke2NvbG9yfWA7CiAgICAgICAgICAgIAogICAgICAgICAgICBzcG90LmNsYXNzTGlzdC5hZGQoJ3Zpc2libGUnLCAncHVsc2UnKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGhpZGVBbGxMaWdodHMoKSB7CiAgICAgICAgICAgIE9iamVjdC52YWx1ZXMoc3BvdHMpLmZvckVhY2goc3BvdCA9PiB7CiAgICAgICAgICAgICAgICBzcG90LmNsYXNzTGlzdC5yZW1vdmUoJ3Zpc2libGUnLCAncHVsc2UnKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBwbGF5TG9va1NvdW5kKCkgewogICAgICAgICAgICBpbml0QXVkaW8oKTsKICAgICAgICAgICAgLy8gU29mdCAiYXR0ZW50aW9uIiBzb3VuZAogICAgICAgICAgICBjb25zdCBvc2MgPSBhdWRpb0N0eC5jcmVhdGVPc2NpbGxhdG9yKCk7CiAgICAgICAgICAgIGNvbnN0IGdhaW4gPSBhdWRpb0N0eC5jcmVhdGVHYWluKCk7CiAgICAgICAgICAgIG9zYy50eXBlID0gJ3NpbmUnOwogICAgICAgICAgICBvc2MuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKDYwMCwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICBvc2MuZnJlcXVlbmN5LmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKDgwMCwgYXVkaW9DdHguY3VycmVudFRpbWUgKyAwLjEpOwogICAgICAgICAgICBnYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUoMC4xNSwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICBnYWluLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAxLCBhdWRpb0N0eC5jdXJyZW50VGltZSArIDAuMyk7CiAgICAgICAgICAgIG9zYy5jb25uZWN0KGdhaW4pOwogICAgICAgICAgICBnYWluLmNvbm5lY3QoYXVkaW9DdHguZGVzdGluYXRpb24pOwogICAgICAgICAgICBvc2Muc3RhcnQoKTsKICAgICAgICAgICAgb3NjLnN0b3AoYXVkaW9DdHguY3VycmVudFRpbWUgKyAwLjMpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gcGxheVN1Y2Nlc3NTb3VuZCgpIHsKICAgICAgICAgICAgaW5pdEF1ZGlvKCk7CiAgICAgICAgICAgIGNvbnN0IG5vdGVzID0gWzUyMy4yNSwgNjU5LjI1LCA3ODMuOTldOwogICAgICAgICAgICBub3Rlcy5mb3JFYWNoKChmcmVxLCBpKSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBvc2MgPSBhdWRpb0N0eC5jcmVhdGVPc2NpbGxhdG9yKCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2FpbiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgICAgICAgICAgICAgICAgICBvc2MudHlwZSA9ICdzaW5lJzsKICAgICAgICAgICAgICAgICAgICBvc2MuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKGZyZXEsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lKTsKICAgICAgICAgICAgICAgICAgICBnYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUoMC4yNSwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgICAgIGdhaW4uZ2Fpbi5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKDAuMDEsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lICsgMC41KTsKICAgICAgICAgICAgICAgICAgICBvc2MuY29ubmVjdChnYWluKTsKICAgICAgICAgICAgICAgICAgICBnYWluLmNvbm5lY3QoYXVkaW9DdHguZGVzdGluYXRpb24pOwogICAgICAgICAgICAgICAgICAgIG9zYy5zdGFydCgpOwogICAgICAgICAgICAgICAgICAgIG9zYy5zdG9wKGF1ZGlvQ3R4LmN1cnJlbnRUaW1lICsgMC41KTsKICAgICAgICAgICAgICAgIH0sIGkgKiAxMDApOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVBhcnRpY2xlcyh4LCB5LCBjb2xvcikgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDIwOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRpY2xlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICBwYXJ0aWNsZS5jbGFzc05hbWUgPSAncGFydGljbGUnOwogICAgICAgICAgICAgICAgcGFydGljbGUuc3R5bGUud2lkdGggPSAoOCArIE1hdGgucmFuZG9tKCkgKiAxMCkgKyAncHgnOwogICAgICAgICAgICAgICAgcGFydGljbGUuc3R5bGUuaGVpZ2h0ID0gcGFydGljbGUuc3R5bGUud2lkdGg7CiAgICAgICAgICAgICAgICBwYXJ0aWNsZS5zdHlsZS5iYWNrZ3JvdW5kID0gY29sb3I7CiAgICAgICAgICAgICAgICBwYXJ0aWNsZS5zdHlsZS5sZWZ0ID0geCArICdweCc7CiAgICAgICAgICAgICAgICBwYXJ0aWNsZS5zdHlsZS50b3AgPSB5ICsgJ3B4JzsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29uc3QgYW5nbGUgPSAoaSAvIDIwKSAqIE1hdGguUEkgKiAyOwogICAgICAgICAgICAgICAgY29uc3QgdmVsb2NpdHkgPSA4MCArIE1hdGgucmFuZG9tKCkgKiA4MDsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLnNldFByb3BlcnR5KCctLXR4JywgTWF0aC5jb3MoYW5nbGUpICogdmVsb2NpdHkgKyAncHgnKTsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLnNldFByb3BlcnR5KCctLXR5JywgTWF0aC5zaW4oYW5nbGUpICogdmVsb2NpdHkgKyAncHgnKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHBhcnRpY2xlKTsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcGFydGljbGUucmVtb3ZlKCksIDEwMDApOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBzdGFydFJvdW5kKCkgewogICAgICAgICAgICBpZiAoaXNXYWl0aW5nKSByZXR1cm47CiAgICAgICAgICAgIAogICAgICAgICAgICBoaWRlQWxsTGlnaHRzKCk7CiAgICAgICAgICAgIGxvb2tBdCgnY2VudGVyJyk7CiAgICAgICAgICAgIGluc3RydWN0aW9uLnRleHRDb250ZW50ID0gJ1BhdHJ6IG5hIG1uaWUuLi4nOwogICAgICAgICAgICBpbnN0cnVjdGlvbi5jbGFzc05hbWUgPSAnaW5zdHJ1Y3Rpb24nOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gV2FpdCwgdGhlbiBsb29rIGluIGRpcmVjdGlvbgogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIGN1cnJlbnREaXJlY3Rpb24gPSBkaXJlY3Rpb25zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGRpcmVjdGlvbnMubGVuZ3RoKV07CiAgICAgICAgICAgICAgICBsb29rQXQoY3VycmVudERpcmVjdGlvbik7CiAgICAgICAgICAgICAgICBwbGF5TG9va1NvdW5kKCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGluc3RydWN0aW9uLnRleHRDb250ZW50ID0gJ1BhdHJ6LCBnZHppZSBwYXRyesSZISc7CiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbi5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHQnKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gQWZ0ZXIgZGVsYXksIHNob3cgbGlnaHQKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHNob3dMaWdodChjdXJyZW50RGlyZWN0aW9uKTsKICAgICAgICAgICAgICAgICAgICBpc1dhaXRpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGluc3RydWN0aW9uLnRleHRDb250ZW50ID0gJ0tsaWtuaWogxZt3aWF0ZcWCa28hJzsKICAgICAgICAgICAgICAgIH0sIGxvb2tEZWxheSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBoYW5kbGVTcG90Q2xpY2soZGlyZWN0aW9uKSB7CiAgICAgICAgICAgIGlmICghaXNXYWl0aW5nKSByZXR1cm47CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoZGlyZWN0aW9uID09PSBjdXJyZW50RGlyZWN0aW9uKSB7CiAgICAgICAgICAgICAgICAvLyBTdWNjZXNzIQogICAgICAgICAgICAgICAgaXNXYWl0aW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICBzY29yZSsrOwogICAgICAgICAgICAgICAgc2NvcmVFbC50ZXh0Q29udGVudCA9IHNjb3JlOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBHZXQgc3BvdCBwb3NpdGlvbiBmb3IgcGFydGljbGVzCiAgICAgICAgICAgICAgICBjb25zdCBzcG90ID0gc3BvdHNbZGlyZWN0aW9uXTsKICAgICAgICAgICAgICAgIGNvbnN0IHJlY3QgPSBzcG90LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgICAgICAgY29uc3QgY29sb3IgPSBzcG90LnN0eWxlLmJhY2tncm91bmQuaW5jbHVkZXMoJyMnKSAKICAgICAgICAgICAgICAgICAgICA/IHNwb3Quc3R5bGUuYmFja2dyb3VuZC5tYXRjaCgvI1thLWYwLTldezZ9L2kpWzBdIAogICAgICAgICAgICAgICAgICAgIDogJyNmZmU2NmQnOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjcmVhdGVQYXJ0aWNsZXMocmVjdC5sZWZ0ICsgcmVjdC53aWR0aC8yLCByZWN0LnRvcCArIHJlY3QuaGVpZ2h0LzIsIGNvbG9yKTsKICAgICAgICAgICAgICAgIHBsYXlTdWNjZXNzU291bmQoKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaGlkZUFsbExpZ2h0cygpOwogICAgICAgICAgICAgICAgbG9va0F0KCdjZW50ZXInKTsKICAgICAgICAgICAgICAgIGluc3RydWN0aW9uLnRleHRDb250ZW50ID0gJ0JSQVdPISDwn4yfJzsKICAgICAgICAgICAgICAgIGluc3RydWN0aW9uLmNsYXNzTmFtZSA9ICdpbnN0cnVjdGlvbiBzdWNjZXNzJzsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gTGV2ZWwgdXAgZXZlcnkgNSBwb2ludHMKICAgICAgICAgICAgICAgIGlmIChzY29yZSAlIDUgPT09IDAgJiYgbG9va0RlbGF5ID4gNTAwKSB7CiAgICAgICAgICAgICAgICAgICAgbGV2ZWwrKzsKICAgICAgICAgICAgICAgICAgICBsZXZlbEVsLnRleHRDb250ZW50ID0gbGV2ZWw7CiAgICAgICAgICAgICAgICAgICAgbG9va0RlbGF5ID0gTWF0aC5tYXgoNTAwLCBsb29rRGVsYXkgLSAyMDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBOZXh0IHJvdW5kCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHN0YXJ0Um91bmQsIDE1MDApOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBFdmVudCBsaXN0ZW5lcnMKICAgICAgICBPYmplY3QuZW50cmllcyhzcG90cykuZm9yRWFjaCgoW2RpcmVjdGlvbiwgc3BvdF0pID0+IHsKICAgICAgICAgICAgc3BvdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IGhhbmRsZVNwb3RDbGljayhkaXJlY3Rpb24pKTsKICAgICAgICB9KTsKCiAgICAgICAgc3RhcnRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgIGluaXRBdWRpbygpOwogICAgICAgICAgICBzdGFydE92ZXJsYXkuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7CiAgICAgICAgICAgIHNldFRpbWVvdXQoc3RhcnRSb3VuZCwgNTAwKTsKICAgICAgICB9KTsKCiAgICAgICAgYXV0b0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgaWYgKGF1dG9JbnRlcnZhbCkgewogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhdXRvSW50ZXJ2YWwpOwogICAgICAgICAgICAgICAgYXV0b0ludGVydmFsID0gbnVsbDsKICAgICAgICAgICAgICAgIGF1dG9CdG4udGV4dENvbnRlbnQgPSAn4pa2IEF1dG8nOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgYXV0b0ludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmICghaXNXYWl0aW5nICYmICFzdGFydE92ZXJsYXkuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSkgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIGlmICghaXNXYWl0aW5nKSBzdGFydFJvdW5kKCk7CiAgICAgICAgICAgICAgICB9LCA0MDAwKTsKICAgICAgICAgICAgICAgIGF1dG9CdG4udGV4dENvbnRlbnQgPSAn4o+4IFN0b3AnOwogICAgICAgICAgICAgICAgaWYgKCFpc1dhaXRpbmcpIHN0YXJ0Um91bmQoKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICByZXNldEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgc2NvcmUgPSAwOwogICAgICAgICAgICBsZXZlbCA9IDE7CiAgICAgICAgICAgIGxvb2tEZWxheSA9IDE1MDA7CiAgICAgICAgICAgIHNjb3JlRWwudGV4dENvbnRlbnQgPSAnMCc7CiAgICAgICAgICAgIGxldmVsRWwudGV4dENvbnRlbnQgPSAnMSc7CiAgICAgICAgICAgIGlzV2FpdGluZyA9IGZhbHNlOwogICAgICAgICAgICBoaWRlQWxsTGlnaHRzKCk7CiAgICAgICAgICAgIGxvb2tBdCgnY2VudGVyJyk7CiAgICAgICAgICAgIGluc3RydWN0aW9uLnRleHRDb250ZW50ID0gJ1BhdHJ6LCBnZHppZSBwYXRyesSZISc7CiAgICAgICAgICAgIGluc3RydWN0aW9uLmNsYXNzTmFtZSA9ICdpbnN0cnVjdGlvbic7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoYXV0b0ludGVydmFsKSB7CiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGF1dG9JbnRlcnZhbCk7CiAgICAgICAgICAgICAgICBhdXRvSW50ZXJ2YWwgPSBudWxsOwogICAgICAgICAgICAgICAgYXV0b0J0bi50ZXh0Q29udGVudCA9ICfilrYgQXV0byc7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgLy8gRnVsbHNjcmVlbgogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgKGUpID0+IHsKICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy5saWdodC1zcG90JykpIHJldHVybjsKICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCkgewogICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICA8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cg==",
            spokoj: "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9InBsIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+U3RyZWZhIFNwb2tvanUgLSBXZXJzamEgVGVyYXBldXR5Y3puYTwvdGl0bGU+CiAgICA8c3R5bGU+CiAgICAgICAgKiB7CiAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAgICAgICB9CgogICAgICAgIGJvZHkgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMDUwNTEwOwogICAgICAgICAgICBtaW4taGVpZ2h0OiAxMDB2aDsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgICAgZm9udC1mYW1pbHk6IHN5c3RlbS11aSwgc2Fucy1zZXJpZjsKICAgICAgICB9CgogICAgICAgIC5jb250YWluZXIgewogICAgICAgICAgICB3aWR0aDogMTAwdnc7CiAgICAgICAgICAgIGhlaWdodDogMTAwdmg7CiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgfQoKICAgICAgICAvKiBNYWluIGJyZWF0aGluZyBjaXJjbGUgKi8KICAgICAgICAuYnJlYXRoaW5nLW9yYiB7CiAgICAgICAgICAgIHdpZHRoOiAyMDBweDsKICAgICAgICAgICAgaGVpZ2h0OiAyMDBweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IDMwJSAzMCUsICMxYTJhNGEsICMwYTE1MjUpOwogICAgICAgICAgICBib3gtc2hhZG93OiAKICAgICAgICAgICAgICAgIDAgMCA2MHB4IHJnYmEoMTAwLCAxNTAsIDIwMCwgMC4yKSwKICAgICAgICAgICAgICAgIGluc2V0IDAgMCA0MHB4IHJnYmEoMTAwLCAxNTAsIDIwMCwgMC4xKTsKICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zczsKICAgICAgICB9CgogICAgICAgIC5icmVhdGhpbmctb3JiLmJyZWF0aGluZyB7CiAgICAgICAgICAgIGFuaW1hdGlvbjogYnJlYXRoZSB2YXIoLS1icmVhdGgtZHVyYXRpb24sIDhzKSBlYXNlLWluLW91dCBpbmZpbml0ZTsKICAgICAgICB9CgogICAgICAgIC5icmVhdGhpbmctb3JiLmhlYXJ0YmVhdCB7CiAgICAgICAgICAgIGFuaW1hdGlvbjogaGVhcnRiZWF0VmlzdWFsIDFzIGVhc2UtaW4tb3V0IGluZmluaXRlOwogICAgICAgIH0KCiAgICAgICAgQGtleWZyYW1lcyBicmVhdGhlIHsKICAgICAgICAgICAgMCUsIDEwMCUgeyAKICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMSk7CiAgICAgICAgICAgICAgICBib3gtc2hhZG93OiAKICAgICAgICAgICAgICAgICAgICAwIDAgNjBweCB2YXIoLS1nbG93LWNvbG9yLCByZ2JhKDEwMCwgMTUwLCAyMDAsIDAuMikpLAogICAgICAgICAgICAgICAgICAgIGluc2V0IDAgMCA0MHB4IHZhcigtLWdsb3ctY29sb3ItaW5uZXIsIHJnYmEoMTAwLCAxNTAsIDIwMCwgMC4xKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgNTAlIHsgCiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMzUpOwogICAgICAgICAgICAgICAgYm94LXNoYWRvdzogCiAgICAgICAgICAgICAgICAgICAgMCAwIDEwMHB4IHZhcigtLWdsb3ctY29sb3IsIHJnYmEoMTAwLCAxNTAsIDIwMCwgMC40KSksCiAgICAgICAgICAgICAgICAgICAgaW5zZXQgMCAwIDYwcHggdmFyKC0tZ2xvdy1jb2xvci1pbm5lciwgcmdiYSgxMDAsIDE1MCwgMjAwLCAwLjIpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgQGtleWZyYW1lcyBoZWFydGJlYXRWaXN1YWwgewogICAgICAgICAgICAwJSwgMTAwJSB7IHRyYW5zZm9ybTogc2NhbGUoMSk7IH0KICAgICAgICAgICAgMTUlIHsgdHJhbnNmb3JtOiBzY2FsZSgxLjE1KTsgfQogICAgICAgICAgICAzMCUgeyB0cmFuc2Zvcm06IHNjYWxlKDEpOyB9CiAgICAgICAgICAgIDQ1JSB7IHRyYW5zZm9ybTogc2NhbGUoMS4xKTsgfQogICAgICAgICAgICA2MCUgeyB0cmFuc2Zvcm06IHNjYWxlKDEpOyB9CiAgICAgICAgfQoKICAgICAgICAvKiBHbG93IHJpbmcgYXJvdW5kIG9yYiAqLwogICAgICAgIC5nbG93LXJpbmcgewogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgIHRvcDogLTQwcHg7CiAgICAgICAgICAgIGxlZnQ6IC00MHB4OwogICAgICAgICAgICByaWdodDogLTQwcHg7CiAgICAgICAgICAgIGJvdHRvbTogLTQwcHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSwgdmFyKC0tZ2xvdy1jb2xvciwgcmdiYSgxMDAsIDE1MCwgMjAwLCAwLjEpKSAwJSwgdHJhbnNwYXJlbnQgNzAlKTsKICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICAgICAgfQoKICAgICAgICAvKiBGbG9hdGluZyBwYXJ0aWNsZXMgKi8KICAgICAgICAucGFydGljbGVzIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICB0b3A6IDA7CiAgICAgICAgICAgIGxlZnQ6IDA7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lOwogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgIH0KCiAgICAgICAgLnBhcnRpY2xlIHsKICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgICAgIG9wYWNpdHk6IDAuNDsKICAgICAgICAgICAgYW5pbWF0aW9uOiBmbG9hdFVwIGxpbmVhciBpbmZpbml0ZTsKICAgICAgICB9CgogICAgICAgIEBrZXlmcmFtZXMgZmxvYXRVcCB7CiAgICAgICAgICAgIDAlIHsKICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgxMDB2aCkgc2NhbGUoMSk7CiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIDEwJSB7IG9wYWNpdHk6IDAuNDsgfQogICAgICAgICAgICA5MCUgeyBvcGFjaXR5OiAwLjQ7IH0KICAgICAgICAgICAgMTAwJSB7CiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwcHgpIHNjYWxlKDAuNSk7CiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKiBTb3VuZCBtb2RlIGJ1dHRvbnMgKi8KICAgICAgICAuc291bmQtbW9kZXMgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIGJvdHRvbTogMTAwcHg7CiAgICAgICAgICAgIGxlZnQ6IDUwJTsKICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpOwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICBnYXA6IDE1cHg7CiAgICAgICAgICAgIG1heC13aWR0aDogNTAwcHg7CiAgICAgICAgICAgIHBhZGRpbmc6IDAgMjBweDsKICAgICAgICB9CgogICAgICAgIC5zb3VuZC1tb2RlIHsKICAgICAgICAgICAgd2lkdGg6IDgwcHg7CiAgICAgICAgICAgIGhlaWdodDogODBweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDUpOwogICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjRzOwogICAgICAgIH0KCiAgICAgICAgLnNvdW5kLW1vZGU6aG92ZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMS4wNSk7CiAgICAgICAgfQoKICAgICAgICAuc291bmQtbW9kZS5hY3RpdmUgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDEwMCwgMTUwLCAyMDAsIDAuMik7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogcmdiYSgxMDAsIDE1MCwgMjAwLCAwLjUpOwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgMzBweCByZ2JhKDEwMCwgMTUwLCAyMDAsIDAuMyk7CiAgICAgICAgfQoKICAgICAgICAuc291bmQtbW9kZSAuaWNvbiB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjhweDsKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogNHB4OwogICAgICAgIH0KCiAgICAgICAgLnNvdW5kLW1vZGUgLmxhYmVsIHsKICAgICAgICAgICAgZm9udC1zaXplOiAxMHB4OwogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjUpOwogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgfQoKICAgICAgICAvKiBWb2x1bWUgY29udHJvbCAqLwogICAgICAgIC52b2x1bWUtY29udHJvbCB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICAgICAgYm90dG9tOiA0MHB4OwogICAgICAgICAgICBsZWZ0OiA1MCU7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgZ2FwOiAxNXB4OwogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjQpOwogICAgICAgIH0KCiAgICAgICAgLnZvbHVtZS1zbGlkZXIgewogICAgICAgICAgICB3aWR0aDogMTUwcHg7CiAgICAgICAgICAgIGhlaWdodDogNnB4OwogICAgICAgICAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xNSk7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDNweDsKICAgICAgICAgICAgb3V0bGluZTogbm9uZTsKICAgICAgICB9CgogICAgICAgIC52b2x1bWUtc2xpZGVyOjotd2Via2l0LXNsaWRlci10aHVtYiB7CiAgICAgICAgICAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTsKICAgICAgICAgICAgd2lkdGg6IDE4cHg7CiAgICAgICAgICAgIGhlaWdodDogMThweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDEwMCwgMTUwLCAyMDAsIDAuNyk7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICB9CgogICAgICAgIC8qIEluZm8gZGlzcGxheSAqLwogICAgICAgIC5pbmZvLWRpc3BsYXkgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIHRvcDogMzBweDsKICAgICAgICAgICAgbGVmdDogNTAlOwogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgICAgICAgICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC42KTsKICAgICAgICB9CgogICAgICAgIC5pbmZvLWRpc3BsYXkgLnRpdGxlIHsKICAgICAgICAgICAgZm9udC1zaXplOiAyMHB4OwogICAgICAgICAgICBmb250LXdlaWdodDogMzAwOwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA1cHg7CiAgICAgICAgfQoKICAgICAgICAuaW5mby1kaXNwbGF5IC5zdWJ0aXRsZSB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICAgICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC40KTsKICAgICAgICB9CgogICAgICAgIC8qIFRpbWVyICovCiAgICAgICAgLnRpbWVyIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICB0b3A6IDMwcHg7CiAgICAgICAgICAgIHJpZ2h0OiAzMHB4OwogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjQpOwogICAgICAgICAgICBmb250LXNpemU6IDI0cHg7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiAzMDA7CiAgICAgICAgfQoKICAgICAgICAvKiBTY2llbnRpZmljIGluZm8gcGFuZWwgKi8KICAgICAgICAuaW5mby1wYW5lbCB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICAgICAgdG9wOiAzMHB4OwogICAgICAgICAgICBsZWZ0OiAzMHB4OwogICAgICAgICAgICBtYXgtd2lkdGg6IDI1MHB4OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNSk7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7CiAgICAgICAgICAgIHBhZGRpbmc6IDE1cHg7CiAgICAgICAgICAgIGNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNSk7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuNjsKICAgICAgICAgICAgb3BhY2l0eTogMDsKICAgICAgICAgICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjNzOwogICAgICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgICAgICB9CgogICAgICAgIC5pbmZvLXBhbmVsLnZpc2libGUgewogICAgICAgICAgICBvcGFjaXR5OiAxOwogICAgICAgIH0KCiAgICAgICAgLmluZm8tcGFuZWwgaDQgewogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjcpOwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA4cHg7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7CiAgICAgICAgfQoKICAgICAgICAvKiBIZWxwIGJ1dHRvbiAqLwogICAgICAgIC5oZWxwLWJ0biB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICAgICAgYm90dG9tOiA0MHB4OwogICAgICAgICAgICByaWdodDogMzBweDsKICAgICAgICAgICAgd2lkdGg6IDQwcHg7CiAgICAgICAgICAgIGhlaWdodDogNDBweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKICAgICAgICAgICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC41KTsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgICAgICBmb250LXNpemU6IDE4cHg7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgIH0KCiAgICAgICAgLmhlbHAtYnRuOmhvdmVyIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOwogICAgICAgIH0KICAgIDwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+CiAgICA8ZGl2IGNsYXNzPSJwYXJ0aWNsZXMiIGlkPSJwYXJ0aWNsZXMiPjwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImNvbnRhaW5lciI+CiAgICAgICAgPGRpdiBjbGFzcz0iYnJlYXRoaW5nLW9yYiBicmVhdGhpbmciIGlkPSJvcmIiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJnbG93LXJpbmciPjwvZGl2PgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0iaW5mby1kaXNwbGF5Ij4KICAgICAgICA8ZGl2IGNsYXNzPSJ0aXRsZSIgaWQ9ImN1cnJlbnRNb2RlIj5XeWJpZXJ6IGTFundpxJlrPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ic3VidGl0bGUiIGlkPSJtb2RlSW5mbyI+PC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGNsYXNzPSJ0aW1lciIgaWQ9InRpbWVyIj4wOjAwPC9kaXY+CgogICAgPGRpdiBjbGFzcz0iaW5mby1wYW5lbCIgaWQ9ImluZm9QYW5lbCI+CiAgICAgICAgPGg0IGlkPSJpbmZvUGFuZWxUaXRsZSI+SW5mb3JtYWNqYTwvaDQ+CiAgICAgICAgPHAgaWQ9ImluZm9QYW5lbFRleHQiPjwvcD4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9InNvdW5kLW1vZGVzIj4KICAgICAgICA8ZGl2IGNsYXNzPSJzb3VuZC1tb2RlIiBkYXRhLW1vZGU9ImhlYXJ0YmVhdCIgZGF0YS1pbmZvPSJCaWNpZSBzZXJjYSA2MCBCUE0gcmVndWx1amUgdWvFgmFkIG5lcndvd3kuIEJhcmR6byBza3V0ZWN6bmUgZGxhIG1hxYJ5Y2ggZHppZWNpIC0gcHJ6eXBvbWluYSBkxbp3acSZa2kgeiDFgm9uYSBtYXRraS4iPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbiI+8J+Skzwvc3Bhbj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9ImxhYmVsIj5TZXJjZTwvc3Bhbj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJzb3VuZC1tb2RlIiBkYXRhLW1vZGU9IjUyOGh6IiBkYXRhLWluZm89IjUyOCBIeiAtIGJhZGFuaWEgd3lrYXp1asSFIG9ibmnFvGVuaWUga29ydHl6b2x1IChob3Jtb251IHN0cmVzdSkgaSB3enJvc3Qgb2tzeXRvY3lueSBwbyBzxYJ1Y2hhbml1IHRlaiBjesSZc3RvdGxpd2/Fm2NpLiI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJpY29uIj7wn461PC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ibGFiZWwiPjUyOCBIejwvc3Bhbj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJzb3VuZC1tb2RlIiBkYXRhLW1vZGU9IjQzMmh6IiBkYXRhLWluZm89IjQzMiBIeiAtIHV3YcW8YW5hIHphIGJhcmR6aWVqIG5hdHVyYWxuxIUgaSBoYXJtb25pam7EhSBjesSZc3RvdGxpd2/Fm8SHLiBXaWVsdSByb2R6aWPDs3cgZHppZWNpIHogYXV0eXptZW0gcmFwb3J0dWplIGVmZWt0IHVzcG9rYWphasSFY3kuIj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9Imljb24iPvCfjrY8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJsYWJlbCI+NDMyIEh6PC9zcGFuPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9InNvdW5kLW1vZGUiIGRhdGEtbW9kZT0icGluayIgZGF0YS1pbmZvPSJSw7PFvG93eSBzenVtIC0gY2llcGxlanN6eSBuacW8IGJpYcWCeSBzenVtLCBsZXBpZWogdG9sZXJvd2FueSBwcnpleiBkemllY2kgeiB3cmHFvGxpd2/Fm2NpxIUgc2Vuc29yeWN6bsSFLiBNYXNrdWplIHJvenByYXN6YWrEhWNlIGTFundpxJlraSBvdG9jemVuaWEuIj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9Imljb24iPvCfjLg8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJsYWJlbCI+UsOzxbxvd3kgc3p1bTwvc3Bhbj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJzb3VuZC1tb2RlIiBkYXRhLW1vZGU9Imx1bGxhYnkiIGRhdGEtaW5mbz0iRmlsdHJvd2FuYSBtdXp5a2EgdyB6YWtyZXNpZSBnxYJvc3Uga29iaWVjZWdvIChrb8WCeXNhbmthKS4gQmFkYW5pYSBQb3JnZXNhIHd5a2F6YcWCeSBwb3ByYXfEmSBrb211bmlrYWNqaSBwbyA1IGRuaWFjaCBzxYJ1Y2hhbmlhIDQ1IG1pbi9kemllxYQuIj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9Imljb24iPvCfjJk8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJsYWJlbCI+S2/FgnlzYW5rYTwvc3Bhbj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJzb3VuZC1tb2RlIiBkYXRhLW1vZGU9Im9jZWFuIiBkYXRhLWluZm89IkTFundpxJlraSBvY2VhbnUgLSByeXRtaWN6bmUgZmFsZSBtYWrEhSBuYXR1cmFsbnkgZWZla3QgdXNwb2thamFqxIVjeS4gTmlza2llIGN6xJlzdG90bGl3b8WbY2kgd3NwaWVyYWrEhSBpbnRlZ3JhY2rEmSBzZW5zb3J5Y3puxIUuIj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9Imljb24iPvCfjIo8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJsYWJlbCI+T2NlYW48L3NwYW4+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGNsYXNzPSJ2b2x1bWUtY29udHJvbCI+CiAgICAgICAgPHNwYW4+8J+UiDwvc3Bhbj4KICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGNsYXNzPSJ2b2x1bWUtc2xpZGVyIiBpZD0idm9sdW1lIiBtaW49IjAiIG1heD0iMTAwIiB2YWx1ZT0iNDAiPgogICAgICAgIDxzcGFuPvCflIo8L3NwYW4+CiAgICA8L2Rpdj4KCiAgICA8YnV0dG9uIGNsYXNzPSJoZWxwLWJ0biIgaWQ9ImhlbHBCdG4iPj88L2J1dHRvbj4KCiAgICA8c2NyaXB0PgogICAgICAgIGNvbnN0IEF1ZGlvQ29udGV4dCA9IHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dDsKICAgICAgICBsZXQgYXVkaW9DdHggPSBudWxsOwogICAgICAgIGxldCBjdXJyZW50Tm9kZXMgPSBbXTsKICAgICAgICBsZXQgY3VycmVudE1vZGUgPSBudWxsOwogICAgICAgIGxldCB2b2x1bWUgPSAwLjQ7CiAgICAgICAgbGV0IHNlc3Npb25TdGFydCA9IG51bGw7CiAgICAgICAgbGV0IHRpbWVySW50ZXJ2YWwgPSBudWxsOwoKICAgICAgICBjb25zdCBvcmIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3JiJyk7CiAgICAgICAgY29uc3QgY3VycmVudE1vZGVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXJyZW50TW9kZScpOwogICAgICAgIGNvbnN0IG1vZGVJbmZvRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kZUluZm8nKTsKICAgICAgICBjb25zdCB0aW1lckVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpbWVyJyk7CiAgICAgICAgY29uc3QgaW5mb1BhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm9QYW5lbCcpOwogICAgICAgIGNvbnN0IGluZm9QYW5lbFRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm9QYW5lbFRpdGxlJyk7CiAgICAgICAgY29uc3QgaW5mb1BhbmVsVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbmZvUGFuZWxUZXh0Jyk7CiAgICAgICAgY29uc3Qgdm9sdW1lU2xpZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZvbHVtZScpOwogICAgICAgIGNvbnN0IGhlbHBCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVscEJ0bicpOwoKICAgICAgICAvLyBDb2xvciB0aGVtZXMgZm9yIGRpZmZlcmVudCBtb2RlcwogICAgICAgIGNvbnN0IG1vZGVDb2xvcnMgPSB7CiAgICAgICAgICAgIGhlYXJ0YmVhdDogeyBnbG93OiAncmdiYSgyNTUsIDEwMCwgMTIwLCAwLjMpJywgaW5uZXI6ICdyZ2JhKDI1NSwgMTAwLCAxMjAsIDAuMTUpJyB9LAogICAgICAgICAgICAnNTI4aHonOiB7IGdsb3c6ICdyZ2JhKDEwMCwgMjAwLCAxNTAsIDAuMyknLCBpbm5lcjogJ3JnYmEoMTAwLCAyMDAsIDE1MCwgMC4xNSknIH0sCiAgICAgICAgICAgICc0MzJoeic6IHsgZ2xvdzogJ3JnYmEoMjAwLCAxNTAsIDEwMCwgMC4zKScsIGlubmVyOiAncmdiYSgyMDAsIDE1MCwgMTAwLCAwLjE1KScgfSwKICAgICAgICAgICAgcGluazogeyBnbG93OiAncmdiYSgyNTUsIDE1MCwgMjAwLCAwLjMpJywgaW5uZXI6ICdyZ2JhKDI1NSwgMTUwLCAyMDAsIDAuMTUpJyB9LAogICAgICAgICAgICBsdWxsYWJ5OiB7IGdsb3c6ICdyZ2JhKDE1MCwgMTUwLCAyNTUsIDAuMyknLCBpbm5lcjogJ3JnYmEoMTUwLCAxNTAsIDI1NSwgMC4xNSknIH0sCiAgICAgICAgICAgIG9jZWFuOiB7IGdsb3c6ICdyZ2JhKDEwMCwgMTgwLCAyMjAsIDAuMyknLCBpbm5lcjogJ3JnYmEoMTAwLCAxODAsIDIyMCwgMC4xNSknIH0KICAgICAgICB9OwoKICAgICAgICBjb25zdCBtb2RlTmFtZXMgPSB7CiAgICAgICAgICAgIGhlYXJ0YmVhdDogJ0JpY2llIFNlcmNhJywKICAgICAgICAgICAgJzUyOGh6JzogJzUyOCBIeiAtIEN6xJlzdG90bGl3b8WbxIcgVXpkcmF3aWFqxIVjYScsCiAgICAgICAgICAgICc0MzJoeic6ICc0MzIgSHogLSBOYXR1cmFsbmEgSGFybW9uaWEnLAogICAgICAgICAgICBwaW5rOiAnUsOzxbxvd3kgU3p1bScsCiAgICAgICAgICAgIGx1bGxhYnk6ICdLb8WCeXNhbmthJywKICAgICAgICAgICAgb2NlYW46ICdGYWxlIE9jZWFudScKICAgICAgICB9OwoKICAgICAgICBmdW5jdGlvbiBpbml0QXVkaW8oKSB7CiAgICAgICAgICAgIGlmICghYXVkaW9DdHgpIHsKICAgICAgICAgICAgICAgIGF1ZGlvQ3R4ID0gbmV3IEF1ZGlvQ29udGV4dCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChhdWRpb0N0eC5zdGF0ZSA9PT0gJ3N1c3BlbmRlZCcpIHsKICAgICAgICAgICAgICAgIGF1ZGlvQ3R4LnJlc3VtZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBzdG9wQWxsU291bmRzKCkgewogICAgICAgICAgICBjdXJyZW50Tm9kZXMuZm9yRWFjaChub2RlID0+IHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuc3RvcCkgbm9kZS5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuZGlzY29ubmVjdCkgbm9kZS5kaXNjb25uZWN0KCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY3VycmVudE5vZGVzID0gW107CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAodGltZXJJbnRlcnZhbCkgewogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lckludGVydmFsKTsKICAgICAgICAgICAgICAgIHRpbWVySW50ZXJ2YWwgPSBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBzdGFydFRpbWVyKCkgewogICAgICAgICAgICBzZXNzaW9uU3RhcnQgPSBEYXRlLm5vdygpOwogICAgICAgICAgICB0aW1lckludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgZWxhcHNlZCA9IE1hdGguZmxvb3IoKERhdGUubm93KCkgLSBzZXNzaW9uU3RhcnQpIC8gMTAwMCk7CiAgICAgICAgICAgICAgICBjb25zdCBtaW5zID0gTWF0aC5mbG9vcihlbGFwc2VkIC8gNjApOwogICAgICAgICAgICAgICAgY29uc3Qgc2VjcyA9IGVsYXBzZWQgJSA2MDsKICAgICAgICAgICAgICAgIHRpbWVyRWwudGV4dENvbnRlbnQgPSBgJHttaW5zfToke3NlY3MudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWA7CiAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gc2V0T3JiU3R5bGUobW9kZSkgewogICAgICAgICAgICBjb25zdCBjb2xvcnMgPSBtb2RlQ29sb3JzW21vZGVdOwogICAgICAgICAgICBvcmIuc3R5bGUuc2V0UHJvcGVydHkoJy0tZ2xvdy1jb2xvcicsIGNvbG9ycy5nbG93KTsKICAgICAgICAgICAgb3JiLnN0eWxlLnNldFByb3BlcnR5KCctLWdsb3ctY29sb3ItaW5uZXInLCBjb2xvcnMuaW5uZXIpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gU3BlY2lhbCBhbmltYXRpb24gZm9yIGhlYXJ0YmVhdAogICAgICAgICAgICBvcmIuY2xhc3NMaXN0LnJlbW92ZSgnYnJlYXRoaW5nJywgJ2hlYXJ0YmVhdCcpOwogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2hlYXJ0YmVhdCcpIHsKICAgICAgICAgICAgICAgIG9yYi5jbGFzc0xpc3QuYWRkKCdoZWFydGJlYXQnKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG9yYi5jbGFzc0xpc3QuYWRkKCdicmVhdGhpbmcnKTsKICAgICAgICAgICAgICAgIC8vIFNsb3dlciBicmVhdGhpbmcgZm9yIG1vcmUgY2FsbWluZyBtb2RlcwogICAgICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBtb2RlID09PSAnbHVsbGFieScgPyAnMTBzJyA6ICc4cyc7CiAgICAgICAgICAgICAgICBvcmIuc3R5bGUuc2V0UHJvcGVydHkoJy0tYnJlYXRoLWR1cmF0aW9uJywgZHVyYXRpb24pOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBTb3VuZCBnZW5lcmF0b3JzCiAgICAgICAgY29uc3Qgc291bmRHZW5lcmF0b3JzID0gewogICAgICAgICAgICBoZWFydGJlYXQ6ICgpID0+IHsKICAgICAgICAgICAgICAgIGxldCBpc1BsYXlpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBwbGF5QmVhdCgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIWlzUGxheWluZyB8fCBjdXJyZW50TW9kZSAhPT0gJ2hlYXJ0YmVhdCcpIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBMdWIKICAgICAgICAgICAgICAgICAgICBjb25zdCBvc2MxID0gYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGdhaW4xID0gYXVkaW9DdHguY3JlYXRlR2FpbigpOwogICAgICAgICAgICAgICAgICAgIG9zYzEudHlwZSA9ICdzaW5lJzsKICAgICAgICAgICAgICAgICAgICBvc2MxLmZyZXF1ZW5jeS5zZXRWYWx1ZUF0VGltZSg2MCwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgICAgIGdhaW4xLmdhaW4uc2V0VmFsdWVBdFRpbWUoMCwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgICAgIGdhaW4xLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodm9sdW1lICogMC40LCBhdWRpb0N0eC5jdXJyZW50VGltZSArIDAuMDIpOwogICAgICAgICAgICAgICAgICAgIGdhaW4xLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAwMSwgYXVkaW9DdHguY3VycmVudFRpbWUgKyAwLjI1KTsKICAgICAgICAgICAgICAgICAgICBvc2MxLmNvbm5lY3QoZ2FpbjEpOwogICAgICAgICAgICAgICAgICAgIGdhaW4xLmNvbm5lY3QoYXVkaW9DdHguZGVzdGluYXRpb24pOwogICAgICAgICAgICAgICAgICAgIG9zYzEuc3RhcnQoKTsKICAgICAgICAgICAgICAgICAgICBvc2MxLnN0b3AoYXVkaW9DdHguY3VycmVudFRpbWUgKyAwLjI1KTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBEdWIgKGFmdGVyIDE1MG1zKQogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzUGxheWluZyB8fCBjdXJyZW50TW9kZSAhPT0gJ2hlYXJ0YmVhdCcpIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3NjMiA9IGF1ZGlvQ3R4LmNyZWF0ZU9zY2lsbGF0b3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2FpbjIgPSBhdWRpb0N0eC5jcmVhdGVHYWluKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG9zYzIudHlwZSA9ICdzaW5lJzsKICAgICAgICAgICAgICAgICAgICAgICAgb3NjMi5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUoNTAsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2FpbjIuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLCBhdWRpb0N0eC5jdXJyZW50VGltZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGdhaW4yLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodm9sdW1lICogMC4zLCBhdWRpb0N0eC5jdXJyZW50VGltZSArIDAuMDIpOwogICAgICAgICAgICAgICAgICAgICAgICBnYWluMi5nYWluLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUoMC4wMDEsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lICsgMC4yKTsKICAgICAgICAgICAgICAgICAgICAgICAgb3NjMi5jb25uZWN0KGdhaW4yKTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2FpbjIuY29ubmVjdChhdWRpb0N0eC5kZXN0aW5hdGlvbik7CiAgICAgICAgICAgICAgICAgICAgICAgIG9zYzIuc3RhcnQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgb3NjMi5zdG9wKGF1ZGlvQ3R4LmN1cnJlbnRUaW1lICsgMC4yKTsKICAgICAgICAgICAgICAgICAgICB9LCAxNTApOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIE5leHQgYmVhdCBhZnRlciAxIHNlY29uZCAoNjAgQlBNKQogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQocGxheUJlYXQsIDEwMDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBwbGF5QmVhdCgpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gY2xlYW51cCBmdW5jdGlvbgogICAgICAgICAgICAgICAgY3VycmVudE5vZGVzLnB1c2goeyBzdG9wOiAoKSA9PiB7IGlzUGxheWluZyA9IGZhbHNlOyB9IH0pOwogICAgICAgICAgICB9LAoKICAgICAgICAgICAgJzUyOGh6JzogKCkgPT4gewogICAgICAgICAgICAgICAgY29uc3Qgb3NjID0gYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpOwogICAgICAgICAgICAgICAgY29uc3QgZ2FpbiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgb3NjLnR5cGUgPSAnc2luZSc7CiAgICAgICAgICAgICAgICBvc2MuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKDUyOCwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgZ2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKHZvbHVtZSAqIDAuMTUsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gQWRkIHN1YnRsZSBoYXJtb25pY3MgZm9yIHdhcm10aAogICAgICAgICAgICAgICAgY29uc3Qgb3NjMiA9IGF1ZGlvQ3R4LmNyZWF0ZU9zY2lsbGF0b3IoKTsKICAgICAgICAgICAgICAgIGNvbnN0IGdhaW4yID0gYXVkaW9DdHguY3JlYXRlR2FpbigpOwogICAgICAgICAgICAgICAgb3NjMi50eXBlID0gJ3NpbmUnOwogICAgICAgICAgICAgICAgb3NjMi5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUoNTI4ICogMiwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgZ2FpbjIuZ2Fpbi5zZXRWYWx1ZUF0VGltZSh2b2x1bWUgKiAwLjAzLCBhdWRpb0N0eC5jdXJyZW50VGltZSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIFNsb3cgYW1wbGl0dWRlIG1vZHVsYXRpb24KICAgICAgICAgICAgICAgIGNvbnN0IGxmbyA9IGF1ZGlvQ3R4LmNyZWF0ZU9zY2lsbGF0b3IoKTsKICAgICAgICAgICAgICAgIGNvbnN0IGxmb0dhaW4gPSBhdWRpb0N0eC5jcmVhdGVHYWluKCk7CiAgICAgICAgICAgICAgICBsZm8uZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKDAuMSwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgbGZvR2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKHZvbHVtZSAqIDAuMDIsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lKTsKICAgICAgICAgICAgICAgIGxmby5jb25uZWN0KGxmb0dhaW4pOwogICAgICAgICAgICAgICAgbGZvR2Fpbi5jb25uZWN0KGdhaW4uZ2Fpbik7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIG9zYy5jb25uZWN0KGdhaW4pOwogICAgICAgICAgICAgICAgb3NjMi5jb25uZWN0KGdhaW4yKTsKICAgICAgICAgICAgICAgIGdhaW4yLmNvbm5lY3QoZ2Fpbik7CiAgICAgICAgICAgICAgICBnYWluLmNvbm5lY3QoYXVkaW9DdHguZGVzdGluYXRpb24pOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBvc2Muc3RhcnQoKTsKICAgICAgICAgICAgICAgIG9zYzIuc3RhcnQoKTsKICAgICAgICAgICAgICAgIGxmby5zdGFydCgpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZXMucHVzaChvc2MsIG9zYzIsIGxmbywgZ2Fpbik7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICAnNDMyaHonOiAoKSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBvc2MgPSBhdWRpb0N0eC5jcmVhdGVPc2NpbGxhdG9yKCk7CiAgICAgICAgICAgICAgICBjb25zdCBnYWluID0gYXVkaW9DdHguY3JlYXRlR2FpbigpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBvc2MudHlwZSA9ICdzaW5lJzsKICAgICAgICAgICAgICAgIG9zYy5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUoNDMyLCBhdWRpb0N0eC5jdXJyZW50VGltZSk7CiAgICAgICAgICAgICAgICBnYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUodm9sdW1lICogMC4xNSwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBBZGQgc3ViIGhhcm1vbmljIGZvciBkZXB0aAogICAgICAgICAgICAgICAgY29uc3Qgb3NjU3ViID0gYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpOwogICAgICAgICAgICAgICAgY29uc3QgZ2FpblN1YiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgICAgICAgICAgICAgIG9zY1N1Yi50eXBlID0gJ3NpbmUnOwogICAgICAgICAgICAgICAgb3NjU3ViLmZyZXF1ZW5jeS5zZXRWYWx1ZUF0VGltZSgyMTYsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lKTsgLy8gT2N0YXZlIGJlbG93CiAgICAgICAgICAgICAgICBnYWluU3ViLmdhaW4uc2V0VmFsdWVBdFRpbWUodm9sdW1lICogMC4wNSwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBHZW50bGUgbW9kdWxhdGlvbgogICAgICAgICAgICAgICAgY29uc3QgbGZvID0gYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpOwogICAgICAgICAgICAgICAgY29uc3QgbGZvR2FpbiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgICAgICAgICAgICAgIGxmby5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUoMC4wOCwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgbGZvR2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKHZvbHVtZSAqIDAuMDE1LCBhdWRpb0N0eC5jdXJyZW50VGltZSk7CiAgICAgICAgICAgICAgICBsZm8uY29ubmVjdChsZm9HYWluKTsKICAgICAgICAgICAgICAgIGxmb0dhaW4uY29ubmVjdChnYWluLmdhaW4pOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBvc2MuY29ubmVjdChnYWluKTsKICAgICAgICAgICAgICAgIG9zY1N1Yi5jb25uZWN0KGdhaW5TdWIpOwogICAgICAgICAgICAgICAgZ2FpblN1Yi5jb25uZWN0KGdhaW4pOwogICAgICAgICAgICAgICAgZ2Fpbi5jb25uZWN0KGF1ZGlvQ3R4LmRlc3RpbmF0aW9uKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgb3NjLnN0YXJ0KCk7CiAgICAgICAgICAgICAgICBvc2NTdWIuc3RhcnQoKTsKICAgICAgICAgICAgICAgIGxmby5zdGFydCgpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZXMucHVzaChvc2MsIG9zY1N1YiwgbGZvLCBnYWluKTsKICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIHBpbms6ICgpID0+IHsKICAgICAgICAgICAgICAgIC8vIFBpbmsgbm9pc2UgZ2VuZXJhdG9yCiAgICAgICAgICAgICAgICBjb25zdCBidWZmZXJTaXplID0gMiAqIGF1ZGlvQ3R4LnNhbXBsZVJhdGU7CiAgICAgICAgICAgICAgICBjb25zdCBub2lzZUJ1ZmZlciA9IGF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlcigxLCBidWZmZXJTaXplLCBhdWRpb0N0eC5zYW1wbGVSYXRlKTsKICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dCA9IG5vaXNlQnVmZmVyLmdldENoYW5uZWxEYXRhKDApOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBsZXQgYjAgPSAwLCBiMSA9IDAsIGIyID0gMCwgYjMgPSAwLCBiNCA9IDAsIGI1ID0gMCwgYjYgPSAwOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1ZmZlclNpemU7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHdoaXRlID0gTWF0aC5yYW5kb20oKSAqIDIgLSAxOwogICAgICAgICAgICAgICAgICAgIGIwID0gMC45OTg4NiAqIGIwICsgd2hpdGUgKiAwLjA1NTUxNzk7CiAgICAgICAgICAgICAgICAgICAgYjEgPSAwLjk5MzMyICogYjEgKyB3aGl0ZSAqIDAuMDc1MDc1OTsKICAgICAgICAgICAgICAgICAgICBiMiA9IDAuOTY5MDAgKiBiMiArIHdoaXRlICogMC4xNTM4NTIwOwogICAgICAgICAgICAgICAgICAgIGIzID0gMC44NjY1MCAqIGIzICsgd2hpdGUgKiAwLjMxMDQ4NTY7CiAgICAgICAgICAgICAgICAgICAgYjQgPSAwLjU1MDAwICogYjQgKyB3aGl0ZSAqIDAuNTMyOTUyMjsKICAgICAgICAgICAgICAgICAgICBiNSA9IC0wLjc2MTYgKiBiNSAtIHdoaXRlICogMC4wMTY4OTgwOwogICAgICAgICAgICAgICAgICAgIG91dHB1dFtpXSA9IChiMCArIGIxICsgYjIgKyBiMyArIGI0ICsgYjUgKyBiNiArIHdoaXRlICogMC41MzYyKSAqIDAuMTE7CiAgICAgICAgICAgICAgICAgICAgYjYgPSB3aGl0ZSAqIDAuMTE1OTI2OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb25zdCBub2lzZSA9IGF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpOwogICAgICAgICAgICAgICAgbm9pc2UuYnVmZmVyID0gbm9pc2VCdWZmZXI7CiAgICAgICAgICAgICAgICBub2lzZS5sb29wID0gdHJ1ZTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29uc3QgZ2FpbiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgICAgICAgICAgICAgIGdhaW4uZ2Fpbi5zZXRWYWx1ZUF0VGltZSh2b2x1bWUgKiAwLjI1LCBhdWRpb0N0eC5jdXJyZW50VGltZSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIG5vaXNlLmNvbm5lY3QoZ2Fpbik7CiAgICAgICAgICAgICAgICBnYWluLmNvbm5lY3QoYXVkaW9DdHguZGVzdGluYXRpb24pOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBub2lzZS5zdGFydCgpOwogICAgICAgICAgICAgICAgY3VycmVudE5vZGVzLnB1c2gobm9pc2UsIGdhaW4pOwogICAgICAgICAgICB9LAoKICAgICAgICAgICAgbHVsbGFieTogKCkgPT4gewogICAgICAgICAgICAgICAgLy8gRmlsdGVyZWQgbWVsb2R5IGluIGZlbWFsZSB2b2ljZSByYW5nZSAoMzAwLTMwMDAgSHopCiAgICAgICAgICAgICAgICAvLyBTaW1wbGUgcGVudGF0b25pYyBsdWxsYWJ5IHBhdHRlcm4KICAgICAgICAgICAgICAgIGNvbnN0IG5vdGVzID0gWwogICAgICAgICAgICAgICAgICAgIHsgZnJlcTogMzkyLCBkdXI6IDAuOCB9LCAgLy8gRzQKICAgICAgICAgICAgICAgICAgICB7IGZyZXE6IDQ0MCwgZHVyOiAwLjQgfSwgIC8vIEE0CiAgICAgICAgICAgICAgICAgICAgeyBmcmVxOiAzOTIsIGR1cjogMC44IH0sICAvLyBHNAogICAgICAgICAgICAgICAgICAgIHsgZnJlcTogMzMwLCBkdXI6IDAuOCB9LCAgLy8gRTQKICAgICAgICAgICAgICAgICAgICB7IGZyZXE6IDI5NCwgZHVyOiAxLjIgfSwgIC8vIEQ0CiAgICAgICAgICAgICAgICAgICAgeyBmcmVxOiAzMzAsIGR1cjogMC44IH0sICAvLyBFNAogICAgICAgICAgICAgICAgICAgIHsgZnJlcTogMzkyLCBkdXI6IDEuNiB9LCAgLy8gRzQKICAgICAgICAgICAgICAgIF07CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxldCBub3RlSW5kZXggPSAwOwogICAgICAgICAgICAgICAgbGV0IGlzUGxheWluZyA9IHRydWU7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHBsYXlOb3RlKCkgewogICAgICAgICAgICAgICAgICAgIGlmICghaXNQbGF5aW5nIHx8IGN1cnJlbnRNb2RlICE9PSAnbHVsbGFieScpIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBjb25zdCBub3RlID0gbm90ZXNbbm90ZUluZGV4XTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBvc2MgPSBhdWRpb0N0eC5jcmVhdGVPc2NpbGxhdG9yKCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2FpbiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBTb2Z0LCB3YXJtIHRvbmUKICAgICAgICAgICAgICAgICAgICBvc2MudHlwZSA9ICdzaW5lJzsKICAgICAgICAgICAgICAgICAgICBvc2MuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKG5vdGUuZnJlcSwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIFNvZnQgYXR0YWNrIGFuZCByZWxlYXNlCiAgICAgICAgICAgICAgICAgICAgZ2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKDAsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lKTsKICAgICAgICAgICAgICAgICAgICBnYWluLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodm9sdW1lICogMC4xMiwgYXVkaW9DdHguY3VycmVudFRpbWUgKyAwLjEpOwogICAgICAgICAgICAgICAgICAgIGdhaW4uZ2Fpbi5zZXRWYWx1ZUF0VGltZSh2b2x1bWUgKiAwLjEyLCBhdWRpb0N0eC5jdXJyZW50VGltZSArIG5vdGUuZHVyIC0gMC4xNSk7CiAgICAgICAgICAgICAgICAgICAgZ2Fpbi5nYWluLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKDAsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lICsgbm90ZS5kdXIpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIEFkZCB3YXJtdGggd2l0aCBoYXJtb25pYwogICAgICAgICAgICAgICAgICAgIGNvbnN0IG9zYzIgPSBhdWRpb0N0eC5jcmVhdGVPc2NpbGxhdG9yKCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2FpbjIgPSBhdWRpb0N0eC5jcmVhdGVHYWluKCk7CiAgICAgICAgICAgICAgICAgICAgb3NjMi50eXBlID0gJ3NpbmUnOwogICAgICAgICAgICAgICAgICAgIG9zYzIuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKG5vdGUuZnJlcSAqIDIsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lKTsKICAgICAgICAgICAgICAgICAgICBnYWluMi5nYWluLnNldFZhbHVlQXRUaW1lKHZvbHVtZSAqIDAuMDIsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBvc2MuY29ubmVjdChnYWluKTsKICAgICAgICAgICAgICAgICAgICBvc2MyLmNvbm5lY3QoZ2FpbjIpOwogICAgICAgICAgICAgICAgICAgIGdhaW4yLmNvbm5lY3QoZ2Fpbik7CiAgICAgICAgICAgICAgICAgICAgZ2Fpbi5jb25uZWN0KGF1ZGlvQ3R4LmRlc3RpbmF0aW9uKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBvc2Muc3RhcnQoKTsKICAgICAgICAgICAgICAgICAgICBvc2MyLnN0YXJ0KCk7CiAgICAgICAgICAgICAgICAgICAgb3NjLnN0b3AoYXVkaW9DdHguY3VycmVudFRpbWUgKyBub3RlLmR1cik7CiAgICAgICAgICAgICAgICAgICAgb3NjMi5zdG9wKGF1ZGlvQ3R4LmN1cnJlbnRUaW1lICsgbm90ZS5kdXIpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIG5vdGVJbmRleCA9IChub3RlSW5kZXggKyAxKSAlIG5vdGVzLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBTbWFsbCBwYXVzZSBiZXR3ZWVuIG5vdGVzLCBsb25nZXIgcGF1c2UgYXQgZW5kIG9mIHBocmFzZQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhdXNlID0gbm90ZUluZGV4ID09PSAwID8gMS41IDogMC4xOwogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQocGxheU5vdGUsIChub3RlLmR1ciArIHBhdXNlKSAqIDEwMDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBwbGF5Tm90ZSgpOwogICAgICAgICAgICAgICAgY3VycmVudE5vZGVzLnB1c2goeyBzdG9wOiAoKSA9PiB7IGlzUGxheWluZyA9IGZhbHNlOyB9IH0pOwogICAgICAgICAgICB9LAoKICAgICAgICAgICAgb2NlYW46ICgpID0+IHsKICAgICAgICAgICAgICAgIC8vIE9jZWFuIHdhdmVzIHVzaW5nIGZpbHRlcmVkIG5vaXNlIHdpdGggc2xvdyBtb2R1bGF0aW9uCiAgICAgICAgICAgICAgICBjb25zdCBidWZmZXJTaXplID0gMiAqIGF1ZGlvQ3R4LnNhbXBsZVJhdGU7CiAgICAgICAgICAgICAgICBjb25zdCBub2lzZUJ1ZmZlciA9IGF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlcigxLCBidWZmZXJTaXplLCBhdWRpb0N0eC5zYW1wbGVSYXRlKTsKICAgICAgICAgICAgICAgIGNvbnN0IG91dHB1dCA9IG5vaXNlQnVmZmVyLmdldENoYW5uZWxEYXRhKDApOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1ZmZlclNpemU7IGkrKykgewogICAgICAgICAgICAgICAgICAgIG91dHB1dFtpXSA9IE1hdGgucmFuZG9tKCkgKiAyIC0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29uc3Qgbm9pc2UgPSBhdWRpb0N0eC5jcmVhdGVCdWZmZXJTb3VyY2UoKTsKICAgICAgICAgICAgICAgIG5vaXNlLmJ1ZmZlciA9IG5vaXNlQnVmZmVyOwogICAgICAgICAgICAgICAgbm9pc2UubG9vcCA9IHRydWU7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIExvdy1wYXNzIGZpbHRlciBmb3Igb2NlYW4gZGVwdGgKICAgICAgICAgICAgICAgIGNvbnN0IGZpbHRlciA9IGF1ZGlvQ3R4LmNyZWF0ZUJpcXVhZEZpbHRlcigpOwogICAgICAgICAgICAgICAgZmlsdGVyLnR5cGUgPSAnbG93cGFzcyc7CiAgICAgICAgICAgICAgICBmaWx0ZXIuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKDUwMCwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgZmlsdGVyLlEuc2V0VmFsdWVBdFRpbWUoMSwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb25zdCBnYWluID0gYXVkaW9DdHguY3JlYXRlR2FpbigpOwogICAgICAgICAgICAgICAgZ2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKHZvbHVtZSAqIDAuMiwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBXYXZlIG1vZHVsYXRpb24gLSBzbG93IHZvbHVtZSBjaGFuZ2VzCiAgICAgICAgICAgICAgICBjb25zdCBsZm8gPSBhdWRpb0N0eC5jcmVhdGVPc2NpbGxhdG9yKCk7CiAgICAgICAgICAgICAgICBjb25zdCBsZm9HYWluID0gYXVkaW9DdHguY3JlYXRlR2FpbigpOwogICAgICAgICAgICAgICAgbGZvLnR5cGUgPSAnc2luZSc7CiAgICAgICAgICAgICAgICBsZm8uZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKDAuMDgsIGF1ZGlvQ3R4LmN1cnJlbnRUaW1lKTsgLy8gVmVyeSBzbG93IHdhdmVzCiAgICAgICAgICAgICAgICBsZm9HYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUodm9sdW1lICogMC4xLCBhdWRpb0N0eC5jdXJyZW50VGltZSk7CiAgICAgICAgICAgICAgICBsZm8uY29ubmVjdChsZm9HYWluKTsKICAgICAgICAgICAgICAgIGxmb0dhaW4uY29ubmVjdChnYWluLmdhaW4pOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBGaWx0ZXIgbW9kdWxhdGlvbiBmb3Igd2F2ZSAid2FzaGluZyIgZWZmZWN0CiAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJMZm8gPSBhdWRpb0N0eC5jcmVhdGVPc2NpbGxhdG9yKCk7CiAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJMZm9HYWluID0gYXVkaW9DdHguY3JlYXRlR2FpbigpOwogICAgICAgICAgICAgICAgZmlsdGVyTGZvLnR5cGUgPSAnc2luZSc7CiAgICAgICAgICAgICAgICBmaWx0ZXJMZm8uZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKDAuMSwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgZmlsdGVyTGZvR2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKDIwMCwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgZmlsdGVyTGZvLmNvbm5lY3QoZmlsdGVyTGZvR2Fpbik7CiAgICAgICAgICAgICAgICBmaWx0ZXJMZm9HYWluLmNvbm5lY3QoZmlsdGVyLmZyZXF1ZW5jeSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIG5vaXNlLmNvbm5lY3QoZmlsdGVyKTsKICAgICAgICAgICAgICAgIGZpbHRlci5jb25uZWN0KGdhaW4pOwogICAgICAgICAgICAgICAgZ2Fpbi5jb25uZWN0KGF1ZGlvQ3R4LmRlc3RpbmF0aW9uKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbm9pc2Uuc3RhcnQoKTsKICAgICAgICAgICAgICAgIGxmby5zdGFydCgpOwogICAgICAgICAgICAgICAgZmlsdGVyTGZvLnN0YXJ0KCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGN1cnJlbnROb2Rlcy5wdXNoKG5vaXNlLCBsZm8sIGZpbHRlckxmbywgZ2Fpbik7CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICAvLyBDcmVhdGUgZmxvYXRpbmcgcGFydGljbGVzCiAgICAgICAgZnVuY3Rpb24gY3JlYXRlUGFydGljbGVzKCkgewogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFydGljbGVzJyk7CiAgICAgICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJzsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IGNvbG9ycyA9IFsKICAgICAgICAgICAgICAgICdyZ2JhKDEwMCwgMTUwLCAyMDAsIDAuMyknLAogICAgICAgICAgICAgICAgJ3JnYmEoMTUwLCAxMDAsIDIwMCwgMC4zKScsCiAgICAgICAgICAgICAgICAncmdiYSgxMDAsIDIwMCwgMTgwLCAwLjMpJwogICAgICAgICAgICBdOwogICAgICAgICAgICAKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyMDsgaSsrKSB7CiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0aWNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgcGFydGljbGUuY2xhc3NOYW1lID0gJ3BhcnRpY2xlJzsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLndpZHRoID0gKDQgKyBNYXRoLnJhbmRvbSgpICogMTIpICsgJ3B4JzsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLmhlaWdodCA9IHBhcnRpY2xlLnN0eWxlLndpZHRoOwogICAgICAgICAgICAgICAgcGFydGljbGUuc3R5bGUuYmFja2dyb3VuZCA9IGNvbG9yc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjb2xvcnMubGVuZ3RoKV07CiAgICAgICAgICAgICAgICBwYXJ0aWNsZS5zdHlsZS5sZWZ0ID0gTWF0aC5yYW5kb20oKSAqIDEwMCArICclJzsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLmFuaW1hdGlvbkR1cmF0aW9uID0gKDI1ICsgTWF0aC5yYW5kb20oKSAqIDM1KSArICdzJzsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLmFuaW1hdGlvbkRlbGF5ID0gTWF0aC5yYW5kb20oKSAqIDI1ICsgJ3MnOwogICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHBhcnRpY2xlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gRXZlbnQgbGlzdGVuZXJzCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNvdW5kLW1vZGUnKS5mb3JFYWNoKGJ0biA9PiB7CiAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgIGluaXRBdWRpbygpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb25zdCBtb2RlID0gYnRuLmRhdGFzZXQubW9kZTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gVG9nZ2xlIG9mZgogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNb2RlID09PSBtb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgc3RvcEFsbFNvdW5kcygpOwogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRNb2RlID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc291bmQtbW9kZScpLmZvckVhY2goYiA9PiBiLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgICAgICAgICAgICAgICBjdXJyZW50TW9kZUVsLnRleHRDb250ZW50ID0gJ1d5YmllcnogZMW6d2nEmWsnOwogICAgICAgICAgICAgICAgICAgIG1vZGVJbmZvRWwudGV4dENvbnRlbnQgPSAnJzsKICAgICAgICAgICAgICAgICAgICB0aW1lckVsLnRleHRDb250ZW50ID0gJzA6MDAnOwogICAgICAgICAgICAgICAgICAgIG9yYi5jbGFzc0xpc3QucmVtb3ZlKCdoZWFydGJlYXQnKTsKICAgICAgICAgICAgICAgICAgICBvcmIuY2xhc3NMaXN0LmFkZCgnYnJlYXRoaW5nJyk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBTdGFydCBuZXcKICAgICAgICAgICAgICAgIHN0b3BBbGxTb3VuZHMoKTsKICAgICAgICAgICAgICAgIGN1cnJlbnRNb2RlID0gbW9kZTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNvdW5kLW1vZGUnKS5mb3JFYWNoKGIgPT4gYi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7CiAgICAgICAgICAgICAgICBidG4uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGN1cnJlbnRNb2RlRWwudGV4dENvbnRlbnQgPSBtb2RlTmFtZXNbbW9kZV07CiAgICAgICAgICAgICAgICBtb2RlSW5mb0VsLnRleHRDb250ZW50ID0gJ0dyYWogcHJ6ZXogbWluaW11bSAxMC0xNSBtaW51dCBkbGEgZWZla3R1JzsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgc2V0T3JiU3R5bGUobW9kZSk7CiAgICAgICAgICAgICAgICBzb3VuZEdlbmVyYXRvcnNbbW9kZV0oKTsKICAgICAgICAgICAgICAgIHN0YXJ0VGltZXIoKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBTaG93IGluZm8gb24gaG92ZXIKICAgICAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBpbmZvUGFuZWxUaXRsZS50ZXh0Q29udGVudCA9IG1vZGVOYW1lc1tidG4uZGF0YXNldC5tb2RlXTsKICAgICAgICAgICAgICAgIGluZm9QYW5lbFRleHQudGV4dENvbnRlbnQgPSBidG4uZGF0YXNldC5pbmZvOwogICAgICAgICAgICAgICAgaW5mb1BhbmVsLmNsYXNzTGlzdC5hZGQoJ3Zpc2libGUnKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHsKICAgICAgICAgICAgICAgIGluZm9QYW5lbC5jbGFzc0xpc3QucmVtb3ZlKCd2aXNpYmxlJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwoKICAgICAgICB2b2x1bWVTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoZSkgPT4gewogICAgICAgICAgICB2b2x1bWUgPSBlLnRhcmdldC52YWx1ZSAvIDEwMDsKICAgICAgICB9KTsKCiAgICAgICAgaGVscEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgYWxlcnQoYPCfp5ggU3RyZWZhIFNwb2tvanUgLSBXc2thesOzd2tpCgrigKIgU2VzamEgcG93aW5uYSB0cndhxIcgMTAtMTUgbWludXQgbWluaW11bQrigKIgVcW8eXdhaiB3IGNpY2h5bSwgcHJ6eWNpZW1uaW9ueW0gcG9taWVzemN6ZW5pdQrigKIgR8WCb8Wbbm/Fm8SHIHBvd2lubmEgYnnEhyBrb21mb3J0b3dhLCBuaWUgemEgZ8WCb8WbbmEK4oCiIE1vxbxlc3ogdcW8eXdhxIcgcmF6ZW0geiBkemllY2tpZW0K4oCiIE5hamxlcGllaiBwcnpleiBnxYJvxZtuaWtpLCBuaWUgc8WCdWNoYXdraSAoZGxhIG1hxYJ5Y2ggZHppZWNpKQoKRMW6d2nEmWtpIG9wYXJ0ZSBuYSBiYWRhbmlhY2ggbmF1a293eWNoIGRvdHljesSFY3ljaCB0ZXJhcGlpIGTFundpxJlraWVtIGRsYSBkemllY2kgeiBhdXR5em1lbS5gKTsKICAgICAgICB9KTsKCiAgICAgICAgLy8gRnVsbHNjcmVlbgogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgKCkgPT4gewogICAgICAgICAgICBpZiAoIWRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50KSB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4oKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgLy8gSW5pdAogICAgICAgIGNyZWF0ZVBhcnRpY2xlcygpOwogICAgPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPgo=",
            slowa: "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9InBsIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+U8WCb3dhIGkgT2JyYXpraTwvdGl0bGU+CiAgICA8c3R5bGU+CiAgICAgICAgKiB7CiAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAgICAgICB9CgogICAgICAgIGJvZHkgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjMGEwYTE1IDAlLCAjMTIxMjFmIDEwMCUpOwogICAgICAgICAgICBtaW4taGVpZ2h0OiAxMDB2aDsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgICAgZm9udC1mYW1pbHk6IHN5c3RlbS11aSwgc2Fucy1zZXJpZjsKICAgICAgICB9CgogICAgICAgIC5jb250YWluZXIgewogICAgICAgICAgICB3aWR0aDogMTAwdnc7CiAgICAgICAgICAgIGhlaWdodDogMTAwdmg7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICBwYWRkaW5nOiAyMHB4OwogICAgICAgIH0KCiAgICAgICAgLyogU2V0dXAgc2NyZWVuIGZvciBMZW9uJ3MgcGhvdG8gKi8KICAgICAgICAuc2V0dXAtc2NyZWVuIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICB0b3A6IDA7CiAgICAgICAgICAgIGxlZnQ6IDA7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMwYTBhMTU7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICB6LWluZGV4OiAxMDAwOwogICAgICAgICAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuNXM7CiAgICAgICAgfQoKICAgICAgICAuc2V0dXAtc2NyZWVuLmhpZGRlbiB7CiAgICAgICAgICAgIG9wYWNpdHk6IDA7CiAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lOwogICAgICAgIH0KCiAgICAgICAgLnNldHVwLXRpdGxlIHsKICAgICAgICAgICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC44KTsKICAgICAgICAgICAgZm9udC1zaXplOiAyOHB4OwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAzMHB4OwogICAgICAgICAgICBmb250LXdlaWdodDogMzAwOwogICAgICAgIH0KCiAgICAgICAgLnBob3RvLXVwbG9hZC1hcmVhIHsKICAgICAgICAgICAgd2lkdGg6IDIwMHB4OwogICAgICAgICAgICBoZWlnaHQ6IDIwMHB4OwogICAgICAgICAgICBib3JkZXI6IDNweCBkYXNoZWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjMpOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjNzOwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAzMHB4OwogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDUpOwogICAgICAgIH0KCiAgICAgICAgLnBob3RvLXVwbG9hZC1hcmVhOmhvdmVyIHsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNSk7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgICAgICB9CgogICAgICAgIC5waG90by11cGxvYWQtYXJlYS5oYXMtcGhvdG8gewogICAgICAgICAgICBib3JkZXItc3R5bGU6IHNvbGlkOwogICAgICAgICAgICBib3JkZXItY29sb3I6IHJnYmEoMTAwLCAyNTUsIDE1MCwgMC41KTsKICAgICAgICB9CgogICAgICAgIC5waG90by11cGxvYWQtYXJlYSBpbWcgewogICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICAgICAgICBvYmplY3QtZml0OiBjb3ZlcjsKICAgICAgICB9CgogICAgICAgIC51cGxvYWQtaWNvbiB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogNTBweDsKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTBweDsKICAgICAgICB9CgogICAgICAgIC51cGxvYWQtdGV4dCB7CiAgICAgICAgICAgIGNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNSk7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgICAgICBwYWRkaW5nOiAwIDIwcHg7CiAgICAgICAgfQoKICAgICAgICAjcGhvdG9JbnB1dCB7CiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICAgICAgfQoKICAgICAgICAuc2V0dXAtYnV0dG9ucyB7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGdhcDogMjBweDsKICAgICAgICB9CgogICAgICAgIC5zZXR1cC1idG4gewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjNGE1YTZhLCAjM2E0YTVhKTsKICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgIzZhN2E4YTsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgICAgICBwYWRkaW5nOiAyMHB4IDQwcHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDQwcHg7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMThweDsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zczsKICAgICAgICB9CgogICAgICAgIC5zZXR1cC1idG46aG92ZXIgewogICAgICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMDUpOwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgMzBweCByZ2JhKDEwMCwgMTUwLCAyMDAsIDAuMyk7CiAgICAgICAgfQoKICAgICAgICAuc2V0dXAtYnRuLnNlY29uZGFyeSB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7CiAgICAgICAgfQoKICAgICAgICAuc2V0dXAtaW5mbyB7CiAgICAgICAgICAgIGNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNCk7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICAgICAgbWFyZ2luLXRvcDogMzBweDsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgICAgICBtYXgtd2lkdGg6IDQwMHB4OwogICAgICAgICAgICBsaW5lLWhlaWdodDogMS42OwogICAgICAgIH0KCiAgICAgICAgLyogTWFpbiBnYW1lIGFyZWEgKi8KICAgICAgICAuZ2FtZS1hcmVhIHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgIG1heC13aWR0aDogODAwcHg7CiAgICAgICAgfQoKICAgICAgICAuaW5zdHJ1Y3Rpb24gewogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjYpOwogICAgICAgICAgICBmb250LXNpemU6IDI0cHg7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDQwcHg7CiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgICAgICAgICAgbWluLWhlaWdodDogMzZweDsKICAgICAgICB9CgogICAgICAgIC5pbnN0cnVjdGlvbi5oaWdobGlnaHQgewogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDIyMCwgMTAwLCAwLjkpOwogICAgICAgICAgICBmb250LXNpemU6IDI4cHg7CiAgICAgICAgfQoKICAgICAgICAvKiBJdGVtcyBncmlkICovCiAgICAgICAgLml0ZW1zLWdyaWQgewogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICBnYXA6IDMwcHg7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDQwcHg7CiAgICAgICAgfQoKICAgICAgICAuaXRlbS1jYXJkIHsKICAgICAgICAgICAgd2lkdGg6IDE4MHB4OwogICAgICAgICAgICBoZWlnaHQ6IDIyMHB4OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDUpOwogICAgICAgICAgICBib3JkZXI6IDNweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDI1cHg7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjNzOwogICAgICAgICAgICBwYWRkaW5nOiAyMHB4OwogICAgICAgIH0KCiAgICAgICAgLml0ZW0tY2FyZDpob3ZlciB7CiAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMS4wNSk7CiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjMpOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMDgpOwogICAgICAgIH0KCiAgICAgICAgLml0ZW0tY2FyZC5jb3JyZWN0IHsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDEwMCwgMjU1LCAxNTAsIDAuOCk7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMTAwLCAyNTUsIDE1MCwgMC4xNSk7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMCA0MHB4IHJnYmEoMTAwLCAyNTUsIDE1MCwgMC4zKTsKICAgICAgICB9CgogICAgICAgIC5pdGVtLWNhcmQuYm91bmNpbmcgLml0ZW0taWNvbiB7CiAgICAgICAgICAgIGFuaW1hdGlvbjogYm91bmNlIDAuNXMgZWFzZS1pbi1vdXQgaW5maW5pdGU7CiAgICAgICAgfQoKICAgICAgICAuaXRlbS1jYXJkLm1lZ2EtYm91bmNlIC5pdGVtLWljb24gewogICAgICAgICAgICBhbmltYXRpb246IG1lZ2FCb3VuY2UgMC42cyBlYXNlLWluLW91dCBpbmZpbml0ZTsKICAgICAgICB9CgogICAgICAgIEBrZXlmcmFtZXMgYm91bmNlIHsKICAgICAgICAgICAgMCUsIDEwMCUgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCkgc2NhbGUoMSk7IH0KICAgICAgICAgICAgNTAlIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xNXB4KSBzY2FsZSgxLjEpOyB9CiAgICAgICAgfQoKICAgICAgICBAa2V5ZnJhbWVzIG1lZ2FCb3VuY2UgewogICAgICAgICAgICAwJSwgMTAwJSB7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKSBzY2FsZSgxKSByb3RhdGUoMGRlZyk7IH0KICAgICAgICAgICAgMjUlIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0yNXB4KSBzY2FsZSgxLjIpIHJvdGF0ZSgtNWRlZyk7IH0KICAgICAgICAgICAgNzUlIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0yNXB4KSBzY2FsZSgxLjIpIHJvdGF0ZSg1ZGVnKTsgfQogICAgICAgIH0KCiAgICAgICAgLml0ZW0taWNvbiB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogODBweDsKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsKICAgICAgICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuM3M7CiAgICAgICAgfQoKICAgICAgICAuaXRlbS1jYXJkLmxlb24gLml0ZW0taWNvbiB7CiAgICAgICAgICAgIHdpZHRoOiAxMDBweDsKICAgICAgICAgICAgaGVpZ2h0OiAxMDBweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpOwogICAgICAgIH0KCiAgICAgICAgLml0ZW0tY2FyZC5sZW9uIC5pdGVtLWljb24gaW1nIHsKICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICAgICAgb2JqZWN0LWZpdDogY292ZXI7CiAgICAgICAgfQoKICAgICAgICAuaXRlbS1sYWJlbCB7CiAgICAgICAgICAgIGNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNyk7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjJweDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDQwMDsKICAgICAgICAgICAgb3BhY2l0eTogMDsKICAgICAgICAgICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjNzOwogICAgICAgIH0KCiAgICAgICAgLml0ZW0tY2FyZC5zaG93LWxhYmVsIC5pdGVtLWxhYmVsIHsKICAgICAgICAgICAgb3BhY2l0eTogMTsKICAgICAgICB9CgogICAgICAgIC8qIEZsb2F0aW5nIHdvcmQgZGlzcGxheSAqLwogICAgICAgIC5mbG9hdGluZy13b3JkIHsKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICB0b3A6IDUwJTsKICAgICAgICAgICAgbGVmdDogNTAlOwogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsKICAgICAgICAgICAgZm9udC1zaXplOiAxMjBweDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDMwMDsKICAgICAgICAgICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC45KTsKICAgICAgICAgICAgdGV4dC1zaGFkb3c6IDAgMCA2MHB4IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC41KTsKICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICAgICAgICAgIG9wYWNpdHk6IDA7CiAgICAgICAgICAgIHotaW5kZXg6IDEwMDsKICAgICAgICAgICAgYW5pbWF0aW9uOiB3b3JkQXBwZWFyIDJzIGVhc2Utb3V0IGZvcndhcmRzOwogICAgICAgIH0KCiAgICAgICAgQGtleWZyYW1lcyB3b3JkQXBwZWFyIHsKICAgICAgICAgICAgMCUgeyBvcGFjaXR5OiAwOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKSBzY2FsZSgwLjUpOyB9CiAgICAgICAgICAgIDIwJSB7IG9wYWNpdHk6IDE7IHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpIHNjYWxlKDEuMSk7IH0KICAgICAgICAgICAgODAlIHsgb3BhY2l0eTogMTsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSkgc2NhbGUoMSk7IH0KICAgICAgICAgICAgMTAwJSB7IG9wYWNpdHk6IDA7IHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC02MCUpIHNjYWxlKDAuOSk7IH0KICAgICAgICB9CgogICAgICAgIC8qIENlbGVicmF0aW9uIHBhcnRpY2xlcyAqLwogICAgICAgIC5wYXJ0aWNsZSB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgYW5pbWF0aW9uOiBwYXJ0aWNsZUZseSAxLjVzIGVhc2Utb3V0IGZvcndhcmRzOwogICAgICAgIH0KCiAgICAgICAgQGtleWZyYW1lcyBwYXJ0aWNsZUZseSB7CiAgICAgICAgICAgIDAlIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMCwgMCkgc2NhbGUoMSk7IG9wYWNpdHk6IDE7IH0KICAgICAgICAgICAgMTAwJSB7IHRyYW5zZm9ybTogdHJhbnNsYXRlKHZhcigtLXR4KSwgdmFyKC0tdHkpKSBzY2FsZSgwKTsgb3BhY2l0eTogMDsgfQogICAgICAgIH0KCiAgICAgICAgLnN0YXIgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogNDBweDsKICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICAgICAgICAgIGFuaW1hdGlvbjogc3RhckZsb2F0IDEuNXMgZWFzZS1vdXQgZm9yd2FyZHM7CiAgICAgICAgfQoKICAgICAgICBAa2V5ZnJhbWVzIHN0YXJGbG9hdCB7CiAgICAgICAgICAgIDAlIHsgb3BhY2l0eTogMDsgdHJhbnNmb3JtOiBzY2FsZSgwKSByb3RhdGUoMGRlZyk7IH0KICAgICAgICAgICAgMzAlIHsgb3BhY2l0eTogMTsgdHJhbnNmb3JtOiBzY2FsZSgxLjIpIHJvdGF0ZSgyMGRlZyk7IH0KICAgICAgICAgICAgMTAwJSB7IG9wYWNpdHk6IDA7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMTAwcHgpIHNjYWxlKDAuNSkgcm90YXRlKDE4MGRlZyk7IH0KICAgICAgICB9CgogICAgICAgIC8qIFNjb3JlICovCiAgICAgICAgLnNjb3JlLWRpc3BsYXkgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIHRvcDogMzBweDsKICAgICAgICAgICAgcmlnaHQ6IDMwcHg7CiAgICAgICAgICAgIHRleHQtYWxpZ246IHJpZ2h0OwogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjQpOwogICAgICAgIH0KCiAgICAgICAgLnNjb3JlLWRpc3BsYXkgLnNjb3JlIHsKICAgICAgICAgICAgZm9udC1zaXplOiA0OHB4OwogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjYpOwogICAgICAgIH0KCiAgICAgICAgLyogQ29udHJvbHMgKi8KICAgICAgICAuY29udHJvbHMgewogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIGJvdHRvbTogMzBweDsKICAgICAgICAgICAgbGVmdDogNTAlOwogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGdhcDogMTVweDsKICAgICAgICB9CgogICAgICAgIC5jb250cm9sLWJ0biB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKTsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpOwogICAgICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjUpOwogICAgICAgICAgICBwYWRkaW5nOiAxMnB4IDI1cHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDI1cHg7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zczsKICAgICAgICB9CgogICAgICAgIC5jb250cm9sLWJ0bjpob3ZlciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgIH0KICAgIDwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+CiAgICA8IS0tIFNldHVwIHNjcmVlbiBmb3IgTGVvbidzIHBob3RvIC0tPgogICAgPGRpdiBjbGFzcz0ic2V0dXAtc2NyZWVuIiBpZD0ic2V0dXBTY3JlZW4iPgogICAgICAgIDxoMSBjbGFzcz0ic2V0dXAtdGl0bGUiPkRvZGFqIHpkasSZY2llIExlb25hPC9oMT4KICAgICAgICAKICAgICAgICA8ZGl2IGNsYXNzPSJwaG90by11cGxvYWQtYXJlYSIgaWQ9InBob3RvVXBsb2FkQXJlYSI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ1cGxvYWQtaWNvbiI+8J+Ttzwvc3Bhbj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InVwbG9hZC10ZXh0Ij5LbGlrbmlqIGFieSBkb2RhxIcgemRqxJljaWU8L3NwYW4+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGlucHV0IHR5cGU9ImZpbGUiIGlkPSJwaG90b0lucHV0IiBhY2NlcHQ9ImltYWdlLyoiPgoKICAgICAgICA8ZGl2IGNsYXNzPSJzZXR1cC1idXR0b25zIj4KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ic2V0dXAtYnRuIHNlY29uZGFyeSIgaWQ9InNraXBQaG90b0J0biI+UG9tacWEPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InNldHVwLWJ0biIgaWQ9InN0YXJ0V2l0aFBob3RvQnRuIj5Sb3pwb2N6bmlqPC9idXR0b24+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxwIGNsYXNzPSJzZXR1cC1pbmZvIj4KICAgICAgICAgICAgR2R5IExlb24ga2xpa25pZSBuYSBzd29qZSB6ZGrEmWNpZSwgdXPFgnlzenkgc3dvamUgaW1pxJkuPGJyPgogICAgICAgICAgICBUbyBwb21vxbxlIG11IHBvxYLEhWN6ecSHIHN3b2rEhSB0d2FyeiB6IGltaWVuaWVtLgogICAgICAgIDwvcD4KICAgIDwvZGl2PgoKICAgIDwhLS0gTWFpbiBnYW1lIC0tPgogICAgPGRpdiBjbGFzcz0iY29udGFpbmVyIiBpZD0iY29udGFpbmVyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJnYW1lLWFyZWEiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnN0cnVjdGlvbiIgaWQ9Imluc3RydWN0aW9uIj5LbGlrbmlqIG5hIG9icmF6ZWshPC9kaXY+CiAgICAgICAgICAgIAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJpdGVtcy1ncmlkIiBpZD0iaXRlbXNHcmlkIj4KICAgICAgICAgICAgICAgIDwhLS0gSXRlbXMgd2lsbCBiZSBnZW5lcmF0ZWQgaGVyZSAtLT4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDxkaXYgY2xhc3M9InNjb3JlLWRpc3BsYXkiPgogICAgICAgICAgICA8ZGl2PlB1bmt0eTwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJzY29yZSIgaWQ9InNjb3JlIj4wPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGNsYXNzPSJjb250cm9scyI+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iY29udHJvbC1idG4iIGlkPSJuZXdSb3VuZEJ0biI+Tm93YSBydW5kYTwvYnV0dG9uPgogICAgICAgIDxidXR0b24gY2xhc3M9ImNvbnRyb2wtYnRuIiBpZD0ic2V0dGluZ3NCdG4iPuKamSBaZGrEmWNpZSBMZW9uYTwvYnV0dG9uPgogICAgPC9kaXY+CgogICAgPHNjcmlwdD4KICAgICAgICAvLyBBdWRpbyBzZXR1cAogICAgICAgIGNvbnN0IEF1ZGlvQ29udGV4dCA9IHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dDsKICAgICAgICBsZXQgYXVkaW9DdHggPSBudWxsOwoKICAgICAgICBmdW5jdGlvbiBpbml0QXVkaW8oKSB7CiAgICAgICAgICAgIGlmICghYXVkaW9DdHgpIHsKICAgICAgICAgICAgICAgIGF1ZGlvQ3R4ID0gbmV3IEF1ZGlvQ29udGV4dCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChhdWRpb0N0eC5zdGF0ZSA9PT0gJ3N1c3BlbmRlZCcpIHsKICAgICAgICAgICAgICAgIGF1ZGlvQ3R4LnJlc3VtZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBTcGVlY2ggc3ludGhlc2lzCiAgICAgICAgY29uc3Qgc3ludGggPSB3aW5kb3cuc3BlZWNoU3ludGhlc2lzOwogICAgICAgIAogICAgICAgIGZ1bmN0aW9uIHNwZWFrKHRleHQsIHJhdGUgPSAwLjgsIHBpdGNoID0gMS4xKSB7CiAgICAgICAgICAgIC8vIENhbmNlbCBhbnkgb25nb2luZyBzcGVlY2gKICAgICAgICAgICAgc3ludGguY2FuY2VsKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCB1dHRlcmFuY2UgPSBuZXcgU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlKHRleHQpOwogICAgICAgICAgICB1dHRlcmFuY2UubGFuZyA9ICdwbC1QTCc7CiAgICAgICAgICAgIHV0dGVyYW5jZS5yYXRlID0gcmF0ZTsgIC8vIFNsb3dlciBmb3IgY2xhcml0eQogICAgICAgICAgICB1dHRlcmFuY2UucGl0Y2ggPSBwaXRjaDsgLy8gU2xpZ2h0bHkgaGlnaGVyLCBmcmllbmRsaWVyCiAgICAgICAgICAgIHV0dGVyYW5jZS52b2x1bWUgPSAxOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gVHJ5IHRvIGZpbmQgUG9saXNoIHZvaWNlCiAgICAgICAgICAgIGNvbnN0IHZvaWNlcyA9IHN5bnRoLmdldFZvaWNlcygpOwogICAgICAgICAgICBjb25zdCBwb2xpc2hWb2ljZSA9IHZvaWNlcy5maW5kKHYgPT4gdi5sYW5nLnN0YXJ0c1dpdGgoJ3BsJykpOwogICAgICAgICAgICBpZiAocG9saXNoVm9pY2UpIHsKICAgICAgICAgICAgICAgIHV0dGVyYW5jZS52b2ljZSA9IHBvbGlzaFZvaWNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBzeW50aC5zcGVhayh1dHRlcmFuY2UpOwogICAgICAgICAgICByZXR1cm4gdXR0ZXJhbmNlOwogICAgICAgIH0KCiAgICAgICAgLy8gSXRlbXMgZGF0YWJhc2UKICAgICAgICBjb25zdCBpdGVtcyA9IFsKICAgICAgICAgICAgeyBpZDogJ3BpbGthJywgaWNvbjogJ+KavScsIHdvcmQ6ICdwacWCa2EnIH0sCiAgICAgICAgICAgIHsgaWQ6ICdhdXRvJywgaWNvbjogJ/CfmpcnLCB3b3JkOiAnYXV0bycgfSwKICAgICAgICAgICAgeyBpZDogJ3BpZXMnLCBpY29uOiAn8J+QlScsIHdvcmQ6ICdwaWVzJyB9LAogICAgICAgICAgICB7IGlkOiAna290JywgaWNvbjogJ/CfkLEnLCB3b3JkOiAna290JyB9LAogICAgICAgICAgICB7IGlkOiAnZG9tJywgaWNvbjogJ/Cfj6AnLCB3b3JkOiAnZG9tJyB9LAogICAgICAgICAgICB7IGlkOiAnc2xvbmNlJywgaWNvbjogJ+KYgO+4jycsIHdvcmQ6ICdzxYJvxYRjZScgfSwKICAgICAgICAgICAgeyBpZDogJ2t3aWF0JywgaWNvbjogJ/CfjLgnLCB3b3JkOiAna3dpYXQnIH0sCiAgICAgICAgICAgIHsgaWQ6ICdqYWJsa28nLCBpY29uOiAn8J+NjicsIHdvcmQ6ICdqYWLFgmtvJyB9LAogICAgICAgICAgICB7IGlkOiAnYmFuYW4nLCBpY29uOiAn8J+NjCcsIHdvcmQ6ICdiYW5hbicgfSwKICAgICAgICAgICAgeyBpZDogJ21pcycsIGljb246ICfwn6e4Jywgd29yZDogJ21pxZsnIH0sCiAgICAgICAgICAgIHsgaWQ6ICdyeWJhJywgaWNvbjogJ/CfkJ8nLCB3b3JkOiAncnliYScgfSwKICAgICAgICAgICAgeyBpZDogJ3B0YWsnLCBpY29uOiAn8J+QpicsIHdvcmQ6ICdwdGFrJyB9LAogICAgICAgICAgICB7IGlkOiAnZHJ6ZXdvJywgaWNvbjogJ/CfjLMnLCB3b3JkOiAnZHJ6ZXdvJyB9LAogICAgICAgICAgICB7IGlkOiAna3NpZXp5YycsIGljb246ICfwn4yZJywgd29yZDogJ2tzacSZxbx5YycgfSwKICAgICAgICAgICAgeyBpZDogJ2d3aWF6ZGEnLCBpY29uOiAn4q2QJywgd29yZDogJ2d3aWF6ZGEnIH0sCiAgICAgICAgXTsKCiAgICAgICAgLy8gU3RhdGUKICAgICAgICBsZXQgbGVvblBob3RvID0gbnVsbDsKICAgICAgICBsZXQgc2NvcmUgPSAwOwogICAgICAgIGxldCBjdXJyZW50SXRlbXMgPSBbXTsKCiAgICAgICAgLy8gRWxlbWVudHMKICAgICAgICBjb25zdCBzZXR1cFNjcmVlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR1cFNjcmVlbicpOwogICAgICAgIGNvbnN0IHBob3RvVXBsb2FkQXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwaG90b1VwbG9hZEFyZWEnKTsKICAgICAgICBjb25zdCBwaG90b0lucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bob3RvSW5wdXQnKTsKICAgICAgICBjb25zdCBza2lwUGhvdG9CdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2tpcFBob3RvQnRuJyk7CiAgICAgICAgY29uc3Qgc3RhcnRXaXRoUGhvdG9CdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnRXaXRoUGhvdG9CdG4nKTsKICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFpbmVyJyk7CiAgICAgICAgY29uc3QgaXRlbXNHcmlkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2l0ZW1zR3JpZCcpOwogICAgICAgIGNvbnN0IGluc3RydWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luc3RydWN0aW9uJyk7CiAgICAgICAgY29uc3Qgc2NvcmVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY29yZScpOwogICAgICAgIGNvbnN0IG5ld1JvdW5kQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ld1JvdW5kQnRuJyk7CiAgICAgICAgY29uc3Qgc2V0dGluZ3NCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0dGluZ3NCdG4nKTsKCiAgICAgICAgY29uc3QgY29sb3JzID0gWycjZmY2YjZiJywgJyM0ZWNkYzQnLCAnI2ZmZTY2ZCcsICcjOTVlMWQzJywgJyNkZGEwZGQnLCAnIzg3Y2VlYicsICcjZjhiNTAwJ107CgogICAgICAgIC8vIFBob3RvIGhhbmRsaW5nCiAgICAgICAgcGhvdG9VcGxvYWRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICBwaG90b0lucHV0LmNsaWNrKCk7CiAgICAgICAgfSk7CgogICAgICAgIHBob3RvSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHsKICAgICAgICAgICAgY29uc3QgZmlsZSA9IGUudGFyZ2V0LmZpbGVzWzBdOwogICAgICAgICAgICBpZiAoZmlsZSkgewogICAgICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoZXZlbnQpID0+IHsKICAgICAgICAgICAgICAgICAgICBsZW9uUGhvdG8gPSBldmVudC50YXJnZXQucmVzdWx0OwogICAgICAgICAgICAgICAgICAgIHBob3RvVXBsb2FkQXJlYS5pbm5lckhUTUwgPSBgPGltZyBzcmM9IiR7bGVvblBob3RvfSIgYWx0PSJMZW9uIj5gOwogICAgICAgICAgICAgICAgICAgIHBob3RvVXBsb2FkQXJlYS5jbGFzc0xpc3QuYWRkKCdoYXMtcGhvdG8nKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBza2lwUGhvdG9CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgIHNldHVwU2NyZWVuLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgICAgICBnZW5lcmF0ZVJvdW5kKCk7CiAgICAgICAgfSk7CgogICAgICAgIHN0YXJ0V2l0aFBob3RvQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICBzZXR1cFNjcmVlbi5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKICAgICAgICAgICAgZ2VuZXJhdGVSb3VuZCgpOwogICAgICAgIH0pOwoKICAgICAgICBzZXR0aW5nc0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgc2V0dXBTY3JlZW4uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgfSk7CgogICAgICAgIC8vIEdhbWUgZnVuY3Rpb25zCiAgICAgICAgZnVuY3Rpb24gZ2VuZXJhdGVSb3VuZCgpIHsKICAgICAgICAgICAgaXRlbXNHcmlkLmlubmVySFRNTCA9ICcnOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gUGljayAzIHJhbmRvbSBpdGVtcyArIExlb24gaWYgcGhvdG8gZXhpc3RzCiAgICAgICAgICAgIGNvbnN0IHNodWZmbGVkID0gWy4uLml0ZW1zXS5zb3J0KCgpID0+IE1hdGgucmFuZG9tKCkgLSAwLjUpOwogICAgICAgICAgICBjdXJyZW50SXRlbXMgPSBzaHVmZmxlZC5zbGljZSgwLCBsZW9uUGhvdG8gPyAzIDogNCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBBZGQgTGVvbiBjYXJkIGlmIHBob3RvIGV4aXN0cwogICAgICAgICAgICBpZiAobGVvblBob3RvKSB7CiAgICAgICAgICAgICAgICBjdXJyZW50SXRlbXMucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgaWQ6ICdsZW9uJywKICAgICAgICAgICAgICAgICAgICBpY29uOiBudWxsLAogICAgICAgICAgICAgICAgICAgIHdvcmQ6ICdMZW9uJywKICAgICAgICAgICAgICAgICAgICBpc0xlb246IHRydWUKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBTaHVmZmxlIGFnYWluIHRvIHJhbmRvbWl6ZSBMZW9uJ3MgcG9zaXRpb24KICAgICAgICAgICAgY3VycmVudEl0ZW1zLnNvcnQoKCkgPT4gTWF0aC5yYW5kb20oKSAtIDAuNSk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBDcmVhdGUgY2FyZHMKICAgICAgICAgICAgY3VycmVudEl0ZW1zLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBjYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICBjYXJkLmNsYXNzTmFtZSA9ICdpdGVtLWNhcmQnICsgKGl0ZW0uaXNMZW9uID8gJyBsZW9uJyA6ICcnKTsKICAgICAgICAgICAgICAgIGNhcmQuZGF0YXNldC5pZCA9IGl0ZW0uaWQ7CiAgICAgICAgICAgICAgICBjYXJkLmRhdGFzZXQud29yZCA9IGl0ZW0ud29yZDsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29uc3QgaWNvbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgaWNvbkRpdi5jbGFzc05hbWUgPSAnaXRlbS1pY29uJzsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKGl0ZW0uaXNMZW9uICYmIGxlb25QaG90bykgewogICAgICAgICAgICAgICAgICAgIGljb25EaXYuaW5uZXJIVE1MID0gYDxpbWcgc3JjPSIke2xlb25QaG90b30iIGFsdD0iTGVvbiI+YDsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWNvbkRpdi50ZXh0Q29udGVudCA9IGl0ZW0uaWNvbjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgIGxhYmVsLmNsYXNzTmFtZSA9ICdpdGVtLWxhYmVsJzsKICAgICAgICAgICAgICAgIGxhYmVsLnRleHRDb250ZW50ID0gaXRlbS53b3JkOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjYXJkLmFwcGVuZENoaWxkKGljb25EaXYpOwogICAgICAgICAgICAgICAgY2FyZC5hcHBlbmRDaGlsZChsYWJlbCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBoYW5kbGVJdGVtQ2xpY2soY2FyZCwgaXRlbSkpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpdGVtc0dyaWQuYXBwZW5kQ2hpbGQoY2FyZCk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaW5zdHJ1Y3Rpb24udGV4dENvbnRlbnQgPSAnS2xpa25paiBuYSBvYnJhemVrISc7CiAgICAgICAgICAgIGluc3RydWN0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodCcpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gaGFuZGxlSXRlbUNsaWNrKGNhcmQsIGl0ZW0pIHsKICAgICAgICAgICAgaW5pdEF1ZGlvKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBWaXN1YWwgZmVlZGJhY2sKICAgICAgICAgICAgY2FyZC5jbGFzc0xpc3QuYWRkKCdib3VuY2luZycsICdzaG93LWxhYmVsJywgJ2NvcnJlY3QnKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIEV4dHJhIHNwZWNpYWwgZm9yIExlb24KICAgICAgICAgICAgaWYgKGl0ZW0uaXNMZW9uKSB7CiAgICAgICAgICAgICAgICBjYXJkLmNsYXNzTGlzdC5yZW1vdmUoJ2JvdW5jaW5nJyk7CiAgICAgICAgICAgICAgICBjYXJkLmNsYXNzTGlzdC5hZGQoJ21lZ2EtYm91bmNlJyk7CiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbi50ZXh0Q29udGVudCA9ICdUbyBMRU9OISDwn4yfJzsKICAgICAgICAgICAgICAgIGluc3RydWN0aW9uLmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodCcpOwogICAgICAgICAgICAgICAgY3JlYXRlTWVnYUNlbGVicmF0aW9uKGNhcmQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBTcGVhayB0aGUgd29yZAogICAgICAgICAgICBjb25zdCB1dHRlcmFuY2UgPSBzcGVhayhpdGVtLndvcmQpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gU2hvdyBmbG9hdGluZyB3b3JkCiAgICAgICAgICAgIHNob3dGbG9hdGluZ1dvcmQoaXRlbS53b3JkKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFBsYXkgc3VjY2VzcyBzb3VuZAogICAgICAgICAgICBwbGF5U3VjY2Vzc1NvdW5kKGl0ZW0uaXNMZW9uKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFNjb3JlCiAgICAgICAgICAgIHNjb3JlKys7CiAgICAgICAgICAgIHNjb3JlRWwudGV4dENvbnRlbnQgPSBzY29yZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIENyZWF0ZSBwYXJ0aWNsZXMKICAgICAgICAgICAgY3JlYXRlUGFydGljbGVzKGNhcmQsIGl0ZW0uaXNMZW9uKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFJlc2V0IGFmdGVyIGFuaW1hdGlvbgogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIGNhcmQuY2xhc3NMaXN0LnJlbW92ZSgnYm91bmNpbmcnLCAnbWVnYS1ib3VuY2UnLCAnY29ycmVjdCcpOwogICAgICAgICAgICAgICAgLy8gS2VlcCBsYWJlbCB2aXNpYmxlIGZvciBsZWFybmluZwogICAgICAgICAgICB9LCBpdGVtLmlzTGVvbiA/IDMwMDAgOiAyMDAwKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHNob3dGbG9hdGluZ1dvcmQod29yZCkgewogICAgICAgICAgICBjb25zdCBmbG9hdGluZ1dvcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgZmxvYXRpbmdXb3JkLmNsYXNzTmFtZSA9ICdmbG9hdGluZy13b3JkJzsKICAgICAgICAgICAgZmxvYXRpbmdXb3JkLnRleHRDb250ZW50ID0gd29yZDsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmbG9hdGluZ1dvcmQpOwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IGZsb2F0aW5nV29yZC5yZW1vdmUoKSwgMjAwMCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBwbGF5U3VjY2Vzc1NvdW5kKGlzU3BlY2lhbCA9IGZhbHNlKSB7CiAgICAgICAgICAgIGluaXRBdWRpbygpOwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3QgYmFzZU5vdGVzID0gaXNTcGVjaWFsIAogICAgICAgICAgICAgICAgPyBbNTIzLjI1LCA2NTkuMjUsIDc4My45OSwgMTA0Ni41MF0gLy8gQzUsIEU1LCBHNSwgQzYgLSBiaWdnZXIgY2hvcmQKICAgICAgICAgICAgICAgIDogWzUyMy4yNSwgNjU5LjI1LCA3ODMuOTldOyAvLyBDNSwgRTUsIEc1CiAgICAgICAgICAgIAogICAgICAgICAgICBiYXNlTm90ZXMuZm9yRWFjaCgoZnJlcSwgaSkgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3NjID0gYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGdhaW4gPSBhdWRpb0N0eC5jcmVhdGVHYWluKCk7CiAgICAgICAgICAgICAgICAgICAgb3NjLnR5cGUgPSAnc2luZSc7CiAgICAgICAgICAgICAgICAgICAgb3NjLmZyZXF1ZW5jeS5zZXRWYWx1ZUF0VGltZShmcmVxLCBhdWRpb0N0eC5jdXJyZW50VGltZSk7CiAgICAgICAgICAgICAgICAgICAgZ2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKGlzU3BlY2lhbCA/IDAuMzUgOiAwLjI1LCBhdWRpb0N0eC5jdXJyZW50VGltZSk7CiAgICAgICAgICAgICAgICAgICAgZ2Fpbi5nYWluLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUoMC4wMSwgYXVkaW9DdHguY3VycmVudFRpbWUgKyAoaXNTcGVjaWFsID8gMS41IDogMSkpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIEFkZCB3YXJtdGgKICAgICAgICAgICAgICAgICAgICBjb25zdCBvc2MyID0gYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpOwogICAgICAgICAgICAgICAgICAgIG9zYzIudHlwZSA9ICdzaW5lJzsKICAgICAgICAgICAgICAgICAgICBvc2MyLmZyZXF1ZW5jeS5zZXRWYWx1ZUF0VGltZShmcmVxICogMiwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGdhaW4yID0gYXVkaW9DdHguY3JlYXRlR2FpbigpOwogICAgICAgICAgICAgICAgICAgIGdhaW4yLmdhaW4uc2V0VmFsdWVBdFRpbWUoMC4wOCwgYXVkaW9DdHguY3VycmVudFRpbWUpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIG9zYy5jb25uZWN0KGdhaW4pOwogICAgICAgICAgICAgICAgICAgIG9zYzIuY29ubmVjdChnYWluMik7CiAgICAgICAgICAgICAgICAgICAgZ2FpbjIuY29ubmVjdChnYWluKTsKICAgICAgICAgICAgICAgICAgICBnYWluLmNvbm5lY3QoYXVkaW9DdHguZGVzdGluYXRpb24pOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIG9zYy5zdGFydCgpOwogICAgICAgICAgICAgICAgICAgIG9zYzIuc3RhcnQoKTsKICAgICAgICAgICAgICAgICAgICBvc2Muc3RvcChhdWRpb0N0eC5jdXJyZW50VGltZSArIDEuNSk7CiAgICAgICAgICAgICAgICAgICAgb3NjMi5zdG9wKGF1ZGlvQ3R4LmN1cnJlbnRUaW1lICsgMS41KTsKICAgICAgICAgICAgICAgIH0sIGkgKiAxMDApOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVBhcnRpY2xlcyhjYXJkLCBpc1NwZWNpYWwgPSBmYWxzZSkgewogICAgICAgICAgICBjb25zdCByZWN0ID0gY2FyZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICAgICAgY29uc3QgY2VudGVyWCA9IHJlY3QubGVmdCArIHJlY3Qud2lkdGggLyAyOwogICAgICAgICAgICBjb25zdCBjZW50ZXJZID0gcmVjdC50b3AgKyByZWN0LmhlaWdodCAvIDI7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCBwYXJ0aWNsZUNvdW50ID0gaXNTcGVjaWFsID8gMzAgOiAxNTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFydGljbGVDb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0aWNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgcGFydGljbGUuY2xhc3NOYW1lID0gJ3BhcnRpY2xlJzsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLndpZHRoID0gKDggKyBNYXRoLnJhbmRvbSgpICogMTApICsgJ3B4JzsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLmhlaWdodCA9IHBhcnRpY2xlLnN0eWxlLndpZHRoOwogICAgICAgICAgICAgICAgcGFydGljbGUuc3R5bGUuYmFja2dyb3VuZCA9IGNvbG9yc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjb2xvcnMubGVuZ3RoKV07CiAgICAgICAgICAgICAgICBwYXJ0aWNsZS5zdHlsZS5sZWZ0ID0gY2VudGVyWCArICdweCc7CiAgICAgICAgICAgICAgICBwYXJ0aWNsZS5zdHlsZS50b3AgPSBjZW50ZXJZICsgJ3B4JzsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29uc3QgYW5nbGUgPSAoaSAvIHBhcnRpY2xlQ291bnQpICogTWF0aC5QSSAqIDI7CiAgICAgICAgICAgICAgICBjb25zdCB2ZWxvY2l0eSA9IChpc1NwZWNpYWwgPyAxNTAgOiAxMDApICsgTWF0aC5yYW5kb20oKSAqIDEwMDsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLnNldFByb3BlcnR5KCctLXR4JywgTWF0aC5jb3MoYW5nbGUpICogdmVsb2NpdHkgKyAncHgnKTsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLnN0eWxlLnNldFByb3BlcnR5KCctLXR5JywgTWF0aC5zaW4oYW5nbGUpICogdmVsb2NpdHkgKyAncHgnKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwYXJ0aWNsZSk7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHBhcnRpY2xlLnJlbW92ZSgpLCAxNTAwKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTWVnYUNlbGVicmF0aW9uKGNhcmQpIHsKICAgICAgICAgICAgY29uc3QgcmVjdCA9IGNhcmQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICAgIGNvbnN0IGNlbnRlclggPSByZWN0LmxlZnQgKyByZWN0LndpZHRoIC8gMjsKICAgICAgICAgICAgY29uc3QgY2VudGVyWSA9IHJlY3QudG9wICsgcmVjdC5oZWlnaHQgLyAyOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gU3RhcnMKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgc3Rhci5jbGFzc05hbWUgPSAnc3Rhcic7CiAgICAgICAgICAgICAgICAgICAgc3Rhci50ZXh0Q29udGVudCA9ICfirZAnOwogICAgICAgICAgICAgICAgICAgIHN0YXIuc3R5bGUubGVmdCA9IChjZW50ZXJYIC0gMTAwICsgTWF0aC5yYW5kb20oKSAqIDIwMCkgKyAncHgnOwogICAgICAgICAgICAgICAgICAgIHN0YXIuc3R5bGUudG9wID0gKGNlbnRlclkgLSA1MCArIE1hdGgucmFuZG9tKCkgKiAxMDApICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHN0YXIpOwogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gc3Rhci5yZW1vdmUoKSwgMTUwMCk7CiAgICAgICAgICAgICAgICB9LCBpICogMTAwKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gQ29udHJvbHMKICAgICAgICBuZXdSb3VuZEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGdlbmVyYXRlUm91bmQpOwoKICAgICAgICAvLyBMb2FkIHZvaWNlcwogICAgICAgIHNwZWVjaFN5bnRoZXNpcy5vbnZvaWNlc2NoYW5nZWQgPSAoKSA9PiB7CiAgICAgICAgICAgIC8vIFZvaWNlcyBsb2FkZWQKICAgICAgICB9OwoKICAgICAgICAvLyBGdWxsc2NyZWVuCiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZGJsY2xpY2snLCAoZSkgPT4gewogICAgICAgICAgICBpZiAoZS50YXJnZXQuY2xvc2VzdCgnLnNldHVwLXNjcmVlbicpIHx8IGUudGFyZ2V0LmNsb3Nlc3QoJy5pdGVtLWNhcmQnKSkgcmV0dXJuOwogICAgICAgICAgICBpZiAoIWRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50KSB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4oKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIDwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4K",
            dzwiek: "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9InBsIj4KPGhlYWQ+CiAgPG1ldGEgY2hhcnNldD0iVVRGLTgiIC8+CiAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAsIG1heGltdW0tc2NhbGU9MS4wLCB1c2VyLXNjYWxhYmxlPW5vIiAvPgogIDxtZXRhIG5hbWU9ImFwcGxlLW1vYmlsZS13ZWItYXBwLWNhcGFibGUiIGNvbnRlbnQ9InllcyIgLz4KICA8dGl0bGU+Vm9jYWwgSGVybzwvdGl0bGU+CiAgPHN0eWxlPgogICAgKnttYXJnaW46MDtwYWRkaW5nOjA7Ym94LXNpemluZzpib3JkZXItYm94Oy13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvcjp0cmFuc3BhcmVudH0KICAgIGh0bWwsYm9keXtoZWlnaHQ6MTAwJTtvdmVyZmxvdzpoaWRkZW47YmFja2dyb3VuZDojMDAwO2ZvbnQtZmFtaWx5Oi1hcHBsZS1zeXN0ZW0sQmxpbmtNYWNTeXN0ZW1Gb250LHN5c3RlbS11aSxzYW5zLXNlcmlmfQogICAgYm9keXtwb3NpdGlvbjpmaXhlZDtpbnNldDowfQogICAgOnJvb3R7CiAgICAgIC0tYmcxOiMwNTA1MGM7CiAgICAgIC0tYmcyOiMxMzBhMmE7CiAgICAgIC0tZ2xhc3M6cmdiYSgyNTUsMjU1LDI1NSwuMDgpOwogICAgICAtLWdsYXNzMjpyZ2JhKDI1NSwyNTUsMjU1LC4xMik7CiAgICAgIC0taGl0WTo3OHB4OwogICAgfQoKICAgIC52aHsKICAgICAgcG9zaXRpb246Zml4ZWQ7IGluc2V0OjA7CiAgICAgIGRpc3BsYXk6ZmxleDsgZmxleC1kaXJlY3Rpb246Y29sdW1uOwogICAgICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQoMTIwMHB4IDgwMHB4IGF0IDUwJSAyMCUsIHJnYmEoMTEwLDgwLDI1NSwuMjIpLCB0cmFuc3BhcmVudCA2MCUpLAogICAgICAgICAgICAgICAgICByYWRpYWwtZ3JhZGllbnQoOTAwcHggNzAwcHggYXQgMjAlIDgwJSwgcmdiYSgwLDI1NSwyMTAsLjEwKSwgdHJhbnNwYXJlbnQgNjAlKSwKICAgICAgICAgICAgICAgICAgbGluZWFyLWdyYWRpZW50KDE4MGRlZywgdmFyKC0tYmcxKSwgdmFyKC0tYmcyKSk7CiAgICAgIGNvbG9yOiNmZmY7CiAgICB9CgogICAgLyogSFVEICovCiAgICAuaHVkewogICAgICBwb3NpdGlvbjpyZWxhdGl2ZTsKICAgICAgZGlzcGxheTpmbGV4OwogICAgICBhbGlnbi1pdGVtczpmbGV4LXN0YXJ0OwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjsKICAgICAgcGFkZGluZzogbWF4KDE2cHgsIGVudihzYWZlLWFyZWEtaW5zZXQtdG9wLCAwcHgpKSAxNnB4IDEwcHg7CiAgICAgIHotaW5kZXg6NTA7CiAgICAgIHBvaW50ZXItZXZlbnRzOm5vbmU7CiAgICB9CiAgICAucGlsbHsKICAgICAgcG9pbnRlci1ldmVudHM6bm9uZTsKICAgICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwuNDUpOwogICAgICBib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjEyKTsKICAgICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOwogICAgICBib3JkZXItcmFkaXVzOiA5OTlweDsKICAgICAgcGFkZGluZzogOHB4IDEycHg7CiAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAyNXB4IHJnYmEoMCwwLDAsLjM1KTsKICAgICAgZGlzcGxheTpmbGV4OwogICAgICBnYXA6MTBweDsKICAgICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgfQogICAgLnNjb3JlTnVte2ZvbnQtc2l6ZToyMnB4O2ZvbnQtd2VpZ2h0OjcwMDtsZXR0ZXItc3BhY2luZzouNXB4fQogICAgLnNtYWxse2ZvbnQtc2l6ZToxMnB4O29wYWNpdHk6Ljc1fQogICAgLnBpdGNoVGV4dHtmb250LXZhcmlhbnQtbnVtZXJpYzogdGFidWxhci1udW1zOyBmb250LXNpemU6MTJweDsgb3BhY2l0eTouODU7IG1heC13aWR0aDo0OHZ3OyB0ZXh0LWFsaWduOnJpZ2h0fQoKICAgIC8qIEFyZW5hICovCiAgICAuYXJlbmFXcmFwewogICAgICBwb3NpdGlvbjpyZWxhdGl2ZTsKICAgICAgZmxleDoxOwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjsKICAgICAgcGFkZGluZzogMCAxMHB4IDhweDsKICAgIH0KCiAgICAuYXJlbmF7CiAgICAgIHBvc2l0aW9uOnJlbGF0aXZlOwogICAgICB3aWR0aDptaW4oNTYwcHgsIDk0dncpOwogICAgICBoZWlnaHQ6bWluKDgydmgsIDY4MHB4KTsKICAgICAgYm9yZGVyLXJhZGl1czogMjJweDsKICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDE4MGRlZywgcmdiYSgyNTUsMjU1LDI1NSwuMDYpLCByZ2JhKDI1NSwyNTUsMjU1LC4wMikpOwogICAgICBib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjEwKTsKICAgICAgYm94LXNoYWRvdzogMCAyMHB4IDYwcHggcmdiYSgwLDAsMCwuNDUpOwogICAgICBvdmVyZmxvdzpoaWRkZW47CiAgICAgIHRyYW5zZm9ybTogcGVyc3BlY3RpdmUoOTAwcHgpIHJvdGF0ZVgoMTRkZWcpOwogICAgICB0cmFuc2Zvcm0tb3JpZ2luOiA1MCUgNjAlOwogICAgfQoKICAgIC5sYW5lc3sKICAgICAgcG9zaXRpb246YWJzb2x1dGU7IGluc2V0OjA7CiAgICAgIGRpc3BsYXk6ZmxleDsKICAgICAgZ2FwOiA4cHg7CiAgICAgIHBhZGRpbmc6IDE4cHggMTZweCAxNnB4OwogICAgfQoKICAgIC5sYW5lewogICAgICBwb3NpdGlvbjpyZWxhdGl2ZTsKICAgICAgZmxleDoxOwogICAgICBib3JkZXItcmFkaXVzOiAxNnB4OwogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCByZ2JhKDAsMCwwLC4wKSwgcmdiYSgwLDAsMCwuMjApKTsKICAgICAgb3ZlcmZsb3c6aGlkZGVuOwogICAgICAtLWxhbmVDb2xvcjogcmdiYSgyNTUsMjU1LDI1NSwuNyk7CiAgICAgIC0tcG93ZXI6IDA7CiAgICAgIC0tdmliZTogMHB4OwogICAgfQoKICAgIC5sYW5lOjpiZWZvcmV7CiAgICAgIGNvbnRlbnQ6Jyc7CiAgICAgIHBvc2l0aW9uOmFic29sdXRlOyBpbnNldDowOwogICAgICBiYWNrZ3JvdW5kOgogICAgICAgIHJhZGlhbC1ncmFkaWVudCg2MDBweCA0MjBweCBhdCA1MCUgNSUsIHJnYmEoMjU1LDI1NSwyNTUsLjA4KSwgdHJhbnNwYXJlbnQgNjAlKSwKICAgICAgICByYWRpYWwtZ3JhZGllbnQoNzAwcHggNDAwcHggYXQgNTAlIDEwMCUsIHJnYmEoMCwwLDAsLjM1KSwgdHJhbnNwYXJlbnQgNjAlKTsKICAgICAgcG9pbnRlci1ldmVudHM6bm9uZTsKICAgICAgb3BhY2l0eTouODsKICAgIH0KCiAgICAuc3RyaW5newogICAgICBwb3NpdGlvbjphYnNvbHV0ZTsKICAgICAgdG9wOiAxMnB4OwogICAgICBib3R0b206IGNhbGModmFyKC0taGl0WSkgKyAxMHB4KTsKICAgICAgbGVmdDogNTAlOwogICAgICB3aWR0aDogNHB4OwogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxODBkZWcsIHRyYW5zcGFyZW50LCB2YXIoLS1sYW5lQ29sb3IpIDIyJSwgdmFyKC0tbGFuZUNvbG9yKSA3OCUsIHRyYW5zcGFyZW50KTsKICAgICAgb3BhY2l0eTogLjM1OwogICAgICBib3JkZXItcmFkaXVzOiA5OTlweDsKICAgICAgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgMTBweCByZ2JhKDAsMCwwLC41KSk7CiAgICB9CgogICAgLmxhbmUuYWN0aXZlIC5zdHJpbmd7CiAgICAgIG9wYWNpdHk6IC44NTsKICAgICAgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgMThweCBjb2xvci1taXgoaW4gc3JnYiwgdmFyKC0tbGFuZUNvbG9yKSA4MCUsIHRyYW5zcGFyZW50KSk7CiAgICAgIGFuaW1hdGlvbjogc3RyaW5nVmliZSAuMTJzIGxpbmVhciBpbmZpbml0ZTsKICAgIH0KCiAgICBAa2V5ZnJhbWVzIHN0cmluZ1ZpYmV7CiAgICAgIDAleyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoY2FsYygtNTAlICsgdmFyKC0tdmliZSkpKTsgfQoKICAgIC5jdXJzb3J7CiAgICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgICBsZWZ0OjUwJTsKICAgICAgd2lkdGg6IDE0cHg7CiAgICAgIGhlaWdodDogMTRweDsKICAgICAgYm9yZGVyLXJhZGl1czo5OTlweDsKICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwtNTAlKTsKICAgICAgYmFja2dyb3VuZDogY29sb3ItbWl4KGluIHNyZ2IsIHZhcigtLWxhbmVDb2xvcikgOTAlLCB3aGl0ZSAxMCUpOwogICAgICBib3gtc2hhZG93OiAwIDAgMThweCBjb2xvci1taXgoaW4gc3JnYiwgdmFyKC0tbGFuZUNvbG9yKSA3NSUsIHRyYW5zcGFyZW50KTsKICAgICAgb3BhY2l0eTogMDsKICAgICAgdHJhbnNpdGlvbjogb3BhY2l0eSAuMTJzIGVhc2U7CiAgICAgIHBvaW50ZXItZXZlbnRzOm5vbmU7CiAgICAgIHotaW5kZXg6NjsKICAgIH0KICAgIC5sYW5lLmFjdGl2ZSAuY3Vyc29yeyBvcGFjaXR5OiAuOTU7IH0KCiAgICAgIDUwJXsgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKGNhbGMoLTUwJSAtIHZhcigtLXZpYmUpKSk7IH0KICAgICAgMTAwJXsgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKGNhbGMoLTUwJSArIHZhcigtLXZpYmUpKSk7IH0KICAgIH0KCiAgICAvKiBPY3RhdmUgbGV2ZWwgbWFya2VycyAqLwogICAgLm9jdGF2ZXN7CiAgICAgIHBvc2l0aW9uOmFic29sdXRlOyBsZWZ0OjA7IHJpZ2h0OjA7CiAgICAgIHRvcDogMjJweDsKICAgICAgYm90dG9tOiBjYWxjKHZhcigtLWhpdFkpICsgMjBweCk7CiAgICAgIHBvaW50ZXItZXZlbnRzOm5vbmU7CiAgICB9CiAgICAub2N0ewogICAgICBwb3NpdGlvbjphYnNvbHV0ZTsgbGVmdDoxMCU7IHJpZ2h0OjEwJTsKICAgICAgaGVpZ2h0OiAycHg7CiAgICAgIGJvcmRlci1yYWRpdXM6OTk5cHg7CiAgICAgIG9wYWNpdHk6LjI1OwogICAgICBiYWNrZ3JvdW5kOiBjb2xvci1taXgoaW4gc3JnYiwgdmFyKC0tbGFuZUNvbG9yKSA0NSUsIHRyYW5zcGFyZW50KTsKICAgIH0KICAgIC5vY3QuYWN0aXZlewogICAgICBvcGFjaXR5Oi45OwogICAgICBib3gtc2hhZG93OiAwIDAgMTRweCBjb2xvci1taXgoaW4gc3JnYiwgdmFyKC0tbGFuZUNvbG9yKSA3MCUsIHRyYW5zcGFyZW50KTsKICAgICAgYmFja2dyb3VuZDogY29sb3ItbWl4KGluIHNyZ2IsIHZhcigtLWxhbmVDb2xvcikgODUlLCB3aGl0ZSAxNSUpOwogICAgfQogICAgLm9jdExhYmVsewogICAgICBwb3NpdGlvbjphYnNvbHV0ZTsKICAgICAgbGVmdDogMTBweDsKICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOwogICAgICBmb250LXNpemU6IDEwcHg7CiAgICAgIG9wYWNpdHk6LjU1OwogICAgICB3aGl0ZS1zcGFjZTpub3dyYXA7CiAgICAgIHRleHQtc2hhZG93OjAgMCAxMHB4IHJnYmEoMCwwLDAsLjcpOwogICAgfQoKICAgIC8qIEhpdCB6b25lICovCiAgICAuaGl0Wm9uZXsKICAgICAgcG9zaXRpb246YWJzb2x1dGU7CiAgICAgIGxlZnQ6IDUwJTsKICAgICAgYm90dG9tOiAxOHB4OwogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgIHdpZHRoOiA1MnB4OwogICAgICBoZWlnaHQ6IDUycHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDk5OXB4OwogICAgICBib3JkZXI6IDNweCBzb2xpZCBjb2xvci1taXgoaW4gc3JnYiwgdmFyKC0tbGFuZUNvbG9yKSA3MCUsIHRyYW5zcGFyZW50KTsKICAgICAgYm94LXNoYWRvdzogMCAwIDE4cHggcmdiYSgwLDAsMCwuNDUpOwogICAgICBvcGFjaXR5Oi43MDsKICAgICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwuMjApOwogICAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoNnB4KTsKICAgIH0KICAgIC5oaXRab25lLmZsYXNoewogICAgICBvcGFjaXR5OjE7CiAgICAgIGJveC1zaGFkb3c6IDAgMCAyNnB4IGNvbG9yLW1peChpbiBzcmdiLCB2YXIoLS1sYW5lQ29sb3IpIDg1JSwgdHJhbnNwYXJlbnQpLAogICAgICAgICAgICAgICAgICAwIDAgNjBweCBjb2xvci1taXgoaW4gc3JnYiwgdmFyKC0tbGFuZUNvbG9yKSAzNSUsIHRyYW5zcGFyZW50KTsKICAgICAgYm9yZGVyLWNvbG9yOiBjb2xvci1taXgoaW4gc3JnYiwgdmFyKC0tbGFuZUNvbG9yKSA5MCUsIHdoaXRlIDEwJSk7CiAgICB9CgogICAgLmxhbmVOYW1lewogICAgICBwb3NpdGlvbjphYnNvbHV0ZTsKICAgICAgdG9wOiAxMHB4OyBsZWZ0OiA1MCU7CiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICBmb250LXdlaWdodDogNzAwOwogICAgICBsZXR0ZXItc3BhY2luZzogLjZweDsKICAgICAgb3BhY2l0eTouODU7CiAgICAgIHRleHQtc2hhZG93OiAwIDAgMTRweCByZ2JhKDAsMCwwLC43KTsKICAgICAgY29sb3I6IGNvbG9yLW1peChpbiBzcmdiLCB2YXIoLS1sYW5lQ29sb3IpIDg1JSwgd2hpdGUgMTUlKTsKICAgICAgei1pbmRleDo1OwogICAgICBwb2ludGVyLWV2ZW50czpub25lOwogICAgfQoKICAgIC8qIEZhbGxpbmcgbm90ZSAqLwogICAgLm5vdGV7CiAgICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgICBsZWZ0OiA1MCU7CiAgICAgIHRvcDogLTY0cHg7CiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIDApOwogICAgICB3aWR0aDogNDRweDsKICAgICAgaGVpZ2h0OiA0NHB4OwogICAgICBib3JkZXItcmFkaXVzOiA5OTlweDsKICAgICAgYmFja2dyb3VuZDogY29sb3ItbWl4KGluIHNyZ2IsIHZhcigtLWxhbmVDb2xvcikgOTAlLCByZ2JhKDI1NSwyNTUsMjU1LC4xMCkpOwogICAgICBib3JkZXI6IDNweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LC44NSk7CiAgICAgIGJveC1zaGFkb3c6IDAgMCAxOHB4IGNvbG9yLW1peChpbiBzcmdiLCB2YXIoLS1sYW5lQ29sb3IpIDc1JSwgdHJhbnNwYXJlbnQpOwogICAgICBwb2ludGVyLWV2ZW50czpub25lOwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjsKICAgICAgZm9udC1zaXplOiAxMXB4OwogICAgICBmb250LXdlaWdodDogODAwOwogICAgICB0ZXh0LXNoYWRvdzogMCAwIDEwcHggcmdiYSgwLDAsMCwuNTUpOwogICAgfQoKICAgIC5ub3RlLmdvb2R7CiAgICAgIGFuaW1hdGlvbjogcG9wIC4xOHMgZWFzZS1vdXQ7CiAgICB9CiAgICBAa2V5ZnJhbWVzIHBvcHsKICAgICAgMCV7dHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgMCkgc2NhbGUoMSl9CiAgICAgIDEwMCV7dHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgMCkgc2NhbGUoMS4yNSl9CiAgICB9CgogICAgLmJ1cnN0ewogICAgICBwb3NpdGlvbjphYnNvbHV0ZTsKICAgICAgbGVmdDo1MCU7CiAgICAgIGJvdHRvbTogNDRweDsKICAgICAgd2lkdGg6IDEwcHg7IGhlaWdodDoxMHB4OwogICAgICBib3JkZXItcmFkaXVzOjk5OXB4OwogICAgICBwb2ludGVyLWV2ZW50czpub25lOwogICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1sYW5lQ29sb3IpOwogICAgICBvcGFjaXR5Oi45OwogICAgICBhbmltYXRpb246IGJ1cnN0IC41NXMgZWFzZS1vdXQgZm9yd2FyZHM7CiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIDApOwogICAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCAxOHB4IGNvbG9yLW1peChpbiBzcmdiLCB2YXIoLS1sYW5lQ29sb3IpIDcwJSwgdHJhbnNwYXJlbnQpKTsKICAgIH0KICAgIEBrZXlmcmFtZXMgYnVyc3R7CiAgICAgIDAle29wYWNpdHk6Ljk7IHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIDApIHNjYWxlKDEpfQogICAgICAxMDAle29wYWNpdHk6MDsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoY2FsYygtNTAlICsgdmFyKC0tYngpKSwgY2FsYyh2YXIoLS1ieSkpKSBzY2FsZSgwKX0KICAgIH0KCiAgICAvKiBCb3R0b20gY29udHJvbHMgKi8KICAgIC5jb250cm9sc3sKICAgICAgcG9zaXRpb246cmVsYXRpdmU7CiAgICAgIHBhZGRpbmc6IDEwcHggMTZweCBtYXgoMTZweCwgZW52KHNhZmUtYXJlYS1pbnNldC1ib3R0b20sIDBweCkpOwogICAgICBkaXNwbGF5OmZsZXg7CiAgICAgIGdhcDogMTJweDsKICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjsKICAgICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgICB6LWluZGV4OjYwOwogICAgfQogICAgLmN0cmx7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsLjQ1KTsKICAgICAgYm9yZGVyOjFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LC4xMik7CiAgICAgIGJvcmRlci1yYWRpdXM6IDE4cHg7CiAgICAgIHBhZGRpbmc6IDEwcHggMTJweDsKICAgICAgZGlzcGxheTpmbGV4OwogICAgICBhbGlnbi1pdGVtczpjZW50ZXI7CiAgICAgIGdhcDoxMHB4OwogICAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTBweCk7CiAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAyNXB4IHJnYmEoMCwwLDAsLjM1KTsKICAgICAgbWluLXdpZHRoOiAxNTBweDsKICAgIH0KICAgIC5jdHJsIGxhYmVse2ZvbnQtc2l6ZToxMnB4O29wYWNpdHk6Ljc1O3doaXRlLXNwYWNlOm5vd3JhcH0KICAgIGlucHV0W3R5cGU9InJhbmdlIl17d2lkdGg6IDkycHg7fQoKICAgIC8qIFN0YXJ0IG92ZXJsYXkgKi8KICAgIC5vdmVybGF5ewogICAgICBwb3NpdGlvbjpmaXhlZDsgaW5zZXQ6MDsKICAgICAgZGlzcGxheTpmbGV4OwogICAgICBhbGlnbi1pdGVtczpjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDpjZW50ZXI7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsLjgyKTsKICAgICAgei1pbmRleDoxMDAwOwogICAgICBwYWRkaW5nOiAyMHB4OwogICAgfQogICAgLmNhcmR7CiAgICAgIHdpZHRoOiBtaW4oNTIwcHgsIDkydncpOwogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCByZ2JhKDI1NSwyNTUsMjU1LC4xMCksIHJnYmEoMjU1LDI1NSwyNTUsLjA2KSk7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjE0KTsKICAgICAgYm9yZGVyLXJhZGl1czogMjJweDsKICAgICAgcGFkZGluZzogMThweCAxOHB4IDE2cHg7CiAgICAgIGJveC1zaGFkb3c6IDAgMjBweCA2MHB4IHJnYmEoMCwwLDAsLjU1KTsKICAgICAgdGV4dC1hbGlnbjpjZW50ZXI7CiAgICB9CiAgICAuY2FyZCBoMXsKICAgICAgZm9udC1zaXplOiAyMnB4OwogICAgICBtYXJnaW4tYm90dG9tOiA4cHg7CiAgICAgIGxldHRlci1zcGFjaW5nOi4zcHg7CiAgICB9CiAgICAuY2FyZCBwewogICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgIG9wYWNpdHk6Ljg1OwogICAgICBsaW5lLWhlaWdodDoxLjU7CiAgICAgIG1hcmdpbi1ib3R0b206IDE0cHg7CiAgICB9CiAgICAuc3RhcnRCdG57CiAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICM2NjdlZWEsICM3NjRiYTIpOwogICAgICBib3JkZXI6bm9uZTsKICAgICAgY29sb3I6I2ZmZjsKICAgICAgZm9udC13ZWlnaHQ6ODAwOwogICAgICBib3JkZXItcmFkaXVzOiA5OTlweDsKICAgICAgcGFkZGluZzogMTRweCAyMnB4OwogICAgICBmb250LXNpemU6IDE2cHg7CiAgICAgIGJveC1zaGFkb3c6IDAgMTRweCAzNXB4IHJnYmEoMTAyLDEyNiwyMzQsLjM1KTsKICAgICAgY3Vyc29yOnBvaW50ZXI7CiAgICB9CiAgICAuaGludHttYXJnaW4tdG9wOjEycHg7Zm9udC1zaXplOjEycHg7b3BhY2l0eTouNzI7bGluZS1oZWlnaHQ6MS40fQoKICAgIC8qIEFjY2Vzc2liaWxpdHk6IHJlZHVjZSBtb3Rpb24gKi8KICAgIEBtZWRpYSAocHJlZmVycy1yZWR1Y2VkLW1vdGlvbjogcmVkdWNlKXsKICAgICAgLmxhbmUuYWN0aXZlIC5zdHJpbmd7IGFuaW1hdGlvbjpub25lOyB9CiAgICAgIC5ub3RlLmdvb2R7IGFuaW1hdGlvbjpub25lOyB9CiAgICB9CiAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KICA8ZGl2IGNsYXNzPSJ2aCI+CiAgICA8ZGl2IGNsYXNzPSJodWQiPgogICAgICA8ZGl2IGNsYXNzPSJwaWxsIj4KICAgICAgICA8ZGl2IGNsYXNzPSJzbWFsbCI+UHVua3R5PC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ic2NvcmVOdW0iIGlkPSJzY29yZSI+MDwvZGl2PgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0icGlsbCIgc3R5bGU9Im1heC13aWR0aDo1MnZ3OyBqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmQ7Ij4KICAgICAgICA8ZGl2IGNsYXNzPSJwaXRjaFRleHQiIGlkPSJwaXRjaFJlYWRvdXQiPuKAlDwvZGl2PgogICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImFyZW5hV3JhcCI+CiAgICAgIDxkaXYgY2xhc3M9ImFyZW5hIiBpZD0iYXJlbmEiPgogICAgICAgIDxkaXYgY2xhc3M9ImxhbmVzIiBpZD0ibGFuZXMiPjwvZGl2PgogICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImNvbnRyb2xzIj4KICAgICAgPGRpdiBjbGFzcz0iY3RybCI+CiAgICAgICAgPGxhYmVsIGZvcj0ic3BlZWQiPlRlbXBvPC9sYWJlbD4KICAgICAgICA8aW5wdXQgaWQ9InNwZWVkIiB0eXBlPSJyYW5nZSIgbWluPSIxIiBtYXg9IjEwIiB2YWx1ZT0iNiIgLz4KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9ImN0cmwiPgogICAgICAgIDxsYWJlbCBmb3I9InNlbnMiPkN6dcWCb8WbxIc8L2xhYmVsPgogICAgICAgIDxpbnB1dCBpZD0ic2VucyIgdHlwZT0icmFuZ2UiIG1pbj0iMSIgbWF4PSIxMCIgdmFsdWU9IjYiIC8+CiAgICAgIDwvZGl2PgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0ib3ZlcmxheSIgaWQ9Im92ZXJsYXkiPgogICAgICA8ZGl2IGNsYXNzPSJjYXJkIj4KICAgICAgICA8aDE+8J+OuCBWb2NhbCBIZXJvPC9oMT4KICAgICAgICA8cD5OdXRraSBzcGFkYWrEhSBwbyA2IHN0cnVuYWNoLiBaYcWbcGlld2FqIHfFgmHFm2Npd3kgZMW6d2nEmWssIGdkeSBudXRrYSBkb3RrbmllIGvDs8WCa2EgbmEgZG9sZS48L3A+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0ic3RhcnRCdG4iIGlkPSJzdGFydEJ0biI+U3RhcnQ8L2J1dHRvbj4KICAgICAgICA8ZGl2IGNsYXNzPSJoaW50Ij5HZHkgcHJ6ZWdsxIVkYXJrYSB6YXB5dGEgbyBtaWtyb2ZvbiDigJQga2xpa25paiA8c3Ryb25nPlplenfDs2w8L3N0cm9uZz4uPGJyLz5UaXA6IGfFgm/Fm25pZWogPSBtb2NuaWVqc3phIGFuaW1hY2phIHN0cnVueS48L2Rpdj4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICA8L2Rpdj4KCiAgPHNjcmlwdD4KICAgIC8vID09PT09PSBDb25maWcgPT09PT09CiAgICBjb25zdCBMQU5FX05PVEVTID0gWwogICAgICB7IG5hbWU6ICdDJywgcGM6IDAsICBjb2xvcjogJ3JnYmEoMjU1LCA5MiwgOTIsIDEpJyAgIH0sCiAgICAgIHsgbmFtZTogJ0QnLCBwYzogMiwgIGNvbG9yOiAncmdiYSgyNTUsIDE4NywgNzcsIDEpJyAgfSwKICAgICAgeyBuYW1lOiAnRScsIHBjOiA0LCAgY29sb3I6ICdyZ2JhKDI1NSwgMjQ1LCAxMDYsIDEpJyB9LAogICAgICB7IG5hbWU6ICdGJywgcGM6IDUsICBjb2xvcjogJ3JnYmEoMTI0LCAyNTUsIDE3OCwgMSknIH0sCiAgICAgIHsgbmFtZTogJ0cnLCBwYzogNywgIGNvbG9yOiAncmdiYSg4OCwgMTkxLCAyNTUsIDEpJyAgfSwKICAgICAgeyBuYW1lOiAnQScsIHBjOiA5LCAgY29sb3I6ICdyZ2JhKDE5OCwgMTMyLCAyNTUsIDEpJyB9CiAgICBdOwoKICAgIGNvbnN0IE9DVF9NSU4gPSAyOyAgICAgICAgICAgICAgIC8vIGxldmVscyBzaG93bgogICAgY29uc3QgT0NUX01BWCA9IDU7CiAgICBjb25zdCBPQ1RBVkVTID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiAoT0NUX01BWCAtIE9DVF9NSU4gKyAxKX0sIChfLGkpPT5PQ1RfTUlOK2kpOwoKICAgIGNvbnN0IEhJVF9XSU5ET1dfUFggPSAyNjsKICAgIGNvbnN0IEJBU0VfVE9MRVJBTkNFX0NFTlRTID0gMzU7CgogICAgLy8gVGVtcG86IHNsaWRlciAxLi4xMCA9PiBzcGF3biBldmVyeSAxMTUwLi41MjBtcyBhbmQgZmFsbCBzcGVlZCAyNjAuLjUyMCBweC9zCiAgICBmdW5jdGlvbiB0ZW1wb1RvU3Bhd25Ncyh2KXsKICAgICAgcmV0dXJuIE1hdGgucm91bmQoMTI1MCAtIHYgKiA3NSk7CiAgICB9CiAgICBmdW5jdGlvbiB0ZW1wb1RvRmFsbFNwZWVkKHYpewogICAgICByZXR1cm4gMjIwICsgdiAqIDM2OwogICAgfQoKICAgIC8vIFNlbnNpdGl2aXR5OiBzbGlkZXIgMS4uMTAgPT4gUk1TIHRocmVzaG9sZCAwLjA2Li4wLjAxNQogICAgZnVuY3Rpb24gc2Vuc1RvUm1zVGhyZXNob2xkKHYpewogICAgICByZXR1cm4gMC4wNyAtIHYgKiAwLjAwNTU7CiAgICB9CgogICAgLy8gPT09PT09IEVsZW1lbnRzID09PT09PQogICAgY29uc3QgbGFuZXNFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsYW5lcycpOwogICAgY29uc3QgYXJlbmFFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcmVuYScpOwogICAgY29uc3Qgb3ZlcmxheUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXknKTsKICAgIGNvbnN0IHN0YXJ0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXJ0QnRuJyk7CiAgICBjb25zdCBzY29yZUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Njb3JlJyk7CiAgICBjb25zdCBwaXRjaFJlYWRvdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGl0Y2hSZWFkb3V0Jyk7CiAgICBjb25zdCBzcGVlZEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NwZWVkJyk7CiAgICBjb25zdCBzZW5zRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VucycpOwoKICAgIGNvbnN0IGxhbmVFbHMgPSBbXTsKICAgIGNvbnN0IGhpdEVscyA9IFtdOwogICAgY29uc3Qgb2N0YXZlTWFya3MgPSBbXTsgLy8gb2N0YXZlTWFya3NbbGFuZV1bb2N0SWR4XSA9PiBlbAogICAgY29uc3QgY3Vyc29yRWxzID0gW107CgogICAgZnVuY3Rpb24gYnVpbGRMYW5lcygpewogICAgICBsYW5lc0VsLmlubmVySFRNTCA9ICcnOwogICAgICBMQU5FX05PVEVTLmZvckVhY2goKGxuLCBpKSA9PiB7CiAgICAgICAgY29uc3QgbGFuZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIGxhbmUuY2xhc3NOYW1lID0gJ2xhbmUnOwogICAgICAgIGxhbmUuc3R5bGUuc2V0UHJvcGVydHkoJy0tbGFuZUNvbG9yJywgbG4uY29sb3IpOwoKICAgICAgICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgbmFtZS5jbGFzc05hbWUgPSAnbGFuZU5hbWUnOwogICAgICAgIG5hbWUudGV4dENvbnRlbnQgPSBsbi5uYW1lOwoKICAgICAgICBjb25zdCBzdHJpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBzdHJpbmcuY2xhc3NOYW1lID0gJ3N0cmluZyc7CgogICAgICAgIGNvbnN0IGN1cnNvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIGN1cnNvci5jbGFzc05hbWUgPSAnY3Vyc29yJzsKCiAgICAgICAgY29uc3Qgb2N0YXZlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIG9jdGF2ZXMuY2xhc3NOYW1lID0gJ29jdGF2ZXMnOwoKICAgICAgICBjb25zdCBtYXJrcyA9IFtdOwogICAgICAgIC8vIHBsYWNlIG9jdGF2ZSBtYXJrZXJzIChoaWdoZXIgb2N0YXZlID0gaGlnaGVyIG1hcmtlcikKICAgICAgICBPQ1RBVkVTLmZvckVhY2goKG9jdCwgaWR4KSA9PiB7CiAgICAgICAgICBjb25zdCBtYXJrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICBtYXJrLmNsYXNzTmFtZSA9ICdvY3QnOwogICAgICAgICAgY29uc3QgdCA9IGlkeCAvIChPQ1RBVkVTLmxlbmd0aCAtIDEgfHwgMSk7CiAgICAgICAgICAvLyBtYXAgMC4uMSB0byAxMCUuLjkwJSAoYm90dG9tLT50b3ApCiAgICAgICAgICBjb25zdCB5ID0gKDkwIC0gdCAqIDgwKTsKICAgICAgICAgIG1hcmsuc3R5bGUudG9wID0geSArICclJzsKICAgICAgICAgIG1hcmsuZGF0YXNldC55ID0gU3RyaW5nKHkpOwoKICAgICAgICAgIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICBsYWJlbC5jbGFzc05hbWUgPSAnb2N0TGFiZWwnOwogICAgICAgICAgbGFiZWwuc3R5bGUudG9wID0geSArICclJzsKICAgICAgICAgIGxhYmVsLnRleHRDb250ZW50ID0gJ08nICsgb2N0OwoKICAgICAgICAgIG9jdGF2ZXMuYXBwZW5kQ2hpbGQobWFyayk7CiAgICAgICAgICBvY3RhdmVzLmFwcGVuZENoaWxkKGxhYmVsKTsKICAgICAgICAgIG1hcmtzLnB1c2gobWFyayk7CiAgICAgICAgfSk7CgogICAgICAgIGNvbnN0IGhpdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIGhpdC5jbGFzc05hbWUgPSAnaGl0Wm9uZSc7CgogICAgICAgIGxhbmUuYXBwZW5kQ2hpbGQoc3RyaW5nKTsKICAgICAgICBsYW5lLmFwcGVuZENoaWxkKGN1cnNvcik7CiAgICAgICAgbGFuZS5hcHBlbmRDaGlsZChvY3RhdmVzKTsKICAgICAgICBsYW5lLmFwcGVuZENoaWxkKG5hbWUpOwogICAgICAgIGxhbmUuYXBwZW5kQ2hpbGQoaGl0KTsKICAgICAgICBsYW5lc0VsLmFwcGVuZENoaWxkKGxhbmUpOwoKICAgICAgICBsYW5lRWxzLnB1c2gobGFuZSk7CiAgICAgICAgaGl0RWxzLnB1c2goaGl0KTsKICAgICAgICBvY3RhdmVNYXJrcy5wdXNoKG1hcmtzKTsKICAgICAgICBjdXJzb3JFbHMucHVzaChjdXJzb3IpOwogICAgICB9KTsKICAgIH0KCiAgICAvLyA9PT09PT0gQXVkaW8gKHBpdGNoIGRldGVjdGlvbikgPT09PT09CiAgICBjb25zdCBBdWRpb0NvbnRleHQgPSB3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQ7CiAgICBsZXQgYXVkaW9DdHggPSBudWxsOwogICAgbGV0IGFuYWx5c2VyID0gbnVsbDsKICAgIGxldCBtaWNTb3VyY2UgPSBudWxsOwogICAgbGV0IGlzUnVubmluZyA9IGZhbHNlOwogICAgbGV0IGJ1ZiA9IG51bGw7CgogICAgZnVuY3Rpb24gcm1zT2ZGbG9hdDMyKGFycil7CiAgICAgIGxldCBzdW0gPSAwOwogICAgICBmb3IgKGxldCBpPTA7aTxhcnIubGVuZ3RoO2krKyl7CiAgICAgICAgY29uc3QgdiA9IGFycltpXTsKICAgICAgICBzdW0gKz0gdip2OwogICAgICB9CiAgICAgIHJldHVybiBNYXRoLnNxcnQoc3VtIC8gYXJyLmxlbmd0aCk7CiAgICB9CgogICAgLy8gQmFzaWMgYXV0b2NvcnJlbGF0aW9uIHBpdGNoIGRldGVjdG9yIChmYXN0LCBnb29kIGVub3VnaCBmb3Igdm9pY2UpLgogICAgLy8gUmV0dXJucyBmcmVxdWVuY3kgaW4gSHosIG9yIC0xIGlmIG5vdCBjb25maWRlbnQuCiAgICBmdW5jdGlvbiBhdXRvQ29ycmVsYXRlKHRpbWVEb21haW4sIHNhbXBsZVJhdGUpewogICAgICAvLyBGaW5kIFJNUyBmaXJzdAogICAgICBjb25zdCBybXMgPSBybXNPZkZsb2F0MzIodGltZURvbWFpbik7CiAgICAgIGlmIChybXMgPCAwLjAwOCkgcmV0dXJuIC0xOwoKICAgICAgY29uc3QgU0laRSA9IHRpbWVEb21haW4ubGVuZ3RoOwogICAgICBsZXQgcjEgPSAwLCByMiA9IFNJWkUgLSAxOwogICAgICAvLyBUcmltIGVkZ2VzIHdoZXJlIHNpZ25hbCBpcyB2ZXJ5IHNtYWxsIHRvIGltcHJvdmUgYWNjdXJhY3kKICAgICAgY29uc3QgVEhSRVNIID0gMC4yOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IFNJWkUvMjsgaSsrKXsKICAgICAgICBpZiAoTWF0aC5hYnModGltZURvbWFpbltpXSkgPCBUSFJFU0gpIHsgcjEgPSBpOyBicmVhazsgfQogICAgICB9CiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgU0laRS8yOyBpKyspewogICAgICAgIGlmIChNYXRoLmFicyh0aW1lRG9tYWluW1NJWkUgLSBpXSkgPCBUSFJFU0gpIHsgcjIgPSBTSVpFIC0gaTsgYnJlYWs7IH0KICAgICAgfQogICAgICBjb25zdCB0cmltbWVkID0gdGltZURvbWFpbi5zbGljZShyMSwgcjIpOwogICAgICBjb25zdCBsZW4gPSB0cmltbWVkLmxlbmd0aDsKICAgICAgaWYgKGxlbiA8IDY0KSByZXR1cm4gLTE7CgogICAgICBjb25zdCBjID0gbmV3IEFycmF5KGxlbikuZmlsbCgwKTsKICAgICAgZm9yIChsZXQgaT0wO2k8bGVuO2krKyl7CiAgICAgICAgZm9yIChsZXQgaj0wO2o8bGVuLWk7aisrKXsKICAgICAgICAgIGNbaV0gPSBjW2ldICsgdHJpbW1lZFtqXSp0cmltbWVkW2oraV07CiAgICAgICAgfQogICAgICB9CgogICAgICBsZXQgZCA9IDA7CiAgICAgIHdoaWxlIChkIDwgbGVuLTEgJiYgY1tkXSA+IGNbZCsxXSkgZCsrOwoKICAgICAgbGV0IG1heHZhbCA9IC0xLCBtYXhwb3MgPSAtMTsKICAgICAgZm9yIChsZXQgaT1kO2k8bGVuO2krKyl7CiAgICAgICAgaWYgKGNbaV0gPiBtYXh2YWwpeyBtYXh2YWwgPSBjW2ldOyBtYXhwb3MgPSBpOyB9CiAgICAgIH0KICAgICAgaWYgKG1heHBvcyA8PSAwKSByZXR1cm4gLTE7CgogICAgICAvLyBQYXJhYm9saWMgaW50ZXJwb2xhdGlvbiBmb3IgYmV0dGVyIHBlYWsgZXN0aW1hdGlvbgogICAgICBjb25zdCB4MSA9IGNbbWF4cG9zLTFdIHx8IDA7CiAgICAgIGNvbnN0IHgyID0gY1ttYXhwb3NdOwogICAgICBjb25zdCB4MyA9IGNbbWF4cG9zKzFdIHx8IDA7CiAgICAgIGNvbnN0IGEgPSAoeDEgKyB4MyAtIDIqeDIpIC8gMjsKICAgICAgY29uc3QgYiA9ICh4MyAtIHgxKSAvIDI7CiAgICAgIGNvbnN0IHNoaWZ0ID0gKGEgPyAtYiAvICgyKmEpIDogMCk7CiAgICAgIGNvbnN0IHBlcmlvZCA9IG1heHBvcyArIHNoaWZ0OwoKICAgICAgY29uc3QgZnJlcSA9IHNhbXBsZVJhdGUgLyBwZXJpb2Q7CiAgICAgIGlmICghaXNGaW5pdGUoZnJlcSkgfHwgZnJlcSA8IDcwIHx8IGZyZXEgPiAxMTAwKSByZXR1cm4gLTE7CiAgICAgIHJldHVybiBmcmVxOwogICAgfQoKICAgIGZ1bmN0aW9uIGh6VG9NaWRpKGh6KXsKICAgICAgcmV0dXJuIDY5ICsgMTIgKiBNYXRoLmxvZzIoaHogLyA0NDApOwogICAgfQoKICAgIGZ1bmN0aW9uIG1pZGlUb0h6KG1pZGkpewogICAgICByZXR1cm4gNDQwICogTWF0aC5wb3coMiwgKG1pZGkgLSA2OSkvMTIpOwogICAgfQoKICAgIGNvbnN0IE5PVEVfTkFNRVMgPSBbJ0MnLCdDIycsJ0QnLCdEIycsJ0UnLCdGJywnRiMnLCdHJywnRyMnLCdBJywnQSMnLCdCJ107CiAgICBmdW5jdGlvbiBtaWRpVG9OYW1lKG1pZGkpewogICAgICBjb25zdCBtID0gTWF0aC5yb3VuZChtaWRpKTsKICAgICAgY29uc3QgcGMgPSAoKG0gJSAxMikgKyAxMikgJSAxMjsKICAgICAgY29uc3Qgb2N0ID0gTWF0aC5mbG9vcihtLzEyKSAtIDE7CiAgICAgIHJldHVybiB7IG5hbWU6IE5PVEVfTkFNRVNbcGNdLCBvY3RhdmU6IG9jdCwgcGMgfTsKICAgIH0KCiAgICBmdW5jdGlvbiBjbG9zZXN0TGFuZU1pZGkobWlkaSl7CiAgICAgIC8vIEZpbmQgdGhlIGNsb3Nlc3QgbGFuZSBub3RlIChieSBzZW1pdG9uZSBkaXN0YW5jZSkgaW4gYSBuZWFyYnkgb2N0YXZlLgogICAgICBjb25zdCBtUm91bmRlZCA9IE1hdGgucm91bmQobWlkaSk7CiAgICAgIGNvbnN0IHsgb2N0YXZlIH0gPSBtaWRpVG9OYW1lKG1Sb3VuZGVkKTsKICAgICAgbGV0IGJlc3QgPSB7IGxhbmU6IDAsIG1pZGk6IDAsIGRpc3Q6IDk5OSB9OwogICAgICBmb3IgKGxldCBsYW5lPTA7IGxhbmU8TEFORV9OT1RFUy5sZW5ndGg7IGxhbmUrKyl7CiAgICAgICAgY29uc3QgcGMgPSBMQU5FX05PVEVTW2xhbmVdLnBjOwogICAgICAgIGZvciAobGV0IG8gPSBvY3RhdmUtMTsgbyA8PSBvY3RhdmUrMTsgbysrKXsKICAgICAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IDEyKihvKzEpICsgcGM7CiAgICAgICAgICBjb25zdCBkaXN0ID0gTWF0aC5hYnMoY2FuZGlkYXRlIC0gbWlkaSk7CiAgICAgICAgICBpZiAoZGlzdCA8IGJlc3QuZGlzdCl7CiAgICAgICAgICAgIGJlc3QgPSB7IGxhbmUsIG1pZGk6IGNhbmRpZGF0ZSwgZGlzdCB9OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gYmVzdDsgLy8ge2xhbmUsIG1pZGksIGRpc3R9CiAgICB9CgogICAgZnVuY3Rpb24gb2N0YXZlSW5kZXgob2N0KXsKICAgICAgY29uc3QgY2xhbXBlZCA9IE1hdGgubWF4KE9DVF9NSU4sIE1hdGgubWluKE9DVF9NQVgsIG9jdCkpOwogICAgICByZXR1cm4gY2xhbXBlZCAtIE9DVF9NSU47CiAgICB9CgogICAgLy8gPT09PT09IEdhbWUgbG9vcCA9PT09PT0KICAgIGxldCBub3RlcyA9IFtdOyAvLyB7ZWwsIGxhbmUsIG1pZGksIHl9CiAgICBsZXQgbGFzdFNwYXduID0gMDsKICAgIGxldCBsYXN0RnJhbWUgPSAwOwogICAgbGV0IHNjb3JlID0gMDsKCiAgICBsZXQgY3VycmVudFBpdGNoID0geyBoejogLTEsIG1pZGk6IC0xLCBybXM6IDAsIGxhbmU6IC0xLCBjZW50czogMCwgb2N0YXZlOiAwIH07CgogICAgZnVuY3Rpb24gc3Bhd25Ob3RlKCl7CiAgICAgIGNvbnN0IGxhbmUgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBMQU5FX05PVEVTLmxlbmd0aCk7CiAgICAgIC8vIHBpY2sgYW4gb2N0YXZlIHRoYXQgZXhpc3RzIG9uIHRoZSBncmlkCiAgICAgIGNvbnN0IG9jdGF2ZSA9IE9DVEFWRVNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKk9DVEFWRVMubGVuZ3RoKV07CiAgICAgIGNvbnN0IG1pZGkgPSAxMioob2N0YXZlKzEpICsgTEFORV9OT1RFU1tsYW5lXS5wYzsKCiAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgIGVsLmNsYXNzTmFtZSA9ICdub3RlJzsKICAgICAgZWwudGV4dENvbnRlbnQgPSBMQU5FX05PVEVTW2xhbmVdLm5hbWUgKyBvY3RhdmU7CiAgICAgIGVsLnN0eWxlLnNldFByb3BlcnR5KCctLWxhbmVDb2xvcicsIExBTkVfTk9URVNbbGFuZV0uY29sb3IpOwoKICAgICAgbGFuZUVsc1tsYW5lXS5hcHBlbmRDaGlsZChlbCk7CiAgICAgIG5vdGVzLnB1c2goeyBlbCwgbGFuZSwgbWlkaSwgeTogLTY0IH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGNsZWFyQWN0aXZlKCl7CiAgICAgIGxhbmVFbHMuZm9yRWFjaCgobGFuZUVsLCBpKSA9PiB7CiAgICAgICAgbGFuZUVsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwogICAgICAgIG9jdGF2ZU1hcmtzW2ldLmZvckVhY2gobSA9PiBtLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlUGl0Y2hVSSgpewogICAgICBpZiAoY3VycmVudFBpdGNoLmh6IDwgMCl7CiAgICAgICAgcGl0Y2hSZWFkb3V0LnRleHRDb250ZW50ID0gJ+KAlCc7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IG4gPSBtaWRpVG9OYW1lKGN1cnJlbnRQaXRjaC5taWRpKTsKICAgICAgY29uc3QgY2VudHMgPSBjdXJyZW50UGl0Y2guY2VudHM7CiAgICAgIGNvbnN0IHNpZ24gPSBjZW50cyA+PSAwID8gJysnIDogJyc7CiAgICAgIHBpdGNoUmVhZG91dC50ZXh0Q29udGVudCA9IGAke2N1cnJlbnRQaXRjaC5oei50b0ZpeGVkKDEpfSBIeiDigKIgJHtuLm5hbWV9JHtuLm9jdGF2ZX0g4oCiICR7c2lnbn0ke2NlbnRzLnRvRml4ZWQoMCl9wqJgOwogICAgfQoKICAgIGZ1bmN0aW9uIGZsYXNoSGl0KGxhbmUpewogICAgICBjb25zdCBoaXQgPSBoaXRFbHNbbGFuZV07CiAgICAgIGhpdC5jbGFzc0xpc3QuYWRkKCdmbGFzaCcpOwogICAgICBzZXRUaW1lb3V0KCgpPT5oaXQuY2xhc3NMaXN0LnJlbW92ZSgnZmxhc2gnKSwgMTIwKTsKCiAgICAgIC8vIGJ1cnN0IHBhcnRpY2xlcwogICAgICBmb3IgKGxldCBpPTA7aTwxMDtpKyspewogICAgICAgIGNvbnN0IGIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBiLmNsYXNzTmFtZSA9ICdidXJzdCc7CiAgICAgICAgYi5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1sYW5lQ29sb3InLCBMQU5FX05PVEVTW2xhbmVdLmNvbG9yKTsKICAgICAgICBjb25zdCBhbmcgPSAoTWF0aC5QSSoyKmkpLzEwOwogICAgICAgIGNvbnN0IGRpc3QgPSAyMCArIE1hdGgucmFuZG9tKCkqMjg7CiAgICAgICAgYi5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1ieCcsIE1hdGguY29zKGFuZykqZGlzdCArICdweCcpOwogICAgICAgIGIuc3R5bGUuc2V0UHJvcGVydHkoJy0tYnknLCAoLU1hdGguYWJzKE1hdGguc2luKGFuZykpKmRpc3QgLSAoTWF0aC5yYW5kb20oKSoxMCkpICsgJ3B4Jyk7CiAgICAgICAgbGFuZUVsc1tsYW5lXS5hcHBlbmRDaGlsZChiKTsKICAgICAgICBzZXRUaW1lb3V0KCgpPT5iLnJlbW92ZSgpLCA2MDApOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlTGFuZUFuaW1hdGlvbigpewogICAgICBjbGVhckFjdGl2ZSgpOwogICAgICBpZiAoY3VycmVudFBpdGNoLmh6IDwgMCkgcmV0dXJuOwoKICAgICAgY29uc3QgbGFuZSA9IGN1cnJlbnRQaXRjaC5sYW5lOwogICAgICBpZiAobGFuZSA8IDApIHJldHVybjsKCiAgICAgIGNvbnN0IGxhbmVFbCA9IGxhbmVFbHNbbGFuZV07CiAgICAgIGxhbmVFbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKCiAgICAgIC8vIHZpYnJhdGlvbiBhbW91bnQgYmFzZWQgb24gbG91ZG5lc3MKICAgICAgY29uc3QgcG93ZXIgPSBNYXRoLm1pbihjdXJyZW50UGl0Y2gucm1zIC8gMC4xMiwgMSk7CiAgICAgIGxhbmVFbC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS12aWJlJywgKDAuNiArIHBvd2VyKjIuMCkgKyAncHgnKTsKCiAgICAgIGNvbnN0IG9jdElkeCA9IG9jdGF2ZUluZGV4KGN1cnJlbnRQaXRjaC5vY3RhdmUpOwogICAgICBjb25zdCBtYXJrID0gb2N0YXZlTWFya3NbbGFuZV1bb2N0SWR4XTsKICAgICAgY29uc3QgY3Vyc29yID0gY3Vyc29yRWxzW2xhbmVdOwogICAgICBpZiAobWFyaykgewogICAgICAgIG1hcmsuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgICAgaWYgKGN1cnNvcikgY3Vyc29yLnN0eWxlLnRvcCA9IChtYXJrLmRhdGFzZXQueSB8fCAnNTAnKSArICclJzsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHRyeUhpdCgpewogICAgICBpZiAoY3VycmVudFBpdGNoLmh6IDwgMCkgcmV0dXJuOwoKICAgICAgY29uc3Qgcm1zVGggPSBzZW5zVG9SbXNUaHJlc2hvbGQocGFyc2VJbnQoc2Vuc0VsLnZhbHVlLCAxMCkpOwogICAgICBpZiAoY3VycmVudFBpdGNoLnJtcyA8IHJtc1RoKSByZXR1cm47CgogICAgICBjb25zdCB0b2xlcmFuY2UgPSBCQVNFX1RPTEVSQU5DRV9DRU5UUyArICgxIC0gTWF0aC5taW4oY3VycmVudFBpdGNoLnJtcyAvIDAuMSwgMSkpICogMTU7CgogICAgICAvLyBEZXRlcm1pbmUgbm90ZXMgaW4gd2luZG93CiAgICAgIGNvbnN0IGFyZW5hUmVjdCA9IGFyZW5hRWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIGNvbnN0IGxhbmVSZWN0ID0gbGFuZUVsc1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgY29uc3QgbGFuZUhlaWdodCA9IGxhbmVSZWN0LmhlaWdodDsKCiAgICAgIGNvbnN0IGhpdFkgPSBsYW5lSGVpZ2h0IC0gMTggLSAyNjsgLy8gYXBwcm94IGNlbnRlciBuZWFyIGhpdCB6b25lCiAgICAgIGZvciAobGV0IGkgPSBub3Rlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7CiAgICAgICAgY29uc3QgbiA9IG5vdGVzW2ldOwogICAgICAgIGNvbnN0IGR5ID0gTWF0aC5hYnMobi55IC0gaGl0WSk7CiAgICAgICAgaWYgKGR5IDwgSElUX1dJTkRPV19QWCl7CiAgICAgICAgICBpZiAobi5sYW5lID09PSBjdXJyZW50UGl0Y2gubGFuZSl7CiAgICAgICAgICAgIGNvbnN0IGNlbnRzT2ZmID0gKGN1cnJlbnRQaXRjaC5taWRpIC0gbi5taWRpKSAqIDEwMDsKICAgICAgICAgICAgaWYgKE1hdGguYWJzKGNlbnRzT2ZmKSA8PSB0b2xlcmFuY2UpewogICAgICAgICAgICAgIC8vIEhJVCEKICAgICAgICAgICAgICBzY29yZSsrOwogICAgICAgICAgICAgIHNjb3JlRWwudGV4dENvbnRlbnQgPSBzY29yZTsKICAgICAgICAgICAgICBuLmVsLmNsYXNzTGlzdC5hZGQoJ2dvb2QnKTsKICAgICAgICAgICAgICBmbGFzaEhpdChuLmxhbmUpOwogICAgICAgICAgICAgIHNldFRpbWVvdXQoKCk9Pm4uZWwucmVtb3ZlKCksIDgwKTsKICAgICAgICAgICAgICBub3Rlcy5zcGxpY2UoaSwxKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHRpY2sodCl7CiAgICAgIGlmICghaXNSdW5uaW5nKSByZXR1cm47CgogICAgICBpZiAoIWxhc3RGcmFtZSkgbGFzdEZyYW1lID0gdDsKICAgICAgY29uc3QgZHQgPSAodCAtIGxhc3RGcmFtZSkgLyAxMDAwOwogICAgICBsYXN0RnJhbWUgPSB0OwoKICAgICAgLy8gYXVkaW8gdXBkYXRlCiAgICAgIGlmIChhbmFseXNlciAmJiBidWYpewogICAgICAgIGFuYWx5c2VyLmdldEZsb2F0VGltZURvbWFpbkRhdGEoYnVmKTsKCiAgICAgICAgY29uc3Qgcm1zID0gcm1zT2ZGbG9hdDMyKGJ1Zik7CiAgICAgICAgY29uc3QgaHogPSBhdXRvQ29ycmVsYXRlKGJ1ZiwgYXVkaW9DdHguc2FtcGxlUmF0ZSk7CiAgICAgICAgY3VycmVudFBpdGNoLnJtcyA9IHJtczsKCiAgICAgICAgaWYgKGh6ID4gMCl7CiAgICAgICAgICBjb25zdCBtaWRpID0gaHpUb01pZGkoaHopOwogICAgICAgICAgY29uc3QgYmVzdCA9IGNsb3Nlc3RMYW5lTWlkaShtaWRpKTsKICAgICAgICAgIGNvbnN0IGNlbnRzID0gKG1pZGkgLSBiZXN0Lm1pZGkpICogMTAwOwoKICAgICAgICAgIGNvbnN0IG5hbWVkID0gbWlkaVRvTmFtZShtaWRpKTsKICAgICAgICAgIGN1cnJlbnRQaXRjaC5oeiA9IGh6OwogICAgICAgICAgY3VycmVudFBpdGNoLm1pZGkgPSBtaWRpOwogICAgICAgICAgY3VycmVudFBpdGNoLmxhbmUgPSBiZXN0LmxhbmU7CiAgICAgICAgICBjdXJyZW50UGl0Y2guY2VudHMgPSBjZW50czsKICAgICAgICAgIGN1cnJlbnRQaXRjaC5vY3RhdmUgPSBuYW1lZC5vY3RhdmU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGN1cnJlbnRQaXRjaC5oeiA9IC0xOwogICAgICAgICAgY3VycmVudFBpdGNoLm1pZGkgPSAtMTsKICAgICAgICAgIGN1cnJlbnRQaXRjaC5sYW5lID0gLTE7CiAgICAgICAgICBjdXJyZW50UGl0Y2guY2VudHMgPSAwOwogICAgICAgICAgY3VycmVudFBpdGNoLm9jdGF2ZSA9IDA7CiAgICAgICAgfQoKICAgICAgICB1cGRhdGVQaXRjaFVJKCk7CiAgICAgICAgdXBkYXRlTGFuZUFuaW1hdGlvbigpOwogICAgICB9CgogICAgICAvLyBub3RlcyB1cGRhdGUKICAgICAgY29uc3QgZmFsbFNwZWVkID0gdGVtcG9Ub0ZhbGxTcGVlZChwYXJzZUludChzcGVlZEVsLnZhbHVlLCAxMCkpOwogICAgICBjb25zdCBsYW5lUmVjdCA9IGxhbmVFbHNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIGNvbnN0IGxhbmVIZWlnaHQgPSBsYW5lUmVjdC5oZWlnaHQ7CgogICAgICBmb3IgKGxldCBpID0gbm90ZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pewogICAgICAgIGNvbnN0IG4gPSBub3Rlc1tpXTsKICAgICAgICBuLnkgKz0gZmFsbFNwZWVkICogZHQ7CiAgICAgICAgbi5lbC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKC01MCUsICR7bi55fXB4KWA7CgogICAgICAgIGlmIChuLnkgPiBsYW5lSGVpZ2h0ICsgOTApewogICAgICAgICAgbi5lbC5yZW1vdmUoKTsKICAgICAgICAgIG5vdGVzLnNwbGljZShpLCAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIHNwYXduaW5nCiAgICAgIGNvbnN0IHNwYXduTXMgPSB0ZW1wb1RvU3Bhd25NcyhwYXJzZUludChzcGVlZEVsLnZhbHVlLCAxMCkpOwogICAgICBpZiAoIWxhc3RTcGF3bikgbGFzdFNwYXduID0gdDsKICAgICAgaWYgKHQgLSBsYXN0U3Bhd24gPj0gc3Bhd25Ncyl7CiAgICAgICAgc3Bhd25Ob3RlKCk7CiAgICAgICAgbGFzdFNwYXduID0gdDsKICAgICAgfQoKICAgICAgLy8gaGl0IGRldGVjdGlvbiAoY29udGludW91czsgdm9pY2UgPSAic3RydW0iKQogICAgICB0cnlIaXQoKTsKCiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aWNrKTsKICAgIH0KCiAgICBhc3luYyBmdW5jdGlvbiBzdGFydCgpewogICAgICB0cnl7CiAgICAgICAgYXVkaW9DdHggPSBuZXcgQXVkaW9Db250ZXh0KCk7CiAgICAgICAgY29uc3Qgc3RyZWFtID0gYXdhaXQgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoewogICAgICAgICAgYXVkaW86IHsgZWNob0NhbmNlbGxhdGlvbjpmYWxzZSwgbm9pc2VTdXBwcmVzc2lvbjpmYWxzZSwgYXV0b0dhaW5Db250cm9sOmZhbHNlIH0KICAgICAgICB9KTsKCiAgICAgICAgbWljU291cmNlID0gYXVkaW9DdHguY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2Uoc3RyZWFtKTsKICAgICAgICBhbmFseXNlciA9IGF1ZGlvQ3R4LmNyZWF0ZUFuYWx5c2VyKCk7CiAgICAgICAgYW5hbHlzZXIuZmZ0U2l6ZSA9IDIwNDg7CiAgICAgICAgYW5hbHlzZXIuc21vb3RoaW5nVGltZUNvbnN0YW50ID0gMC4xOwoKICAgICAgICBtaWNTb3VyY2UuY29ubmVjdChhbmFseXNlcik7CiAgICAgICAgYnVmID0gbmV3IEZsb2F0MzJBcnJheShhbmFseXNlci5mZnRTaXplKTsKCiAgICAgICAgb3ZlcmxheUVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgaXNSdW5uaW5nID0gdHJ1ZTsKICAgICAgICBsYXN0U3Bhd24gPSAwOwogICAgICAgIGxhc3RGcmFtZSA9IDA7CiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRpY2spOwoKICAgICAgfSBjYXRjaChlcnIpewogICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsKICAgICAgICBhbGVydCgnTmllIHVkYcWCbyBzacSZIHVydWNob21pxIcgbWlrcm9mb251LiBTcHJhd2TFuiB1cHJhd25pZW5pYSB3IHByemVnbMSFZGFyY2UuJyk7CiAgICAgIH0KICAgIH0KCiAgICAvLyBGdWxsc2NyZWVuIG9uIGRvdWJsZSB0YXAvY2xpY2sKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgKCkgPT4gewogICAgICBpZiAoIWRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50KXsKICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4/LigpOwogICAgICB9IGVsc2UgewogICAgICAgIGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuPy4oKTsKICAgICAgfQogICAgfSk7CgogICAgYnVpbGRMYW5lcygpOwogICAgc3RhcnRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdGFydCk7CiAgPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPgo=",
            swiatla: "PCFET0NUWVBFIGh0bWw+CjxodG1sPjxoZWFkPjxtZXRhIGNoYXJzZXQ9IlVURi04Ij48bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLGluaXRpYWwtc2NhbGU9MS4wIj4KPHN0eWxlPip7bWFyZ2luOjA7cGFkZGluZzowO2JveC1zaXppbmc6Ym9yZGVyLWJveH1ib2R5e2JhY2tncm91bmQ6IzAwMDtoZWlnaHQ6MTAwdmg7b3ZlcmZsb3c6aGlkZGVuO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0ubGlnaHR7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6ODBweDtoZWlnaHQ6ODBweDtib3JkZXItcmFkaXVzOjUwJTthbmltYXRpb246cHVsc2UgMnMgZWFzZS1pbi1vdXQgaW5maW5pdGU7Ym94LXNoYWRvdzowIDAgNDBweCBjdXJyZW50Q29sb3J9QGtleWZyYW1lcyBwdWxzZXswJSwxMDAle3RyYW5zZm9ybTpzY2FsZSgxKTtvcGFjaXR5Oi40fTUwJXt0cmFuc2Zvcm06c2NhbGUoMS41KTtvcGFjaXR5OjF9fTwvc3R5bGU+CjwvaGVhZD48Ym9keT48c2NyaXB0PmNvbnN0IGNvbG9ycz1bJyNmZjZiNmInLCcjNGVjZGM0JywnI2ZmZTY2ZCcsJyM5NWUxZDMnLCcjZGRhMGRkJywnI2Y4YjUwMCddO2Z1bmN0aW9uIGNyZWF0ZUxpZ2h0KCl7Y29uc3QgbGlnaHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7bGlnaHQuY2xhc3NOYW1lPSdsaWdodCc7bGlnaHQuc3R5bGUuYmFja2dyb3VuZD1jb2xvcnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKmNvbG9ycy5sZW5ndGgpXTtsaWdodC5zdHlsZS5jb2xvcj1saWdodC5zdHlsZS5iYWNrZ3JvdW5kO2xpZ2h0LnN0eWxlLmxlZnQ9TWF0aC5yYW5kb20oKSood2luZG93LmlubmVyV2lkdGgtODApKydweCc7bGlnaHQuc3R5bGUudG9wPU1hdGgucmFuZG9tKCkqKHdpbmRvdy5pbm5lckhlaWdodC04MCkrJ3B4JztsaWdodC5zdHlsZS5hbmltYXRpb25EZWxheT1NYXRoLnJhbmRvbSgpKjIrJ3MnO2xpZ2h0LnN0eWxlLmFuaW1hdGlvbkR1cmF0aW9uPSgxLjUrTWF0aC5yYW5kb20oKSkrJ3MnO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGlnaHQpO3NldFRpbWVvdXQoKCk9PntsaWdodC5yZW1vdmUoKTtjcmVhdGVMaWdodCgpfSwzMDAwK01hdGgucmFuZG9tKCkqMjAwMCl9Zm9yKGxldCBpPTA7aTw4O2krKylzZXRUaW1lb3V0KCgpPT5jcmVhdGVMaWdodCgpLGkqNDAwKTwvc2NyaXB0PjwvYm9keT48L2h0bWw+"
        };

        // Decode Base64 to UTF-8 (so Polish letters display correctly)
        function decodeBase64Utf8(b64) {
            try {
                const binary = atob(b64);
                const bytes = Uint8Array.from(binary, c => c.charCodeAt(0));
                if (window.TextDecoder) {
                    return new TextDecoder('utf-8').decode(bytes);
                }
                // Fallback (older browsers)
                return decodeURIComponent(Array.from(bytes).map(b => '%' + b.toString(16).padStart(2, '0')).join(''));
            } catch (e) {
                // Last resort
                return atob(b64);
            }
        }

        
        function loadGame(gameName) {
            const gameContainer = document.getElementById('gameContainer');
            const gameFrame = document.getElementById('gameFrame');
            const gameDirect = document.getElementById('gameDirect');
            const menu = document.getElementById('menu');
            const backBtn = document.getElementById('backBtn');
            
            // Decode base64
            const decoded = decodeBase64Utf8(GAMES_BASE64[gameName]);
            
            // For microphone game (dzwiek), load directly (not in iframe)
            if (gameName === 'dzwiek') {
                // Clear iframe
                gameFrame.srcdoc = '';
                gameFrame.style.display = 'none';
                
                // Load directly into page
                gameDirect.innerHTML = decoded;
                gameDirect.style.display = 'block';
                
                // Execute scripts in the loaded content
                const scripts = gameDirect.querySelectorAll('script');
                scripts.forEach(oldScript => {
                    const newScript = document.createElement('script');
                    if (oldScript.src) {
                        newScript.src = oldScript.src;
                    } else {
                        newScript.textContent = oldScript.textContent;
                    }
                    oldScript.parentNode.replaceChild(newScript, oldScript);
                });
            } else {
                // For other games, use iframe
                gameDirect.innerHTML = '';
                gameDirect.style.display = 'none';
                gameFrame.style.display = 'block';
                gameFrame.srcdoc = decoded;
            }
            
            // Show game, hide menu
            gameContainer.classList.add('active');
            menu.classList.add('hidden');
            backBtn.classList.add('active');
        }
        
        function showMenu() {
            const gameContainer = document.getElementById('gameContainer');
            const gameFrame = document.getElementById('gameFrame');
            const gameDirect = document.getElementById('gameDirect');
            const menu = document.getElementById('menu');
            const backBtn = document.getElementById('backBtn');
            
            // Clear both containers
            gameFrame.srcdoc = '';
            gameDirect.innerHTML = '';
            
            // Show menu, hide game
            gameContainer.classList.remove('active');
            menu.classList.remove('hidden');
            backBtn.classList.remove('active');
        }
    
        // PWA: register service worker (offline cache)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js').catch(() => {});
            });
        }
    </script>
</body>
</html>
